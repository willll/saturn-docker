diff -crB --binary sbl6/segalib/csh/csh_main.c sbl6_patch/segalib/csh/csh_main.c
*** sbl6/segalib/csh/csh_main.c	1996-02-08 05:23:06.000000000 -0500
--- sbl6_patch/segalib/csh/csh_main.c	2022-09-26 20:20:20.000000000 -0400
***************
*** 1,4 ****
! /*------------------------------------------------------------------------
   *  FILE:	csh_main.c
   *      $Author: $Y.K
   *      $Date: $1994-05-10
--- 1,4 ----
! 	/*------------------------------------------------------------------------
   *  FILE:	csh_main.c
   *      $Author: $Y.K
   *      $Date: $1994-05-10
***************
*** 65,70 ****
--- 65,71 ----
  /****************************************************************************/
  /*	キャッシュの全クリア													*/
  /****************************************************************************/
+ #ifndef SGL
  void CSH_AllClr(void)
  {
  	Uint32 way;									/*	アクセスウェイ制御変数	*/
***************
*** 82,87 ****
--- 83,93 ----
  	}											/*	end for way				*/
  	CSH_SET_ENABLE(CSH_ENABLE);					/*	キャッシュイネーブル	*/
  }
+ #else
+ 
+ extern void CSH_AllClr(void);
+ 
+ #endif
  
  /****************************************************************************/
  /*	対象領域の連想パージ													*/
***************
*** 129,132 ****
  /****************************************************************************/
  /*	End of File																*/
  /****************************************************************************/
! 
\ No newline at end of file
--- 135,138 ----
  /****************************************************************************/
  /*	End of File																*/
  /****************************************************************************/
! 
diff -crB --binary sbl6/segalib/dma/dma_cpum.c sbl6_patch/segalib/dma/dma_cpum.c
*** sbl6/segalib/dma/dma_cpum.c	1996-02-08 05:23:16.000000000 -0500
--- sbl6_patch/segalib/dma/dma_cpum.c	2021-11-14 20:07:08.000000000 -0500
***************
*** 39,44 ****
--- 39,45 ----
   * C VIRTUAL TYPES DEFINITIONS
   */
  #include "sega_xpt.h"
+ #include "sega_csh.h"
  
  /*
   * USER SUPPLIED INCLUDE FILES
***************
*** 371,374 ****
      return(DMA_CPU_END);                    /* 正常終了をリターン            */
  }
  
! 
\ No newline at end of file
--- 372,375 ----
      return(DMA_CPU_END);                    /* 正常終了をリターン            */
  }
  
! 
diff -crB --binary sbl6/segalib/dma/dma_scu1.c sbl6_patch/segalib/dma/dma_scu1.c
*** sbl6/segalib/dma/dma_scu1.c	1996-02-08 05:23:18.000000000 -0500
--- sbl6_patch/segalib/dma/dma_scu1.c	2021-11-14 20:08:26.000000000 -0500
***************
*** 35,40 ****
--- 35,41 ----
  /*
   * C STANDARD LIBRARY FUNCTIONS/MACROS DEFINES
   */
+ #include <string.h>
  
  /*
   * C VIRTUAL TYPES DEFINITIONS
***************
*** 238,241 ****
      }
  }
  
! 
\ No newline at end of file
--- 239,242 ----
      }
  }
  
! 
diff -crB --binary sbl6/segalib/gfs/gfs.c sbl6_patch/segalib/gfs/gfs.c
*** sbl6/segalib/gfs/gfs.c	2021-11-14 19:22:22.000000000 -0500
--- sbl6_patch/segalib/gfs/gfs.c	2022-01-17 19:50:30.000000000 -0500
***************
*** 28,33 ****
--- 28,34 ----
  #include    "gfs_dir.h"
  #include    "gfs_trn.h"
  #include    "gfs_cdc.h"
+ #include    "gfs_buf.h"
  
  
  #if !defined(USE_SGL)
***************
*** 1275,1282 ****
   *****************************************************************************/
  Sint32 GFS_NwExecServer(GfsHn *now_gfs)
  {
!     GfsSvr      *svr;
!     Sint32      stat, i;
  
      svr = &MNG_SVR(gfs_mng_ptr);
      for (i = 0; i < SVR_NFILE(svr); ++i) {
--- 1276,1283 ----
   *****************************************************************************/
  Sint32 GFS_NwExecServer(GfsHn *now_gfs)
  {
!     GfsSvr      *svr = NULL;
!     Sint32      stat = 0, i;
  
      svr = &MNG_SVR(gfs_mng_ptr);
      for (i = 0; i < SVR_NFILE(svr); ++i) {
diff -crB --binary sbl6/segalib/gfs/gfs_dir.c sbl6_patch/segalib/gfs/gfs_dir.c
*** sbl6/segalib/gfs/gfs_dir.c	1996-02-08 05:23:34.000000000 -0500
--- sbl6_patch/segalib/gfs/gfs_dir.c	2022-01-17 19:51:14.000000000 -0500
***************
*** 680,686 ****
  {
      Sint32      ec, i, rdsz, fn_err = FALSE;
      Uint8       fn_len, file_flg;
!     Sint8       ch, *fn_buf, *ext_pos;
  
      if (GFDR_FILE_GFS(fp) == NULL) {
          XA_DIR_RSIZE(dir) = 0;
--- 680,686 ----
  {
      Sint32      ec, i, rdsz, fn_err = FALSE;
      Uint8       fn_len, file_flg;
!     Sint8       ch = 0, *fn_buf, *ext_pos;
  
      if (GFDR_FILE_GFS(fp) == NULL) {
          XA_DIR_RSIZE(dir) = 0;
diff -crB --binary sbl6/segalib/gfs/gfs_mmb.c sbl6_patch/segalib/gfs/gfs_mmb.c
*** sbl6/segalib/gfs/gfs_mmb.c	1996-02-08 05:23:36.000000000 -0500
--- sbl6_patch/segalib/gfs/gfs_mmb.c	2021-11-14 20:12:48.000000000 -0500
***************
*** 23,28 ****
--- 23,29 ----
  #include    "gfs_mmc.h"
  #include    "gfs_mmb.h"
  #include    "gfs_trn.h"
+ #include    "gfs_mmf.h"
  
  /*****************************************************************************
   *      定数マクロ
diff -crB --binary sbl6/segalib/include/sega_int.h sbl6_patch/segalib/include/sega_int.h
*** sbl6/segalib/include/sega_int.h	1996-02-08 05:23:46.000000000 -0500
--- sbl6_patch/segalib/include/sega_int.h	2021-12-26 18:28:36.000000000 -0500
***************
*** 499,502 ****
  #endif
  
  #endif  /* ifndef SEGA_INT_H */
! 
\ No newline at end of file
--- 499,502 ----
  #endif
  
  #endif  /* ifndef SEGA_INT_H */
! 
diff -crB --binary sbl6/segalib/include/sega_per.h sbl6_patch/segalib/include/sega_per.h
*** sbl6/segalib/include/sega_per.h	1996-02-08 05:23:48.000000000 -0500
--- sbl6_patch/segalib/include/sega_per.h	2022-09-24 08:41:04.000000000 -0400
***************
*** 233,239 ****
      PerMulCon   con;
  }PerMulInfo;                                    /* マルチタップ情報          */
  
! typedef struct  {                               /* システム出力              */
      Uint8   cc;                                 /* カートリッジコード        */
      Uint8   ac;                                 /* エリアコード              */
      Uint16  ss;                                 /* システムステータス        */
--- 233,239 ----
      PerMulCon   con;
  }PerMulInfo;                                    /* マルチタップ情報          */
  
! typedef struct __attribute__ ((aligned (16))) { /* システム出力              */
      Uint8   cc;                                 /* カートリッジコード        */
      Uint8   ac;                                 /* エリアコード              */
      Uint16  ss;                                 /* システムステータス        */
***************
*** 612,627 ****
   */
  
  /********************************* persprt.h *********************************/
! #if 0
!     以下 DISK Version 1994-11-11の追加分
!     
!     ◆システム／ペリフェラルライブラリ使用サンプルプログラムへの対処
!         システム／ペリフェラルライブラリを使用している各ライブラリの
!         サンプルプログラムのために今回のシステム／ペリフェラルライブラリには、
!         以前のバージョンの関数、定数等を含めています。但し、この関数、定数等は
!         、4thSTEPでは削除します。
!         以前のバージョンの関数、定数等は使用しないでください。
! #endif
  /*
   * GLOBAL DEFINES/MACROS DEFINES
   */
--- 612,618 ----
   */
  
  /********************************* persprt.h *********************************/
! 
  /*
   * GLOBAL DEFINES/MACROS DEFINES
   */
***************
*** 783,786 ****
  
  #endif  /* ifndef SEGA_PER_H */
  /******************************* end of file *********************************/
! 
\ No newline at end of file
--- 774,777 ----
  
  #endif  /* ifndef SEGA_PER_H */
  /******************************* end of file *********************************/
! 
diff -crB --binary sbl6/segalib/include/sega_scl.h sbl6_patch/segalib/include/sega_scl.h
*** sbl6/segalib/include/sega_scl.h	1995-09-29 10:30:48.000000000 -0400
--- sbl6_patch/segalib/include/sega_scl.h	2021-04-21 19:17:26.000000000 -0400
***************
*** 1,1440 ****
! /*------------------------------------------------------------------------
!  *  FILE:	SEGA_SCL.H
!  *
!  *	Copyright(c) 1994 SEGA
!  *
!  *  PURPOSE:
!  *	Scroll Simulation program header file
!  *	Scroll Register Data Structure Definition File
!  *
!  *  AUTHOR(S):
!  *	K.M
!  *		
!  *  MOD HISTORY:
!  *	Written by K.M on 1994-05-20 Ver.1.00
!  *	Updated by K.M on 1994-07-01 Ver.1.00
!  * 
!  *------------------------------------------------------------------------
!  */
! 
! #ifndef	SEGA_SCR_H
! #define SEGA_SCR_H
! 
! #include <sega_xpt.h>
! #include <sega_def.h>
! #include <sega_mth.h> 
! 
! #define VBR              0x06000000
! #define SCU_BASE         0x25FE0000
! #define SCU_INTR_MASK    0x000000a0
! #define SCU_INTR_STATUS  0x000000a4
! #define SETUINT   ((Sint32 (*)()) *((Uint32*)(VBR+0x300)))
! #define GETUINT   ((Sint32 (*)()) *((Uint32*)(VBR+0x304)))
! #define SETSINT   ((Sint32 (*)()) *((Uint32*)(VBR+0x310)))
! #define GETSINT   ((Sint32 (*)()) *((Uint32*)(VBR+0x314)))
! #define VBIVN	0x40
! #define VBOVN	0x41
! #define HBIVN	0x42
! 
! /*********************************************
!  *      System Register Cluster	             *
!  *      Address ranger 180000H - 180027H     *
!  *********************************************/
!  typedef struct	SclSysreg{
! 	Uint16	tvmode;			/* TV Mode */
! 	Uint16	extenbl;		/* External Input Enable */
! 	Uint16	tvstatus;		/* TV Status Read Only */
! 	Uint16	vramsize;		/* VRAM Size */
! 	Uint16	H_val;			/* H Counter Read Only */
! 	Uint16	V_val;			/* V Counter Read Only */
! 	Uint16	vramchg;		/* VRAM Change */
! 	Uint16	ramcontrl;		/* RAM Control */
! 	Uint16	vramcyc[8];		/* VRAM Cycle Table x8 */
! 	Uint16	dispenbl;		/* Display Enable */
! 	Uint16	mosaic;			/* Mosaic Control */
! 	Uint16	specialcode_sel;	/* Special Code Selector */
! 	Uint16	specialcode;		/* Special Code */
!  } SclSysreg;
! 
! /**********************************************
!  *      Scroll Data Set Register Cluster      *
!  *      Address ranger 180028H - 18006FH      *
!  **********************************************/
! typedef struct SclDataset{
! 	Uint16	charcontrl0;		/* Character Control */
! 	Uint16	charcontrl1;		/* Character Control */
! 	Uint16	bmpalnum0;		/* Bitmap Palette Number */
! 	Uint16	bmpalnum1;		/* Bitmap Palette Number */
! 	Uint16	patnamecontrl[5];	/* Pattern Name Controlx5 */
! 	Uint16	platesize;		/* Plate Size */	
! 	Uint16	mapoffset0;		/* Map Offset */
! 	Uint16	mapoffset1;		/* Map Offset */
! 	Uint16	normap[8];		/* Normal Scroll Map x8*/
! 	Uint16	rotmap[16];		/* Rotate Scroll Map x16*/
! } SclDataset;
! 
! /***************************************************
!  *      Normal Scroll Function Register Cluster    *
!  *      Address ranger 180070H - 1800AFH           *
!  ***************************************************/
! typedef struct SclNorscl{
! 	Fixed32	n0_move_x;		/* NBG0 Scroll Movement X */
! 	Fixed32	n0_move_y;		/* NBG0 Scroll Movement Y */
! 	Fixed32	n0_delta_x;		/* NBG0 Scroll Movement X */
! 	Fixed32	n0_delta_y;		/* NBG0 Scroll Movement Y */
! 	Fixed32	n1_move_x;		/* NBG1 Scroll Movement X */
! 	Fixed32	n1_move_y;		/* NBG1 Scroll Movement Y */
! 	Fixed32	n1_delta_x;		/* NBG1 Scroll Movement X */
! 	Fixed32	n1_delta_y;		/* NBG1 Scroll Movement Y */
! 	Uint16	n2_move_x;		/* NBG2 Scroll Movement X */
! 	Uint16	n2_move_y;		/* NBG2 Scroll Movement Y */
! 	Uint16	n3_move_x;		/* NBG3 Scroll Movement X */
! 	Uint16	n3_move_y;		/* NBG3 Scroll Movement Y */
! 	Uint16	zoomenbl;		/* Zoom Enable */
! 	Uint16	linecontrl;		/* Normal Extension Control */
! 	Uint32	celladdr;		/* Cell Scroll Table Address */
! 	Uint32	lineaddr[2];		/* Line Scroll Table Address x2 */
! 	Uint32	linecolmode;		/* Line BG Color Mode Address */
! 	Uint32	backcolmode;		/* Back BG Color Mode Address */
! } SclNorscl;
! 
! /****************************************************
!  *      Rotate Scroll Function Register Cluster     *
!  *      Address ranger 1800B0H - 1800BFH            *
!  ****************************************************/
! typedef struct SclRotscl{
! 	Uint16	paramode;		/* Rotate Parameter Mode */
! 	Uint16	paramcontrl;		/* Rotate Parameter Read Control */
! 	Uint16	k_contrl;		/* Keisu Table Control */
! 	Uint16	k_offset;		/* Keisu Addres Offset */
! 	Uint16	mapover[2];		/* Rotate Scroll Map Over */
! 	Uint32	paramaddr;		/* Rotate Parameter Tabel Address */
! } SclRotscl;
! 
! /***************************************************
!  *      Window Scroll Setting Register Cluster     *
!  *      Address ranger 1800C0H - 1800DFH           *
!  ***************************************************/
! typedef struct SclWinscl{
! 					/* 1800C0 */
! 	Uint16	win0_start[2];		/* Window #0 Start X & Y */
! 					/* 1800C4 */
! 	Uint16	win0_end[2];		/* Window #0 End X & Y */
! 					/* 1800C8 */
! 	Uint16	win1_start[2];		/* Window #1 Start X & Y */
! 					/* 1800CC */
! 	Uint16	win1_end[2];		/* Window #1 End X & Y */
! 					/* 1800D0 */
! 	Uint16	wincontrl[4];		/* Window Control */
! 					/* 1800D8 */
! 	Uint32 	linewin0_addr;		/* Line Window #0 Table Address */ 
! 					/* 1800DC */
! 	Uint32 	linewin1_addr;		/* Line Window #1 Table Address */ 
! } SclWinscl;
! 
! /***********************************************
!  *      Priority Related Register Cluster      *
!  ***********************************************/
! typedef struct SclPrior{
! 	Uint16	prnum;
! } SclPrior;
! 
! 
! /**************************************************
!  *      Scroll Parameters Definition              *
!  **************************************************/
! typedef struct  SclXy {
! 	 Fixed32         x;
! 	 Fixed32         y;
! } SclXy;
! 
! typedef struct  SclXyz {
! 	 Fixed32         x;
! 	 Fixed32         y;
! 	 Fixed32         z;
! } SclXyz;
! 
! typedef struct  SclXy16 {
!         Uint16         x;
!         Uint16         y;
! } SclXy16;
! 
! typedef struct  SclXyz16 {
!         Sint16         x;
!         Sint16         y;
!         Sint16         z;
! } SclXyz16;
! 
! typedef struct  SclRgb {
! 	 Sint16		red;
! 	 Sint16		green;
! 	 Sint16		blue;
! } SclRgb;
! 
! typedef struct  SclLineTb {
! 	 Fixed32	h;
! 	 Fixed32	v;
! 	 Fixed32	dh;
! } SclLineTb;
! 
! typedef struct  SclLineWindowTb {
! 	 Uint16		start;
! 	 Uint16		end;
! } SclLineWindowTb;
! 
! typedef struct SclVramConfig{
! 	Uint32	ktboffsetA;/* 回転ﾊﾟﾗﾒｰﾀA用係数ﾃｰﾌﾞﾙをﾊﾞﾝｸ中のどこに配置するか */
! 	Uint32	ktboffsetB;/* 回転ﾊﾟﾗﾒｰﾀB用係数ﾃｰﾌﾞﾙをﾊﾞﾝｸ中のどこに配置するか */
! 	Uint8	vramModeA; /* VRAM A を２つのバンクに区切るか指定(0/1)  */
! 	Uint8	vramModeB; /* VRAM B を２つのバンクに区切るか指定(0/1)  */
! 	Uint8	vramA0;    /* VRAM A or A0 を回転面の何で使用するか指定 */
! 	Uint8	vramA1;    /* VRAM A1 を回転面の何で使用するか指定      */
! 	Uint8	vramB0;    /* VRAM B or B0 を回転面の何で使用するか指定 */
! 	Uint8	vramB1;    /* VRAM B1 を回転面の何で使用するか指定      */
! 	Uint8	colram;    /* カラーＲＡＭに係数データを置くか？        */
! } SclVramConfig;
! 
! typedef struct SclRotreg{
! 	SclXyz		screenst;
! 	SclXy		screendlt;
! 	SclXy		delta;
! 	Fixed32		matrix_a;
! 	Fixed32		matrix_b;
! 	Fixed32		matrix_c;
! 	Fixed32		matrix_d;
! 	Fixed32		matrix_e;
! 	Fixed32		matrix_f;
! 	SclXyz16	viewp;
! 	Uint16		dummy1;
! 	SclXyz16	rotatecenter;
! 	Uint16		dummy2;
! 	SclXy		move;
! 	SclXy		zoom;
! 	Fixed32		k_tab;
! 	SclXy		k_delta;
! /*	Fixed32		dummy3[8];	*/
! 	Fixed32		dummy3[2];
! } SclRotreg;
! 
! typedef struct SclRotparam{
! 	Uint32		addr;
! 	SclXyz		screenst;
! 	SclXy		screendlt;
! 	SclXy		delta;
! 	Fixed32		matrix_a;
! 	Fixed32		matrix_b;
! 	Fixed32		matrix_c;
! 	Fixed32		matrix_d;
! 	Fixed32		matrix_e;
! 	Fixed32		matrix_f;
! 	Fixed32		matrix_g;
! 	Fixed32		matrix_h;
! 	Fixed32		matrix_i;
! 	Fixed32		drotangle;
! 	SclXyz		viewp;
! 	SclXyz		rotatecenter;
! 	SclXyz		disprotcenter;
! 	SclXyz		move;
! 	SclXy		zoom;
! 	Fixed32		k_tab;
! 	SclXy		k_delta;
! 	Uint16		k_size;
! } SclRotparam;
! 
! /*******************************************
!  *      Scroll Configure Data Structure    *
!  *******************************************/
! typedef	struct	SclConfig {
! 	Uint8		dispenbl;
! 	Uint8		charsize;
! 	Uint8		pnamesize;
! 	Uint8		platesize;
! 	Uint8		bmpsize;
! 	Uint8		coltype;
! 	Uint8		datatype;
! 	Uint8		mapover;
! 	Uint8		flip;
! 	Uint16		patnamecontrl;
! /*	Uint32		plate_addr[16];		1995.9.29 cyoshida */
! 	Uint32		plate_addr[32];
! } SclConfig;
! 
! /******************************************************
!  *      Line & Cell Scroll Parameter Data Structure   *
!  ******************************************************/
! #define	SCL_MAXLINE	512
! #define	SCL_MAXCELL	64
! 
! typedef	struct	SclLineparam{
! 	Uint8		delta_enbl;
! 	Uint8		v_enbl;
! 	Uint8		h_enbl;
! 	Uint8		cell_enbl;
! 	Uint8		interval;
! 	Uint32		line_addr;
! 	Uint32		cell_addr;
! 	SclLineTb	line_tbl[SCL_MAXLINE];
! 	Fixed32		cell_tbl[SCL_MAXCELL];
! }	SclLineparam;
! 
! typedef	struct	SclLineWin{
! 	Uint16		winum;
! 	Uint16		y[2];
! 	Uint32		addr;
! 	SclXy16		tbl[SCL_MAXLINE];
! }	SclLineWin;
! 
! /***tuika c.yoshida******/
! 
! typedef	struct	SclSblSgl{
! 	Uint16		sgl_flag;
! }SclSblSgl;
! 
! /************************/
! 
! #define SCL_VDP2_VRAM		0x25e00000
! #define SCL_VDP2_VRAM_A		0x25e00000
! #define SCL_VDP2_VRAM_A0	0x25e00000
! #define SCL_VDP2_VRAM_A1	0x25e20000
! #define SCL_VDP2_VRAM_B		0x25e40000
! #define SCL_VDP2_VRAM_B0	0x25e40000
! #define SCL_VDP2_VRAM_B1	0x25e60000
! #define	SCL_COLRAM_ADDR		0x25F00000	/* Color RAM */
! 
! #define SCL_NON			0   /* RBG0では使用しない        */
! #define SCL_RBG0_K 		1   /* RBG0の係数ﾃｰﾌﾞﾙを置く     */
! #define SCL_RBG0_PN 		2   /* RBG0のﾊﾟﾀｰﾝﾈｰﾑﾃｰﾌﾞﾙを置く */
! #define SCL_RBG0_CHAR 		3   /* RBG0のｷｬﾗｸﾀを置く         */
! #define SCL_RBG1_K 		4   /* RBG1の係数ﾃｰﾌﾞﾙを置く     */
! 
! #define	SCL_CHAR_SIZE_1X1	0
! #define	SCL_CHAR_SIZE_2X2	1
! 
! #define	SCL_PN2WORD		0
! #define	SCL_PN1WORD		1
! 
! #define	SCL_PL_SIZE_1X1		0
! #define	SCL_PL_SIZE_2X1		1
! #define	SCL_PL_SIZE_2X2		3
! 
! #define	SCL_BMP_SIZE_512X256	0
! #define	SCL_BMP_SIZE_512X512	1
! #define	SCL_BMP_SIZE_1024X256	2
! #define	SCL_BMP_SIZE_1024X512	3
! 
! #define	SCL_COL_TYPE_16		0
! #define	SCL_COL_TYPE_256	1
! #define	SCL_COL_TYPE_2048	2
! #define	SCL_COL_TYPE_32K	3
! #define	SCL_COL_TYPE_1M		4
! 
! #define	SCL_CELL		0
! #define	SCL_BITMAP		1
! 
! #define	SCL_OVER_0		0
! #define	SCL_OVER_1		1
! #define	SCL_OVER_2		2
! #define	SCL_OVER_3		3
! 
! #define	SCL_PN_10BIT		0
! #define	SCL_PN_12BIT		1
! 
! #define	SCL_1_LINE		0
! #define	SCL_2_LINE		1
! #define	SCL_4_LINE		2
! 
! #define	SCL_NON_INTER		0
! #define	SCL_SINGLE_INTER	2
! #define	SCL_DOUBLE_INTER	3
! 
! #define	SCL_224LINE		0
! #define	SCL_240LINE		1
! #define	SCL_256LINE		2
! 
! #define	SCL_NORMAL_A		0
! #define	SCL_NORMAL_B		1
! #define	SCL_HIRESO_A		2
! #define	SCL_HIRESO_B		3
! #define	SCL_NORMAL_AE		4
! #define	SCL_NORMAL_BE		5
! #define	SCL_HIRESO_AE		6
! #define	SCL_HIRESO_BE		7
! 
! #define	SCL_X_AXIS		1
! #define	SCL_Y_AXIS		2
! 
! #define	SCL_W0			0
! #define	SCL_W1			1
! 
! #define FIXED(x)	      ((Fixed32)((x) * 65536.0))
! #define MUL_FIXED(a, b)       MTH_Mul(a, b)
! #define DIV_FIXED(a, b)       MTH_Div(a, b)
! 
! #endif	/* ifndef SEGA_SCR_H */
! 
! 
! /*------------------------------------------------------------------------
!  *  
!  *
!  *  DESCRIPTION:
!  *
!  *          Header file for Priority library internal use.
!  *          Each Macro Set a parameter on Register buffer.
!  *          the buffer will copy to REAL regster while V-interval.
!  *          ここにあるマクロは、レジスタバッファに各コントロール値を
!  *          書き込み、書き込んだレジスタバッファのダーティーフラグを
!  *          1 にする。
! -------------------------------------------------------------------------*/
! 
! #ifndef __PRI_GLVAR
! #define __PRI_GLVAR
! 
! #ifndef __PRI_MACRO
! #define __PRI_MACRO
! 
! #ifndef __PRI_REG
! #define __PRI_REG
! 
! /*-----< other group regs >----*/
! typedef struct {
!     Uint16 SpriteControl;		/* 1800E0 */
!     Uint16 ShadowControl;		/* 1800E2 */
!     Uint16 ColorRamOffset0;		/* 1800E4 */
!     Uint16 ColorRamOffset1;		/* 1800E6 */
!     Uint16 LineColorEnable;		/* 1800E8 */
!     Uint16 SpecialPriorityMode;		/* 1800EA */
!     Uint16 ColorMixControl;		/* 1800EC */
!     Uint16 SpecialColorMixMode;		/* 1800EE */
! } SclOtherPriRegister;
! 
! /*----< sprite priority >----*/
! typedef struct {
!     Uint16 PriorityNumberSP01;		/* 1800F0 */
!     Uint16 PriorityNumberSP23;		/* 1800F2 */
!     Uint16 PriorityNumberSP45;		/* 1800F4 */
!     Uint16 PriorityNumberSP67;		/* 1800F6 */
! } SclSpPriNumRegister;
! 
! /*----< scroll priority >----*/
! typedef struct {
!     Uint16 PriorityNumberNBG01;		/* 1800F8 */
!     Uint16 PriorityNumberNBG23;		/* 1800FA */
!     Uint16 PriorityNumberRBG0;		/* 1800FC */
! } SclBgPriNumRegister;
! 
! /*----< sprite color Mix >----*/
! typedef struct {
!     Uint16 ColMixRateSP01;		/* 180100 */
!     Uint16 ColMixRateSP23;		/* 180102 */
!     Uint16 ColMixRateSP45;		/* 180104 */
!     Uint16 ColMixRateSP67;		/* 180106 */
! } SclSpColMixRegister;
! 
! /*----< scroll color Mix >----*/
! typedef struct {
!     Uint16 ColMixRateNBG01;		/* 180108 */
!     Uint16 ColMixRateNBG23;		/* 18010A */
!     Uint16 ColMixRateRBG0;		/* 18010C */
!     Uint16 ColMixRateLCBAK;		/* 18010E */
! } SclBgColMixRegister;
! 
! /*----< color offset >----*/
! typedef struct {
!     Uint16 ColorOffsetEnable;		/* 180110 */
!     Uint16 ColorOffsetSelect;		/* 180112 */
!     Uint16 ColorOffsetA_RED;		/* 180114 */
!     Uint16 ColorOffsetA_GREEN;		/* 180116 */
!     Uint16 ColorOffsetA_BLUE;		/* 180118 */
!     Uint16 ColorOffsetB_RED;		/* 18011A */
!     Uint16 ColorOffsetB_GREEN;		/* 18011E */
!     Uint16 ColorOffsetB_BLUE;		/* 180120 */
! } SclColOffsetRegister;
! 
! /*---- レジスタバッファのダーティー・フラグ */
! typedef struct
! {
!     Uint32 SclOtherPri:1;
!     Uint32 SclSpPriNum:1;
!     Uint32 SclBgPriNum:1;
!     Uint32 SclSpColMix:1;
!     Uint32 SclBgColMix:1;
!     Uint32 SclColOffset:1;
! } SclPriBuffDirtyFlags;
! 
! #endif /* __PRI_REG */
! 
! 
! extern SclOtherPriRegister	SclOtherPri;
! extern SclSpPriNumRegister	SclSpPriNum;
! extern SclBgPriNumRegister	SclBgPriNum;
! extern SclSpColMixRegister	SclSpColMix;
! extern SclBgColMixRegister	SclBgColMix;
! extern SclColOffsetRegister	SclColOffset;
! extern SclPriBuffDirtyFlags	SclPriBuffDirty;
! 
! /* Following macros never check argument value range.*/
! 
! /* VDP-II manual p.129 */
! #define SCL_SET_SPCCCS(/* 2 bits */ spcccs) /* スプライト色演算条件 */\
!   (SclPriBuffDirty.SclOtherPri = 1,\
!    SclOtherPri.SpriteControl \
!    = (SclOtherPri.SpriteControl & 0x0FFF) | ((spcccs) << 12))
! 
! #define SCL_GET_SPCCCS() \
!   ((SclOtherPri.SpriteControl & 0x3000) >> 12)
! 
! #define SCL_SET_SPCCN(/* 3 bits */ spccn) /* スプライト色演算条件ナンバ */\
!   (SclPriBuffDirty.SclOtherPri = 1,\
!    SclOtherPri.SpriteControl \
!    = (SclOtherPri.SpriteControl & 0xF0FF) | ((spccn) << 8))
! 
! #define SCL_GET_SPCCN() \
!   ((SclOtherPri.SpriteControl & 0x0700) >> 8)
! 
! #define SCL_SET_SPCLMD(/* 1 bit */ spclmd) /* スプライトの色形式 */\
!   (SclPriBuffDirty.SclOtherPri = 1,\
!    SclOtherPri.SpriteControl \
!    = (SclOtherPri.SpriteControl & 0xFFDF) | ((spclmd) << 5))
! 
! #define SCL_GET_SPCLMD() \
!   ((SclOtherPri.SpriteControl & 0x0020) >> 5)
! 
! #define SCL_SET_SPWINEN(/* 1 bit */ spwinen) /* スプライトウィンドウイネーブル */\
!   (SclPriBuffDirty.SclOtherPri = 1,\
!    SclOtherPri.SpriteControl \
!    = (SclOtherPri.SpriteControl & 0xFFEF) | ((spwinen) << 4))    /* -> p.121 */
! 
! #define SCL_GET_SPWINEN() \
!   ((SclOtherPri.SpriteControl & 0x0010) >> 4)
! 
! #define SCL_SET_SPTYPE(/* 4bits */ sptype) /* スプライトのタイプ指定 */\
!   (SclPriBuffDirty.SclOtherPri = 1,\
!    SclOtherPri.SpriteControl \
!    = (SclOtherPri.SpriteControl & 0xFFF0) | (sptype))
! 
! #define SCL_GET_SPTYPE() \
!   (SclOtherPri.SpriteControl & 0x000F)
! 
! /* VDP-II manual p.131 */
! /*-------------------- スプライト用プライオリティレジスタ No.0-7 */
! 
! #define SCL_SET_S0PRIN(/* 3 bits */ s0prin) \
!   (SclPriBuffDirty.SclSpPriNum = 1,\
!    SclSpPriNum.PriorityNumberSP01 \
!    = (SclSpPriNum.PriorityNumberSP01 & 0xFFF0) | (s0prin))
! 
! #define SCL_GET_S0PRIN() \
!   ((SclSpPriNum.PriorityNumberSP01 & 0x0007))
! 
! #define SCL_SET_S1PRIN(/* 3 bits */ s1prin) \
!   (SclPriBuffDirty.SclSpPriNum = 1, \
!    SclSpPriNum.PriorityNumberSP01 \
!    = (SclSpPriNum.PriorityNumberSP01 & 0xF0FF) | ((s1prin) << 8))
! 
! #define SCL_GET_S1PRIN() \
!   ((SclSpPriNum.PriorityNumberSP01 & 0x0700) >> 8)
! 
! #define SCL_SET_S2PRIN(/* 3 bits */ s2prin) \
!   (SclPriBuffDirty.SclSpPriNum = 1, \
!    SclSpPriNum.PriorityNumberSP23 \
!    = (SclSpPriNum.PriorityNumberSP23 & 0xFFF0) | ((s2prin)))
! 
! #define SCL_GET_S2PRIN() \
!   ((SclSpPriNum.PriorityNumberSP23 & 0x0007))
! 
! #define SCL_SET_S3PRIN(/* 3 bits */ s3prin) \
!   (SclPriBuffDirty.SclSpPriNum = 1, \
!    SclSpPriNum.PriorityNumberSP23 \
!    = (SclSpPriNum.PriorityNumberSP23 & 0xF0FF) | ((s3prin) << 8))
! 
! #define SCL_GET_S3PRIN() \
!   ((SclSpPriNum.PriorityNumberSP23 & 0x0700) >> 8)
! 
! #define SCL_SET_S4PRIN(/* 3 bits */ s4prin) \
!   (SclPriBuffDirty.SclSpPriNum = 1, \
!    SclSpPriNum.PriorityNumberSP45 \
!    = (SclSpPriNum.PriorityNumberSP45 & 0xFFF0) | ((s4prin)))
! 
! #define SCL_GET_S4PRIN() \
!   ((SclSpPriNum.PriorityNumberSP45 & 0x0007))
! 
! #define SCL_SET_S5PRIN(/* 3 bits */ s5prin) \
!   (SclPriBuffDirty.SclSpPriNum = 1, \
!    SclSpPriNum.PriorityNumberSP45 \
!    = (SclSpPriNum.PriorityNumberSP45 & 0xF0FF) | ((s5prin) << 8))
! 
! #define SCL_GET_S5PRIN() \
!   ((SclSpPriNum.PriorityNumberSP45 & 0x0700) >> 8)
! 
! #define SCL_SET_S6PRIN(/* 3 bits */ s6prin) \
!   (SclPriBuffDirty.SclSpPriNum = 1, \
!    SclSpPriNum.PriorityNumberSP67 \
!    = (SclSpPriNum.PriorityNumberSP67 & 0xFFF0) | ((s6prin)))
! 
! #define SCL_GET_S6PRIN() \
!   ((SclSpPriNum.PriorityNumberSP67 & 0x0007))
! 
! #define SCL_SET_S7PRIN(/* 3 bits */ s7prin) \
!   (SclPriBuffDirty.SclSpPriNum = 1, \
!    SclSpPriNum.PriorityNumberSP67 \
!    = (SclSpPriNum.PriorityNumberSP67 & 0xF0FF) | ((s7prin) << 8))
! 
! #define SCL_GET_S7PRIN() \
!   ((SclSpPriNum.PriorityNumberSP67 & 0x0700) >> 8)
! 
! /* VDP-II manual p.132 */
! /*------------------- スプライト用カラー演算割合レジスタ No.0-7 */
! 
! #define SCL_SET_S0CCRT(/* 5bits */ s0ccrt) \
!   (SclPriBuffDirty.SclSpColMix = 1, \
!    SclSpColMix.ColMixRateSP01 \
!    = (SclSpColMix.ColMixRateSP01 & 0xFF00) | ((s0ccrt)))
! 
! #define SCL_GET_S0CCRT() \
!   ((SclSpColMix.ColMixRateSP01 & 0x001F) >> 0)
! 
! #define SCL_SET_S1CCRT(/* 5bits */ s1ccrt) \
!   (SclPriBuffDirty.SclSpColMix = 1, \
!    SclSpColMix.ColMixRateSP01 \
!    = (SclSpColMix.ColMixRateSP01 & 0x00FF) | ((s1ccrt) << 8))
! 
! #define SCL_GET_S1CCRT() \
!   ((SclSpColMix.ColMixRateSP01 & 0x1F00) >> 8)
! 
! #define SCL_SET_S2CCRT(/* 5bits */ s2ccrt) \
!   (SclPriBuffDirty.SclSpColMix = 1, \
!    SclSpColMix.ColMixRateSP23 \
!    = (SclSpColMix.ColMixRateSP23 & 0xFF00) | ((s2ccrt)))
! 
! #define SCL_GET_S2CCRT() \
!   ((SclSpColMix.ColMixRateSP23 & 0x001F))
! 
! #define SCL_SET_S3CCRT(/* 5bits */ s3ccrt) \
!   (SclPriBuffDirty.SclSpColMix = 1, \
!    SclSpColMix.ColMixRateSP23 \
!    = (SclSpColMix.ColMixRateSP23 & 0x00FF) | ((s3ccrt) << 8))
! 
! #define SCL_GET_S3CCRT() \
!   ((SclSpColMix.ColMixRateSP23 & 0x1F00) >> 8)
! 
! #define SCL_SET_S4CCRT(/* 5bits */ s4ccrt) \
!   (SclPriBuffDirty.SclSpColMix = 1, \
!    SclSpColMix.ColMixRateSP45 \
!    = (SclSpColMix.ColMixRateSP45 & 0xFF00) | ((s4ccrt)))
! 
! #define SCL_GET_S4CCRT() \
!   ((SclSpColMix.ColMixRateSP45 & 0x001F))
! 
! #define SCL_SET_S5CCRT(/* 5bits */ s5ccrt) \
!   (SclPriBuffDirty.SclSpColMix = 1, \
!    SclSpColMix.ColMixRateSP45 \
!    = (SclSpColMix.ColMixRateSP45 & 0x00FF) | ((s5ccrt) << 8))
! 
! #define SCL_GET_S5CCRT() \
!   ((SclSpColMix.ColMixRateSP45 & 0x1F00) >> 8)
! 
! #define SCL_SET_S6CCRT(/* 5bits */ s6ccrt) \
!   (SclPriBuffDirty.SclSpColMix = 1, \
!    SclSpColMix.ColMixRateSP67 \
!    = (SclSpColMix.ColMixRateSP67 & 0xFF00) | ((s6ccrt)))
! 
! #define SCL_GET_S6CCRT() \
!   ((SclSpColMix.ColMixRateSP67 & 0x001F))
! 
! #define SCL_SET_S7CCRT(/* 5bits */ s7ccrt) \
!   (SclPriBuffDirty.SclSpColMix = 1, \
!    SclSpColMix.ColMixRateSP67 \
!    = (SclSpColMix.ColMixRateSP67 & 0x00FF) | ((s7ccrt) << 8))
! 
! #define SCL_GET_S7CCRT() \
!   ((SclSpColMix.ColMixRateSP67 & 0x1F00) >> 8)
! 
! /* VDP-II manual p.138 */
! /*-- カラー RAM アドレスオフセット N0|R1, N1|EXBG, N2, N3, R0, SPRITE */
! 
! #define SCL_SET_N0CAOS(/* 3bits */ n0caos) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorRamOffset0 \
!    = (SclOtherPri.ColorRamOffset0 & 0xFFF0) | ((n0caos)))
! 
! #define SCL_GET_N0CAOS() \
!   ((SclOtherPri.ColorRamOffset0 & 0x0007))
! 
! #define SCL_SET_N1CAOS(/* 3bits */ n1caos) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorRamOffset0 \
!    = (SclOtherPri.ColorRamOffset0 & 0xFF0F) | ((n1caos) << 4))
! 
! #define SCL_GET_N1CAOS() \
!   ((SclOtherPri.ColorRamOffset0 & 0x0070) >> 4)
! 
! #define SCL_SET_N2CAOS(/* 3bits */ n2caos) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorRamOffset0 \
!    = (SclOtherPri.ColorRamOffset0 & 0xF0FF) | ((n2caos) << 8))
! 
! #define SCL_GET_N2CAOS() \
!   ((SclOtherPri.ColorRamOffset0 & 0x0700) >> 8)
! 
! #define SCL_SET_N3CAOS(/* 3bits */ n3caos) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorRamOffset0 \
!    = (SclOtherPri.ColorRamOffset0 & 0x0FFF) | ((n3caos) << 12))
! 
! #define SCL_GET_N3CAOS() \
!   ((SclOtherPri.ColorRamOffset0 & 0x7000) >> 12)
! 
! #define SCL_SET_R0CAOS(/* 3bits */ r0caos) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorRamOffset1 \
!    = (SclOtherPri.ColorRamOffset1 & 0xFFF0) | ((r0caos) << 0))
! 
! #define SCL_GET_R0CAOS() \
!   ((SclOtherPri.ColorRamOffset1 & 0x0007) >> 0)
! 
! #define SCL_SET_SPCAOS(/* 3bits */ spcaos) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorRamOffset1 \
!    = (SclOtherPri.ColorRamOffset1 & 0xFF0F) | ((spcaos) << 4))
! 
! #define SCL_GET_SPCAOS() \
!   ((SclOtherPri.ColorRamOffset1 & 0x0070) >> 4)
! 
! 
! /*----- ラインカラー画面イネーブル N0|R1, N1|EXBG, N2, N3, R0, SPRITE */
! 
! #define SCL_SET_N0LCEN(/* 1bit */ n0lcen) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.LineColorEnable \
!    = (SclOtherPri.LineColorEnable & 0xFFFE) | ((n0lcen)))
! 
! #define SCL_GET_N0LCEN() \
!   ((SclOtherPri.LineColorEnable & 0x0001))
! 
! #define SCL_SET_N1LCEN(/* 1bit */ n1lcen) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.LineColorEnable \
!    = (SclOtherPri.LineColorEnable & 0xFFFD) | ((n1lcen) << 1))
! 
! #define SCL_GET_N1LCEN() \
!   ((SclOtherPri.LineColorEnable & 0x0002) >> 1)
! 
! #define SCL_SET_N2LCEN(/* 1bit */ n2lcen) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.LineColorEnable \
!    = (SclOtherPri.LineColorEnable & 0xFFFB) | ((n2lcen) << 2))
! 
! #define SCL_GET_N2LCEN() \
!   ((SclOtherPri.LineColorEnable & 0x0004) >> 2)
! 
! #define SCL_SET_N3LCEN(/* 1bit */ n3lcen) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.LineColorEnable \
!    = (SclOtherPri.LineColorEnable & 0xFFF7) | ((n3lcen) << 3))
! 
! #define SCL_GET_N3LCEN() \
!   ((SclOtherPri.LineColorEnable & 0x0008) >> 3)
! 
! #define SCL_SET_R0LCEN(/* 1bit */ r0lcen) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.LineColorEnable \
!    = (SclOtherPri.LineColorEnable & 0xFFEF) | ((r0lcen) << 4))
! 
! #define SCL_GET_R0LCEN() \
!   ((SclOtherPri.LineColorEnable & 0x0010) >> 4)
! 
! #define SCL_SET_SPLCEN(/* 1bit */ splcen) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.LineColorEnable \
!    = (SclOtherPri.LineColorEnable & 0xFFDF) | ((splcen) << 5))
! 
! #define SCL_GET_SPLCEN() \
!   ((SclOtherPri.LineColorEnable & 0x0020) >> 5)
! 
! /*-------- 特殊プライオリティモード N0|R1, N1|EXBG, N2, N3, R0 */
! 
! #define SCL_SET_N0SPRM(/* 2bits */ n0sprm) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.SpecialPriorityMode \
!    = (SclOtherPri.SpecialPriorityMode & 0xFFFC) | ((n0sprm)))
! 
! #define SCL_GET_N0SPRM() \
!   ((SclOtherPri.SpecialPriorityMode & 0x0003))
! 
! #define SCL_SET_N1SPRM(/* 2bits */ n1sprm) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.SpecialPriorityMode \
!    = (SclOtherPri.SpecialPriorityMode & 0xFFF3) | ((n1sprm) << 2))
! 
! #define SCL_GET_N1SPRM() \
!   ((SclOtherPri.SpecialPriorityMode & 0x000C) >> 2)
! 
! #define SCL_SET_N2SPRM(/* 2bits */ n2sprm) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.SpecialPriorityMode \
!    = (SclOtherPri.SpecialPriorityMode & 0xFFCF) | ((n2sprm) << 4))
! 
! #define SCL_GET_N2SPRM() \
!   ((SclOtherPri.SpecialPriorityMode & 0x0030) >> 4)
! 
! #define SCL_SET_N3SPRM(/* 2bits */ n3sprm) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.SpecialPriorityMode \
!    = (SclOtherPri.SpecialPriorityMode & 0xFF3F) | ((n3sprm) << 6))
! 
! #define SCL_GET_N3SPRM() \
!   ((SclOtherPri.SpecialPriorityMode & 0x00C0) >> 6)
! 
! #define SCL_SET_R0SPRM(/* 2bits */ r0sprm) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.SpecialPriorityMode \
!    = (SclOtherPri.SpecialPriorityMode & 0xFCFF) | ((r0sprm) << 8))
! 
! #define SCL_GET_R0SPRM() \
!   ((SclOtherPri.SpecialPriorityMode & 0x0300) >> 8)
! 
! /*---------プライオリティー番号 N0|R1, N1|EXBG, N2, N3, R0 */
! 
! #define SCL_SET_N0PRIN(/* 3 bits */ n0prin) \
!   (SclPriBuffDirty.SclBgPriNum = 1, \
!    SclBgPriNum.PriorityNumberNBG01 \
!    = (SclBgPriNum.PriorityNumberNBG01 & 0xFF00) | ((n0prin)))
! 
! #define SCL_GET_N0PRIN() \
!   ((SclBgPriNum.PriorityNumberNBG01 & 0x0007))
! 
! #define SCL_SET_N1PRIN(/* 3 bits */ n1prin) \
!   (SclPriBuffDirty.SclBgPriNum = 1, \
!    SclBgPriNum.PriorityNumberNBG01 \
!    = (SclBgPriNum.PriorityNumberNBG01 & 0x00FF) | ((n1prin) << 8))
! 
! #define SCL_GET_N1PRIN() \
!   ((SclBgPriNum.PriorityNumberNBG01 & 0x0700) >> 8)
! 
! #define SCL_SET_N2PRIN(/* 3 bits */ n2prin) \
!   (SclPriBuffDirty.SclBgPriNum = 1, \
!    SclBgPriNum.PriorityNumberNBG23 \
!    = (SclBgPriNum.PriorityNumberNBG23 & 0xFF00) | ((n2prin)))
! 
! #define SCL_GET_N2PRIN() \
!   ((SclBgPriNum.PriorityNumberNBG23 & 0x0007))
! 
! #define SCL_SET_N3PRIN(/* 3 bits */ n3prin) \
!   (SclPriBuffDirty.SclBgPriNum = 1, \
!    SclBgPriNum.PriorityNumberNBG23 \
!    = (SclBgPriNum.PriorityNumberNBG23 & 0x00FF) | ((n3prin) << 8))
! 
! #define SCL_GET_N3PRIN() \
!   ((SclBgPriNum.PriorityNumberNBG23 & 0x0700) >> 8)
! 
! #define SCL_SET_R0PRIN(/* 3 bits */ r0prin) \
!   (SclPriBuffDirty.SclBgPriNum = 1, \
!    SclBgPriNum.PriorityNumberRBG0 \
!    = ((r0prin)))
! 
! #define SCL_GET_R0PRIN() \
!    ((SclBgPriNum.PriorityNumberRBG0 & 0x0007))
! 
! #define SCL_SET_BOKEN(/* 1 bits */ boken) /* ボカシ演算イネーブル */\
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorMixControl \
!    = (SclOtherPri.ColorMixControl & 0x7FFF) | ((boken) << 15))
! 
! #define SCL_GET_B0KEN() \
!   ((SclOtherPri.ColorMixControl & 0x8000) >> 15)
! 
! #define SCL_SET_BOKN(/* 3 bits */ bokn) /* ボカシ画面番号 */\
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorMixControl \
!    = (SclOtherPri.ColorMixControl & 0x8FFF) | ((bokn) << 12))
! 
! #define SCL_GET_BOKN() \
!   ((SclOtherPri.ColorMixControl & 0x7000) >> 12)
! 
! #define SCL_SET_EXCCEN(/* 1 bit */ exccn) /* 拡張カラー演算イネーブル */\
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorMixControl \
!    = (SclOtherPri.ColorMixControl & 0xFBFF) | ((exccn) << 10))
! 
! #define SCL_GET_EXCCEN() \
!   ((SclOtherPri.ColorMixControl & 0x0400) >> 10)
! 
! #define SCL_SET_CCRTMD(/* 1 bit */ ccrtmd) /* カラー演算割合モード */\
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorMixControl \
!    = (SclOtherPri.ColorMixControl & 0xFDFF) | ((Uint32)(ccrtmd) << 9))
! 
! #define SCL_GET_CCRTMD() \
!   ((SclOtherPri.ColorMixControl & 0x0200) >> 9)
! 
! #define SCL_SET_CCMD(/* 1 bit */ ccmd) /* カラー演算モード */\
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorMixControl \
!    = (SclOtherPri.ColorMixControl & 0xFEFF) | ((Uint32)(ccmd) << 8))
! 
! #define SCL_GET_CCMD() \
!   ((SclOtherPri.ColorMixControl & 0x0100) >> 8)
! 
! /*------ カラー演算イネーブル N0|R1, N1|EXBG, N2, N3, R0, LC, SPRITE */ 
! #define SCL_SET_SPCCEN(/* 1 bit */ spccen) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorMixControl \
!    = (SclOtherPri.ColorMixControl & 0xFFBF) | ((spccen) << 6))
! 
! #define SCL_GET_SPCCEN() \
!   ((SclOtherPri.ColorMixControl & 0x0040) >> 6)
! 
! #define SCL_SET_LCCCEN(/* 1 bit */ lcccen) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorMixControl \
!    = (SclOtherPri.ColorMixControl & 0xFFDF) | ((lcccen) << 5))
! 
! #define SCL_GET_LCCCEN() \
!   ((SclOtherPri.ColorMixControl & 0x0020) >> 5)
! 
! #define SCL_SET_R0CCEN(/* 1 bit */ r0ccen) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorMixControl \
!    = (SclOtherPri.ColorMixControl & 0xFFEF) | ((r0ccen) << 4))
! 
! #define SCL_GET_R0CCEN() \
!   ((SclOtherPri.ColorMixControl & 0x0010) >> 4)
! 
! #define SCL_SET_N3CCEN(/* 1 bit */ n3ccen) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorMixControl \
!    = (SclOtherPri.ColorMixControl & 0xFFF7) | ((n3ccen) << 3))
! 
! #define SCL_GET_N3CCEN() \
!   ((SclOtherPri.ColorMixControl & 0x0008) >> 3)
! 
! #define SCL_SET_N2CCEN(/* 1 bit */ n2ccen) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorMixControl \
!    = (SclOtherPri.ColorMixControl & 0xFFFB) | ((n2ccen) << 2))
! 
! #define SCL_GET_N2CCEN() \
!   ((SclOtherPri.ColorMixControl & 0x0004) >> 2)
! 
! #define SCL_SET_N1CCEN(/* 1 bit */ n1ccen) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorMixControl \
!    = (SclOtherPri.ColorMixControl & 0xFFFD) | ((n1ccen) << 1))
!   
! #define SCL_GET_N1CCEN() \
!   ((SclOtherPri.ColorMixControl & 0x0002) >> 1)
! 
! #define SCL_SET_N0CCEN(/* 1 bit */ n0ccen) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorMixControl \
!    = (SclOtherPri.ColorMixControl & 0xFFFE) | ((n0ccen)))
! 
! #define SCL_GET_N0CCEN() \
!   ((SclOtherPri.ColorMixControl & 0x0001))
! 
! 
! /*-------------- 特殊カラー演算モード N0|R1, N1|EXBG, N2, N3, R0 */
! #define SCL_SET_N0SCCM(/* 2 bits */ n0sccm) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.SpecialColorMixMode \
!    = (SclOtherPri.SpecialColorMixMode & 0xFFFC) | ((n0sccm)))
! 
! #define SCL_GET_N0SCCM() \
!   ((SclOtherPri.SpecialColorMixMode & 0x0003))
! 
! #define SCL_SET_N1SCCM(/* 2 bits */ n1sccm) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.SpecialColorMixMode \
!    = (SclOtherPri.SpecialColorMixMode & 0xFFF3) | ((n1sccm) << 2))
! 
! #define SCL_GET_N1SCCM() \
!   ((SclOtherPri.SpecialColorMixMode & 0x000C) >> 2)
! 
! #define SCL_SET_N2SCCM(/* 2 bits */ n2sccm) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.SpecialColorMixMode \
!    = (SclOtherPri.SpecialColorMixMode & 0xFFCF) | ((n2sccm) << 4))
! 
! #define SCL_GET_N2SCCM() \
!   ((SclOtherPri.SpecialColorMixMode & 0x0030) >> 4)
! 
! #define SCL_SET_N3SCCM(/* 2 bits */ n3sccm) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.SpecialColorMixMode \
!    = (SclOtherPri.SpecialColorMixMode & 0xFF3F) | ((n3sccm) << 6))
! 
! #define SCL_GET_N3SCCM() \
!   ((SclOtherPri.SpecialColorMixMode & 0x00C0) >> 6)
! 
! #define SCL_SET_R0SCCM(/* 2 bits */ r0sccm) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.SpecialColorMixMode \
!   = (SclOtherPri.SpecialColorMixMode & 0xFCFF) | ((r0sccm) << 8))
! 
! #define SCL_GET_R0SCCM() \
!   ((SclOtherPri.SpecialColorMixMode & 0x0300) >> 8)
! 
! /*------ スクロール面用カラー演算割合 N0|R1, N1|EXBG, N2, N3, R0, LC, BACK */
! #define SCL_SET_N0CCRT(/* 5 bits */ n0ccrt) \
!   (SclPriBuffDirty.SclBgColMix = 1, \
!    SclBgColMix.ColMixRateNBG01 \
!    = (SclBgColMix.ColMixRateNBG01 & 0xFF00) | ((n0ccrt)))
! 
! #define SCL_GET_N0CCRT() \
!   ((SclBgColMix.ColMixRateNBG01 & 0x001F))
! 
! #define SCL_SET_N1CCRT(/* 5 bits */ n1ccrt) \
!   (SclPriBuffDirty.SclBgColMix = 1, \
!    SclBgColMix.ColMixRateNBG01 \
!    = (SclBgColMix.ColMixRateNBG01 & 0x00FF) | ((n1ccrt) << 8))
! 
! #define SCL_GET_N1CCRT() \
!   ((SclBgColMix.ColMixRateNBG01 & 0x1F00) >> 8)
! 
! #define SCL_SET_N2CCRT(/* 5 bits */ n2ccrt) \
!   (SclPriBuffDirty.SclBgColMix = 1, \
!    SclBgColMix.ColMixRateNBG23 \
!    = (SclBgColMix.ColMixRateNBG23 & 0xFF00) | ((n2ccrt)))
! 
! #define SCL_GET_N2CCRT() \
!   ((SclBgColMix.ColMixRateNBG23 & 0x001F))
! 
! #define SCL_SET_N3CCRT(/* 5 bits */ n3ccrt) \
!   (SclPriBuffDirty.SclBgColMix = 1, \
!    SclBgColMix.ColMixRateNBG23 \
!    = (SclBgColMix.ColMixRateNBG23 & 0x00FF) | ((n3ccrt) << 8))
! 
! #define SCL_GET_N3CCRT() \
!   ((SclBgColMix.ColMixRateNBG23 & 0x1F00) >> 8)
! 
! #define SCL_SET_R0CCRT(/* 5 bits */ r0ccrt) \
!   (SclPriBuffDirty.SclBgColMix = 1, \
!    SclBgColMix.ColMixRateRBG0 \
!    = ((r0ccrt)))
! 
! #define SCL_GET_R0CCRT() \
!   ((SclBgColMix.ColMixRateRBG0 & 0x001F))
! 
! #define SCL_SET_LCCCRT(/* 5 bits */ lcccrt) \
!   (SclPriBuffDirty.SclBgColMix = 1, \
!    SclBgColMix.ColMixRateLCBAK \
!    = (SclBgColMix.ColMixRateLCBAK & 0xFF00) | ((lcccrt)))
! 
! #define SCL_GET_LCCCRT() \
!   ((SclBgColMix.ColMixRateLCBAK & 0x001F))
! 
! #define SCL_SET_BKCCRT(/* 5 bits */ bkccrt) \
!   (SclPriBuffDirty.SclBgColMix = 1, \
!    SclBgColMix.ColMixRateLCBAK \
!    = (SclBgColMix.ColMixRateLCBAK & 0x00FF) | ((bkccrt) << 8))
! 
! #define SCL_GET_BKCCRT() \
!   ((SclBgColMix.ColMixRateLCBAK & 0x1F00) >> 8)
! 
! /*-- カラーオフセットイネーブル N0|R1, N1|EXBG, N2, N3, R0, BACK, SPRITE */
! 
! #define SCL_SET_N0COEN(/* 1 bit */ n0coen) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetEnable \
!    = (SclColOffset.ColorOffsetEnable & 0xFFFE) | ((n0coen)))
! 
! #define SCL_GET_N0COEN() \
!   ((SclColOffset.ColorOffsetEnable & 0x0001))
! 
! #define SCL_SET_N1COEN(/* 1 bit */ n1coen) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetEnable \
!    = (SclColOffset.ColorOffsetEnable & 0xFFFD) | ((n1coen) << 1))
! 
! #define SCL_GET_N1COEN() \
!   ((SclColOffset.ColorOffsetEnable & 0x0002) >> 1)
! 
! #define SCL_SET_N2COEN(/* 1 bit */ n2coen) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetEnable \
!    = (SclColOffset.ColorOffsetEnable & 0xFFFB) | ((n2coen) << 2))
! 
! #define SCL_GET_N2COEN() \
!   ((SclColOffset.ColorOffsetEnable & 0x0004) >> 2)
! 
! #define SCL_SET_N3COEN(/* 1 bit */ n3coen) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetEnable \
!    = (SclColOffset.ColorOffsetEnable & 0xFFF7) | ((n3coen) << 3))
! 
! #define SCL_GET_N3COEN() \
!   ((SclColOffset.ColorOffsetEnable & 0x0008) >> 3)
! 
! #define SCL_SET_R0COEN(/* 1 bit */ r0coen) \
!    (SclPriBuffDirty.SclColOffset = 1, \
!     SclColOffset.ColorOffsetEnable \
!     = (SclColOffset.ColorOffsetEnable & 0xFFEF) | ((r0coen) << 4))
! 
! #define SCL_GET_R0COEN() \
!   ((SclColOffset.ColorOffsetEnable & 0x0010) >> 4)
! 
! #define SCL_SET_BKCOEN(/* 1 bit */ bkcoen) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetEnable \
!    = (SclColOffset.ColorOffsetEnable & 0xFFDF) | ((bkcoen) << 5))
! 
! #define SCL_GET_BKCOEN() \
!   ((SclColOffset.ColorOffsetEnable & 0x0020) >> 5)
! 
! #define SCL_SET_SPCOEN(/* 1 bit */ spcoen) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetEnable \
!    = (SclColOffset.ColorOffsetEnable & 0xFFBF) | ((spcoen) << 6))
! 
! #define SCL_GET_SPCOEN() \
!   ((SclColOffset.ColorOffsetEnable & 0x0040) >> 6)
! 
! /*--- カラーオフセットレジスタ選択 N0|R1, N1|EXBG, N2, N3, R0, BACK, SPRITE */
! 
! #define SCL_SET_N0COSL(/* 1 bit */ n0cosl) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetSelect \
!    = (SclColOffset.ColorOffsetSelect & 0xFFFE) | (n0cosl))
! 
! #define SCL_GET_N0COSL() \
!   ((SclColOffset.ColorOffsetSelect & 0x0001))
! 
! #define SCL_SET_N1COSL(/* 1 bit */ n1cosl) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetSelect \
!    = (SclColOffset.ColorOffsetSelect & 0xFFFD) | ((n1cosl) << 1))
! 
! #define SCL_GET_N1COSL() \
!   ((SclColOffset.ColorOffsetSelect & 0x0002) >> 1)
! 
! #define SCL_SET_N2COSL(/* 1 bit */ n2cosl) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetSelect \
!    = (SclColOffset.ColorOffsetSelect & 0xFFFB) | ((n2cosl) << 2))
! 
! #define SCL_GET_N2COSL() \
!   ((SclColOffset.ColorOffsetSelect & 0x0004) >> 2)
! 
! #define SCL_SET_N3COSL(/* 1 bit */ n3cosl) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetSelect \
!    = (SclColOffset.ColorOffsetSelect & 0xFFF7) | ((n3cosl) << 3))
! 
! #define SCL_GET_N3COSL() \
!   ((SclColOffset.ColorOffsetSelect & 0x0008) >> 3)
! 
! #define SCL_SET_R0COSL(/* 1 bit */ r0cosl) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetSelect \
!    = (SclColOffset.ColorOffsetSelect & 0xFFEF) | ((r0cosl) << 4))
! 
! #define SCL_GET_R0COSL() \
!   ((SclColOffset.ColorOffsetSelect & 0x0010) >> 4)
! 
! #define SCL_SET_BKCOSL(/* 1 bit */ bkcosl) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetSelect \
!    = (SclColOffset.ColorOffsetSelect & 0xFFDF) | ((bkcosl) << 5))
! 
! #define SCL_GET_BKCOSL() \
!   ((SclColOffset.ColorOffsetSelect & 0x0020) >> 5)
! 
! #define SCL_SET_SPCOSL(/* 1 bit */ spcosl) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetSelect \
!    = (SclColOffset.ColorOffsetSelect & 0xFFBF) | ((spcosl) << 6))
! 
! #define SCL_GET_SPCOSL() \
!   ((SclColOffset.ColorOffsetSelect & 0x0040) >> 6)
! 
! /* カラーオフセットレジスタ A */
! #define SCL_SET_COARD(/* 9 bit */ coard) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetA_RED \
!    = (coard))
! 
! #define SCL_GET_COARD() \
!   (SclColOffset.ColorOffsetA_RED & 0x01FF)
! 
! #define SCL_SET_COAGR(/* 9 bit */ coagr) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetA_GREEN \
!    = (coagr))
! 
! #define SCL_GET_COAGR() \
!   (SclColOffset.ColorOffsetA_GREEN & 0x01FF)
! 
! #define SCL_SET_COABL(/* 9 bit */ coabl) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetA_BLUE \
!    = (coabl))
! 
! #define SCL_GET_COABL() \
!   (SclColOffset.ColorOffsetA_BLUE & 0x01FF)
! 
! /* カラーオフセットレジスタ B*/
! #define SCL_SET_COBRD(/* 9 bit */ cobrd) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetB_RED \
!    = (cobrd))
! 
! #define SCL_GET_COBRD() \
!    (SclColOffset.ColorOffsetB_RED & 0x01FF)
! 
! #define SCL_SET_COBGR(/* 9 bit */ cobgr) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetB_GREEN \
!    = (cobgr))
! 
! #define SCL_GET_COBGR() \
!   (SclColOffset.ColorOffsetB_GREEN & 0x01FF)
! 
! #define SCL_SET_COBBL(/* 9 bit */ cobbl) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetB_BLUE \
!    = (cobbl))
! 
! #define SCL_GET_COBBL() \
!   (SclColOffset.ColorOffsetB_BLUE & 0x01FF)
! 
! /*----------- シャドウコントロール N0|R1, N1|EXBG, N2, N3, R0, BACK */
! 
! #define SCL_SET_N0SDEN(/* 1 bit */ n0sden) \
!    (SclPriBuffDirty.SclOtherPri = 1, \
!     SclOtherPri.ShadowControl \
!     = (SclOtherPri.ShadowControl & 0xFFFE) | ((n0sden)))
! 
! #define SCL_GET_N0SDEN() \
!   ((SclOtherPri.ShadowControl & 0x0001))
! 
! #define SCL_SET_N1SDEN(/* 1 bit */ n1sden) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ShadowControl \
!    = (SclOtherPri.ShadowControl & 0xFFFD) | ((n1sden) << 1))
! 
! #define SCL_GET_N1SDEN() \
!   ((SclOtherPri.ShadowControl & 0x0002) >> 1)
! 
! #define SCL_SET_N2SDEN(/* 1 bit */ n2sden) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ShadowControl \
!    = (SclOtherPri.ShadowControl & 0xFFFB) | ((n2sden) << 2))
! 
! #define SCL_GET_N2SDEN() \
!   ((SclOtherPri.ShadowControl & 0x0004) >> 2)
! 
! #define SCL_SET_N3SDEN(/* 1 bit */ n3sden) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ShadowControl \
!    = (SclOtherPri.ShadowControl & 0xFFF7) | ((n3sden) << 3))
! 
! #define SCL_GET_N3SDEN() \
!   ((SclOtherPri.ShadowControl & 0x0008) >> 3)
! 
! #define SCL_SET_R0SDEN(/* 1 bit */ r0sden) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ShadowControl \
!    = (SclOtherPri.ShadowControl & 0xFFEF) | ((r0sden) << 4))
! 
! #define SCL_GET_R0SDEN() \
!   ((SclOtherPri.ShadowControl & 0x0010) >> 4)
! 
! #define SCL_SET_BKSDEN(/* 1 bit */ bksden) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ShadowControl \
!    = (SclOtherPri.ShadowControl & 0xFFDF) | ((bksden) << 5))
! 
! #define SCL_GET_BKSDEN() \
!   ((SclOtherPri.ShadowControl & 0x0020) >> 5)
! 
! /*--------------------------------------- 透明シャドウセレクト */
! #define SCL_SET_TPSDSL(/* 1 bit */ tpsden) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ShadowControl \
!    = (SclOtherPri.ShadowControl & 0xFEFF) | ((tpsden) << 8))
! 
! #define SCL_GET_TPSDSL() \
!   ((SclOtherPri.ShadowControl & 0x0100) >> 8)
! 
! /*---------------------------カラー RAM モード */
! /* 0x1800E 番地にあるので スクロールライブラリで設定する */
! 
! /* 値の定義 */
! 
! #define SCL_RBG0	0x00000001
! #define SCL_RBG1	0x00000002
! #define SCL_NBG0	0x00000004
! #define SCL_NBG1	0x00000008
! #define SCL_NBG2	0x00000010
! #define SCL_NBG3	0x00000020
! 
! #define SCL_EXBG	0x00000080
! #define SCL_SPR 	0x00000100
! #define SCL_SP0 	0x00000100
! #define SCL_SP1 	0x00000200
! #define SCL_SP2 	0x00000400
! #define SCL_SP3 	0x00000800
! #define SCL_SP4 	0x00001000
! #define SCL_SP5 	0x00002000
! #define SCL_SP6 	0x00004000
! #define SCL_SP7 	0x00008000
! #define SCL_RP  	0x00010000
! #define SCL_RP_R	0xfffeffff
! #define SCL_CC  	0x00020000
! #define SCL_LNCL	0x00040000
! #define SCL_BACK	0x00080000
! 
! #define SCL_RBG_TB_A	SCL_RBG0
! #define SCL_RBG_TB_B	SCL_RBG1
! 
! #define SCL_CRM15_1024 0
! #define SCL_CRM15_2048 1
! #define SCL_CRM24_1024 2
! 
! /* スプライトのタイプ指定 */
! #define SCL_TYPE0	0
! #define SCL_TYPE1	1
! #define SCL_TYPE2	2
! #define SCL_TYPE3	3
! #define SCL_TYPE4	4
! #define SCL_TYPE5	5
! #define SCL_TYPE6	6
! #define SCL_TYPE7	7
! #define SCL_TYPE8	8
! #define SCL_TYPE9	9
! #define SCL_TYPEA	10
! #define SCL_TYPEB	11
! #define SCL_TYPEC	12
! #define SCL_TYPED	13
! #define SCL_TYPEE	14
! #define SCL_TYPEF	15
! 
! #define SCL_PALETTE	0
! #define SCL_MIX 	1
! 
! #define SCL_MSB_SHADOW	0
! #define SCL_SP_WINDOW	1
! 
! #define SCL_IF_BEHIND	0
! #define SCL_IF_EQUAL	1
! #define SCL_IF_FRONT	2
! #define SCL_MSB_ON	3
! 
! #define SCL_OFFSET_A	0
! #define SCL_OFFSET_B	1
! 
! #endif /* __PRI_MACRO */
! 
! extern SclOtherPriRegister  SclOtherPri;  /* いろいろ */
! 
! extern SclSpPriNumRegister  SclSpPriNum;  /* スプライトのプライオリティ番号 */
! 
! extern SclBgPriNumRegister  SclBgPriNum;  /* スクロールのプライオリティ番号 */
! 
! extern SclSpColMixRegister  SclSpColMix;  /* スプライトの色演算 */
! 
! extern SclBgColMixRegister  SclBgColMix;  /* スクロールの色演算 */
! 
! extern SclColOffsetRegister SclColOffset; /* カラーオフセット */
! 
! extern SclPriBuffDirtyFlags SclPriBuffDirty; /* レジスタバッファのダーティー・フラグ */
! 
! /*--- REAL Priority Registers (Pointer) ---*/
! 
! extern SclOtherPriRegister  *SclRealOtherPri;
! 
! extern SclSpPriNumRegister  *SclRealSpPriNum;
! 
! extern SclBgPriNumRegister  *SclRealBgPriNum;
! 
! extern SclSpColMixRegister  *SclRealSpColMix;
! 
! extern SclBgColMixRegister  *SclRealBgColMix;
! 
! extern SclColOffsetRegister *SclRealColOffset;
! 
! #endif /* __PRI_GLVAR */
! 
! /* ＶＤＰ２ライブラリのプロトタイプ宣言 */
! #ifndef	SEGA_SCL_PROTO
! #define SEGA_SCL_PROTO
! 
! extern	void	SCL_Vdp2Init(void);
! extern	void	SCL_Vdp2_SGLInit(Uint16 tvmod);
! extern	void	SCL_SetDisplayMode(Uint8 interlace,Uint8 vertical,Uint8 horizontal);
! extern	void	SCL_InitVramConfigTb(SclVramConfig *tp);
! extern	void	SCL_InitConfigTb(SclConfig *scfg);
! extern	void	SCL_InitLineParamTb(SclLineparam *lp);
! extern	void	SCL_SetVramConfig(SclVramConfig *tp);
! extern	void	SCL_SetConfig(Uint16 sclnum, SclConfig *scfg);
! extern	void	SCL_SetCycleTable(Uint16 *tp);
! extern	void	SCL_Open(Uint32 sclnum);
! extern	void	SCL_Close(void);
! extern	void	SCL_SetLineParam(SclLineparam *lp);
! extern	void	SCL_MoveTo(Fixed32 x,Fixed32 y,Fixed32 z);
! extern	void	SCL_Move(Fixed32 x,Fixed32 y,Fixed32 z);
! extern	void	SCL_Scale(Fixed32 Sx, Fixed32 Sy);
! extern	void	SCL_SetColRamMode(Uint32 ComRamMode);
! extern	Uint32	SCL_InitRotateTable(Uint32 Address,Uint16 Mode,Uint32 rA,Uint32 rB);
! extern	void	SCL_RotateTo(Fixed32 xy,Fixed32 z,Fixed32 disp,Uint16 mode);
! extern	void	SCL_Rotate(Fixed32 xy,Fixed32 z,Fixed32 disp);
! extern	void	SCL_SetRotateViewPoint(Uint16 x,Uint16 y,Uint16 z);
! extern	void    SCL_SetRotateZoom(Fixed32 x,Fixed32 y);
! extern	void	SCL_SetRotateCenter(Uint16 x,Uint16 y,Uint16 z);
! extern	void	SCL_SetRotateCenterDisp(Uint16 x,Uint16 y);
! extern	void	SCL_SetCoefficientData(Uint32 sclnum,Uint16 *data,Uint16 x,Uint16 y);
! extern	void	SCL_SetLncl(Uint32 addr,Uint16 tbnum,Uint16 *palNumTb);
! extern	void	SCL_SetBack(Uint32 addr,Uint16 dataSize,Uint16 *dataTb);
! extern	void	SCL_SetMosaic(Uint32 surface,Uint8 x,Uint8 y);
! extern	void	SCL_SetSpriteMode(Uint8 Type, Uint8 ColMode, Uint8 WinMode);
! extern	Uint32	SCL_GetColRamMode(void);
! extern	void	SCL_SetColRam(Uint32 Object, Uint32 Index,Uint32 num,void *Color);
! extern	Uint32	SCL_AllocColRam(Uint32 Surface, Uint32 NumOfColors, Uint8 transparent);
! extern	void	SCL_FreeColRam(Uint32 Surface);
! extern	void	SCL_SetAutoColChg(Uint32 Surface,Uint32 Interval,Uint32 Index,
! 			Uint32 NumOfCol,Uint32 NumOfTbl,Uint32 *ChangeTbl);
! extern	Uint32	SCL_GetColRamOffset(Uint32 Object);
! extern	void	SCL_SetPriority(Uint32 Object, Uint8 Priority);
! extern	Uint8	SCL_GetPriority(Uint32 Object);
! extern	void	SCL_SetColMixMode(Uint32 ColMixPriority, Uint8 Mode);
! extern	void	SCL_SetColMixRate(Uint32 Surfaces, Uint8 Rate);
! extern	void	SCL_SetAutoColMix(Uint32 Surfaces,Uint32 Interval,Uint32 Time,
! 			Uint8 StartRate,Uint8 EndRate);
! extern	void	SCL_SetColOffset(Uint32 OffsetReg, Uint32 Surfaces,
! 			Sint16 red, Sint16 green, Sint16 blue);
! extern	void	SCL_IncColOffset(Uint32 OffsetReg,Sint16 red,Sint16 green,Sint16 blue);
! extern	void	SCL_SetAutoColOffset(Uint32 OffsetReg,Uint32 Interval,Uint32 Time,
! 				SclRgb *start,SclRgb *end);
! extern	void	SCL_EnableBlur(Uint32 Surface);
! extern	void	SCL_DisableBlur(void);
! extern	void	SCL_EnableLineCol(Uint32 Surface);
! extern	void	SCL_DisableLineCol(Uint32 Surface);
! extern	void	SCL_SetWindow(Uint8 win,Uint32 logic,Uint32 enable,Uint32 area,
! 			Uint16 sx,Uint16 sy,Uint16 ex,Uint16 ey);
! extern	void	SCL_SetLineWindow(Uint8 win,Uint32 logic,Uint32 enable,Uint32 area,
! 			Uint32 addr,Uint32 sy,Uint32 tbSize,SclLineWindowTb *tp);
! extern	void	SCL_SetSpriteWindow(Uint32 logic,Uint32 enable,Uint32 area);
! extern	void	SCL_SetFrameInterval(Uint16 count);
! extern	void	SCL_DisplayFrame(void);
! extern	void	SCL_VblankStart(void);
! extern	void	SCL_VblankEnd(void);
! extern	void	SCL_AbortAutoVe(void);
! 
! extern	void	SCL_SglOn(void);		/* tuika c.yoshida */
! extern	void	SCL_SglOff(void);		/* tuika c.yoshida */
! 
! /* 画面サイズデフォルト */
! extern	Uint16	SclDisplayX;
! extern	Uint16	SclDisplayY;
! 
! /* レジスタバッファ */
! extern	SclSysreg	Scl_s_reg;
! extern	SclDataset	Scl_d_reg;
! extern	SclNorscl	Scl_n_reg;
! extern	SclRotscl	Scl_r_reg;
! extern	SclWinscl	Scl_w_reg;
! extern	Uint16		SclProcess;
! extern	SclSblSgl	Scl_flag;
! 
! #endif /* SEGA_SCL_PROTO */
! 
\ No newline at end of file
--- 1,1425 ----
! /*------------------------------------------------------------------------
!  *  FILE:	SEGA_SCL.H
!  *
!  *	Copyright(c) 1994 SEGA
!  *
!  *  PURPOSE:
!  *	Scroll Simulation program header file
!  *	Scroll Register Data Structure Definition File
!  *
!  *  AUTHOR(S):
!  *	K.M
!  *		
!  *  MOD HISTORY:
!  *	Written by K.M on 1994-05-20 Ver.1.00
!  *	Updated by K.M on 1994-07-01 Ver.1.00
!  * 
!  *------------------------------------------------------------------------
!  */
! 
! #ifndef	SEGA_SCR_H
! #define SEGA_SCR_H
! 
! #include <sega_xpt.h>
! #include <sega_def.h>
! #include <sega_mth.h> 
! 
! #define VBR              0x06000000
! #define SCU_BASE         0x25FE0000
! #define SCU_INTR_MASK    0x000000a0
! #define SCU_INTR_STATUS  0x000000a4
! #define SETUINT   ((Sint32 (*)()) *((Uint32*)(VBR+0x300)))
! #define GETUINT   ((Sint32 (*)()) *((Uint32*)(VBR+0x304)))
! #define SETSINT   ((Sint32 (*)()) *((Uint32*)(VBR+0x310)))
! #define GETSINT   ((Sint32 (*)()) *((Uint32*)(VBR+0x314)))
! #define VBIVN	0x40
! #define VBOVN	0x41
! #define HBIVN	0x42
! 
! /*********************************************
!  *      System Register Cluster	             *
!  *      Address ranger 180000H - 180027H     *
!  *********************************************/
!  typedef struct	SclSysreg{
! 	Uint16	tvmode;			/* TV Mode */
! 	Uint16	extenbl;		/* External Input Enable */
! 	Uint16	tvstatus;		/* TV Status Read Only */
! 	Uint16	vramsize;		/* VRAM Size */
! 	Uint16	H_val;			/* H Counter Read Only */
! 	Uint16	V_val;			/* V Counter Read Only */
! 	Uint16	vramchg;		/* VRAM Change */
! 	Uint16	ramcontrl;		/* RAM Control */
! 	Uint16	vramcyc[8];		/* VRAM Cycle Table x8 */
! 	Uint16	dispenbl;		/* Display Enable */
! 	Uint16	mosaic;			/* Mosaic Control */
! 	Uint16	specialcode_sel;	/* Special Code Selector */
! 	Uint16	specialcode;		/* Special Code */
!  } SclSysreg;
! 
! /**********************************************
!  *      Scroll Data Set Register Cluster      *
!  *      Address ranger 180028H - 18006FH      *
!  **********************************************/
! typedef struct SclDataset{
! 	Uint16	charcontrl0;		/* Character Control */
! 	Uint16	charcontrl1;		/* Character Control */
! 	Uint16	bmpalnum0;		/* Bitmap Palette Number */
! 	Uint16	bmpalnum1;		/* Bitmap Palette Number */
! 	Uint16	patnamecontrl[5];	/* Pattern Name Controlx5 */
! 	Uint16	platesize;		/* Plate Size */	
! 	Uint16	mapoffset0;		/* Map Offset */
! 	Uint16	mapoffset1;		/* Map Offset */
! 	Uint16	normap[8];		/* Normal Scroll Map x8*/
! 	Uint16	rotmap[16];		/* Rotate Scroll Map x16*/
! } SclDataset;
! 
! /***************************************************
!  *      Normal Scroll Function Register Cluster    *
!  *      Address ranger 180070H - 1800AFH           *
!  ***************************************************/
! typedef struct SclNorscl{
! 	Fixed32	n0_move_x;		/* NBG0 Scroll Movement X */
! 	Fixed32	n0_move_y;		/* NBG0 Scroll Movement Y */
! 	Fixed32	n0_delta_x;		/* NBG0 Scroll Movement X */
! 	Fixed32	n0_delta_y;		/* NBG0 Scroll Movement Y */
! 	Fixed32	n1_move_x;		/* NBG1 Scroll Movement X */
! 	Fixed32	n1_move_y;		/* NBG1 Scroll Movement Y */
! 	Fixed32	n1_delta_x;		/* NBG1 Scroll Movement X */
! 	Fixed32	n1_delta_y;		/* NBG1 Scroll Movement Y */
! 	Uint16	n2_move_x;		/* NBG2 Scroll Movement X */
! 	Uint16	n2_move_y;		/* NBG2 Scroll Movement Y */
! 	Uint16	n3_move_x;		/* NBG3 Scroll Movement X */
! 	Uint16	n3_move_y;		/* NBG3 Scroll Movement Y */
! 	Uint16	zoomenbl;		/* Zoom Enable */
! 	Uint16	linecontrl;		/* Normal Extension Control */
! 	Uint32	celladdr;		/* Cell Scroll Table Address */
! 	Uint32	lineaddr[2];		/* Line Scroll Table Address x2 */
! 	Uint32	linecolmode;		/* Line BG Color Mode Address */
! 	Uint32	backcolmode;		/* Back BG Color Mode Address */
! } SclNorscl;
! 
! /****************************************************
!  *      Rotate Scroll Function Register Cluster     *
!  *      Address ranger 1800B0H - 1800BFH            *
!  ****************************************************/
! typedef struct SclRotscl{
! 	Uint16	paramode;		/* Rotate Parameter Mode */
! 	Uint16	paramcontrl;		/* Rotate Parameter Read Control */
! 	Uint16	k_contrl;		/* Keisu Table Control */
! 	Uint16	k_offset;		/* Keisu Addres Offset */
! 	Uint16	mapover[2];		/* Rotate Scroll Map Over */
! 	Uint32	paramaddr;		/* Rotate Parameter Tabel Address */
! } SclRotscl;
! 
! /***************************************************
!  *      Window Scroll Setting Register Cluster     *
!  *      Address ranger 1800C0H - 1800DFH           *
!  ***************************************************/
! typedef struct SclWinscl{
! 					/* 1800C0 */
! 	Uint16	win0_start[2];		/* Window #0 Start X & Y */
! 					/* 1800C4 */
! 	Uint16	win0_end[2];		/* Window #0 End X & Y */
! 					/* 1800C8 */
! 	Uint16	win1_start[2];		/* Window #1 Start X & Y */
! 					/* 1800CC */
! 	Uint16	win1_end[2];		/* Window #1 End X & Y */
! 					/* 1800D0 */
! 	Uint16	wincontrl[4];		/* Window Control */
! 					/* 1800D8 */
! 	Uint32 	linewin0_addr;		/* Line Window #0 Table Address */ 
! 					/* 1800DC */
! 	Uint32 	linewin1_addr;		/* Line Window #1 Table Address */ 
! } SclWinscl;
! 
! /***********************************************
!  *      Priority Related Register Cluster      *
!  ***********************************************/
! typedef struct SclPrior{
! 	Uint16	prnum;
! } SclPrior;
! 
! 
! /**************************************************
!  *      Scroll Parameters Definition              *
!  **************************************************/
! typedef struct  SclXy {
! 	 Fixed32         x;
! 	 Fixed32         y;
! } SclXy;
! 
! typedef struct  SclXyz {
! 	 Fixed32         x;
! 	 Fixed32         y;
! 	 Fixed32         z;
! } SclXyz;
! 
! typedef struct  SclXy16 {
!         Uint16         x;
!         Uint16         y;
! } SclXy16;
! 
! typedef struct  SclXyz16 {
!         Sint16         x;
!         Sint16         y;
!         Sint16         z;
! } SclXyz16;
! 
! typedef struct  SclRgb {
! 	 Sint16		red;
! 	 Sint16		green;
! 	 Sint16		blue;
! } SclRgb;
! 
! typedef struct  SclLineTb {
! 	 Fixed32	h;
! 	 Fixed32	v;
! 	 Fixed32	dh;
! } SclLineTb;
! 
! typedef struct  SclLineWindowTb {
! 	 Uint16		start;
! 	 Uint16		end;
! } SclLineWindowTb;
! 
! typedef struct SclVramConfig{
! 	Uint32	ktboffsetA;/* 回転ﾊﾟﾗﾒｰﾀA用係数ﾃｰﾌﾞﾙをﾊﾞﾝｸ中のどこに配置するか */
! 	Uint32	ktboffsetB;/* 回転ﾊﾟﾗﾒｰﾀB用係数ﾃｰﾌﾞﾙをﾊﾞﾝｸ中のどこに配置するか */
! 	Uint8	vramModeA; /* VRAM A を２つのバンクに区切るか指定(0/1)  */
! 	Uint8	vramModeB; /* VRAM B を２つのバンクに区切るか指定(0/1)  */
! 	Uint8	vramA0;    /* VRAM A or A0 を回転面の何で使用するか指定 */
! 	Uint8	vramA1;    /* VRAM A1 を回転面の何で使用するか指定      */
! 	Uint8	vramB0;    /* VRAM B or B0 を回転面の何で使用するか指定 */
! 	Uint8	vramB1;    /* VRAM B1 を回転面の何で使用するか指定      */
! 	Uint8	colram;    /* カラーＲＡＭに係数データを置くか？        */
! } SclVramConfig;
! 
! typedef struct SclRotreg{
! 	SclXyz		screenst;
! 	SclXy		screendlt;
! 	SclXy		delta;
! 	Fixed32		matrix_a;
! 	Fixed32		matrix_b;
! 	Fixed32		matrix_c;
! 	Fixed32		matrix_d;
! 	Fixed32		matrix_e;
! 	Fixed32		matrix_f;
! 	SclXyz16	viewp;
! 	Uint16		dummy1;
! 	SclXyz16	rotatecenter;
! 	Uint16		dummy2;
! 	SclXy		move;
! 	SclXy		zoom;
! 	Fixed32		k_tab;
! 	SclXy		k_delta;
! 	Fixed32		dummy3[8];
! } SclRotreg;
! 
! typedef struct SclRotparam{
! 	Uint32		addr;
! 	SclXyz		screenst;
! 	SclXy		screendlt;
! 	SclXy		delta;
! 	Fixed32		matrix_a;
! 	Fixed32		matrix_b;
! 	Fixed32		matrix_c;
! 	Fixed32		matrix_d;
! 	Fixed32		matrix_e;
! 	Fixed32		matrix_f;
! 	Fixed32		matrix_g;
! 	Fixed32		matrix_h;
! 	Fixed32		matrix_i;
! 	Fixed32		drotangle;
! 	SclXyz		viewp;
! 	SclXyz		rotatecenter;
! 	SclXyz		disprotcenter;
! 	SclXyz		move;
! 	SclXy		zoom;
! 	Fixed32		k_tab;
! 	SclXy		k_delta;
! 	Uint16		k_size;
! } SclRotparam;
! 
! /*******************************************
!  *      Scroll Configure Data Structure    *
!  *******************************************/
! typedef	struct	SclConfig {
! 	Uint8		dispenbl;
! 	Uint8		charsize;
! 	Uint8		pnamesize;
! 	Uint8		platesize;
! 	Uint8		bmpsize;
! 	Uint8		coltype;
! 	Uint8		datatype;
! 	Uint8		mapover;
! 	Uint8		flip;
! 	Uint16		patnamecontrl;
! 	Uint32		plate_addr[16];
! } SclConfig;
! 
! /******************************************************
!  *      Line & Cell Scroll Parameter Data Structure   *
!  ******************************************************/
! #define	SCL_MAXLINE	512
! #define	SCL_MAXCELL	64
! 
! typedef	struct	SclLineparam{
! 	Uint8		delta_enbl;
! 	Uint8		v_enbl;
! 	Uint8		h_enbl;
! 	Uint8		cell_enbl;
! 	Uint8		interval;
! 	Uint32		line_addr;
! 	Uint32		cell_addr;
! 	SclLineTb	line_tbl[SCL_MAXLINE];
! 	Fixed32		cell_tbl[SCL_MAXCELL];
! }	SclLineparam;
! 
! typedef	struct	SclLineWin{
! 	Uint16		winum;
! 	Uint16		y[2];
! 	Uint32		addr;
! 	SclXy16		tbl[SCL_MAXLINE];
! }	SclLineWin;
! 
! 
! #define SCL_VDP2_VRAM		0x25e00000
! #define SCL_VDP2_VRAM_A		0x25e00000
! #define SCL_VDP2_VRAM_A0	0x25e00000
! #define SCL_VDP2_VRAM_A1	0x25e20000
! #define SCL_VDP2_VRAM_B		0x25e40000
! #define SCL_VDP2_VRAM_B0	0x25e40000
! #define SCL_VDP2_VRAM_B1	0x25e60000
! #define	SCL_COLRAM_ADDR		0x25F00000	/* Color RAM */
! 
! #define SCL_NON			0   /* RBG0では使用しない        */
! #define SCL_RBG0_K 		1   /* RBG0の係数ﾃｰﾌﾞﾙを置く     */
! #define SCL_RBG0_PN 		2   /* RBG0のﾊﾟﾀｰﾝﾈｰﾑﾃｰﾌﾞﾙを置く */
! #define SCL_RBG0_CHAR 		3   /* RBG0のｷｬﾗｸﾀを置く         */
! #define SCL_RBG1_K 		4   /* RBG1の係数ﾃｰﾌﾞﾙを置く     */
! 
! #define	SCL_CHAR_SIZE_1X1	0
! #define	SCL_CHAR_SIZE_2X2	1
! 
! #define	SCL_PN2WORD		0
! #define	SCL_PN1WORD		1
! 
! #define	SCL_PL_SIZE_1X1		0
! #define	SCL_PL_SIZE_2X1		1
! #define	SCL_PL_SIZE_2X2		3
! 
! #define	SCL_BMP_SIZE_512X256	0
! #define	SCL_BMP_SIZE_512X512	1
! #define	SCL_BMP_SIZE_1024X256	2
! #define	SCL_BMP_SIZE_1024X512	3
! 
! #define	SCL_COL_TYPE_16		0
! #define	SCL_COL_TYPE_256	1
! #define	SCL_COL_TYPE_2048	2
! #define	SCL_COL_TYPE_32K	3
! #define	SCL_COL_TYPE_1M		4
! 
! #define	SCL_CELL		0
! #define	SCL_BITMAP		1
! 
! #define	SCL_OVER_0		0
! #define	SCL_OVER_1		1
! #define	SCL_OVER_2		2
! #define	SCL_OVER_3		3
! 
! #define	SCL_PN_10BIT		0
! #define	SCL_PN_12BIT		1
! 
! #define	SCL_1_LINE		0
! #define	SCL_2_LINE		1
! #define	SCL_4_LINE		2
! 
! #define	SCL_NON_INTER		0
! #define	SCL_SINGLE_INTER	2
! #define	SCL_DOUBLE_INTER	3
! 
! #define	SCL_224LINE		0
! #define	SCL_240LINE		1
! #define	SCL_256LINE		2
! 
! #define	SCL_NORMAL_A		0
! #define	SCL_NORMAL_B		1
! #define	SCL_HIRESO_A		2
! #define	SCL_HIRESO_B		3
! #define	SCL_NORMAL_AE		4
! #define	SCL_NORMAL_BE		5
! #define	SCL_HIRESO_AE		6
! #define	SCL_HIRESO_BE		7
! 
! #define	SCL_X_AXIS		1
! #define	SCL_Y_AXIS		2
! 
! #define	SCL_W0			0
! #define	SCL_W1			1
! 
! #define FIXED(x)	      ((Fixed32)((x) * 65536.0))
! #define MUL_FIXED(a, b)       MTH_Mul(a, b)
! #define DIV_FIXED(a, b)       MTH_Div(a, b)
! 
! #endif	/* ifndef SEGA_SCR_H */
! 
! 
! /*------------------------------------------------------------------------
!  *  
!  *
!  *  DESCRIPTION:
!  *
!  *          Header file for Priority library internal use.
!  *          Each Macro Set a parameter on Register buffer.
!  *          the buffer will copy to REAL regster while V-interval.
!  *          ここにあるマクロは、レジスタバッファに各コントロール値を
!  *          書き込み、書き込んだレジスタバッファのダーティーフラグを
!  *          1 にする。
! -------------------------------------------------------------------------*/
! 
! #ifndef __PRI_GLVAR
! #define __PRI_GLVAR
! 
! #ifndef __PRI_MACRO
! #define __PRI_MACRO
! 
! #ifndef __PRI_REG
! #define __PRI_REG
! 
! /*-----< other group regs >----*/
! typedef struct {
!     volatile Uint16 SpriteControl;		/* 1800E0 */
!     volatile Uint16 ShadowControl;		/* 1800E2 */
!     volatile Uint16 ColorRamOffset0;		/* 1800E4 */
!     volatile Uint16 ColorRamOffset1;		/* 1800E6 */
!     volatile Uint16 LineColorEnable;		/* 1800E8 */
!     volatile Uint16 SpecialPriorityMode;		/* 1800EA */
!     volatile Uint16 ColorMixControl;		/* 1800EC */
!     volatile Uint16 SpecialColorMixMode;		/* 1800EE */
! } SclOtherPriRegister;
! 
! /*----< sprite priority >----*/
! typedef struct {
!     volatile Uint16 PriorityNumberSP01;		/* 1800F0 */
!     volatile Uint16 PriorityNumberSP23;		/* 1800F2 */
!     volatile Uint16 PriorityNumberSP45;		/* 1800F4 */
!     volatile Uint16 PriorityNumberSP67;		/* 1800F6 */
! } SclSpPriNumRegister;
! 
! /*----< scroll priority >----*/
! typedef struct {
!     volatile Uint16 PriorityNumberNBG01;		/* 1800F8 */
!     volatile Uint16 PriorityNumberNBG23;		/* 1800FA */
!     volatile Uint16 PriorityNumberRBG0;		/* 1800FC */
! } SclBgPriNumRegister;
! 
! /*----< sprite color Mix >----*/
! typedef struct {
!     volatile Uint16 ColMixRateSP01;		/* 180100 */
!     volatile Uint16 ColMixRateSP23;		/* 180102 */
!     volatile Uint16 ColMixRateSP45;		/* 180104 */
!     volatile Uint16 ColMixRateSP67;		/* 180106 */
! } SclSpColMixRegister;
! 
! /*----< scroll color Mix >----*/
! typedef struct {
!     volatile Uint16 ColMixRateNBG01;		/* 180108 */
!     volatile Uint16 ColMixRateNBG23;		/* 18010A */
!     volatile Uint16 ColMixRateRBG0;		/* 18010C */
!     volatile Uint16 ColMixRateLCBAK;		/* 18010E */
! } SclBgColMixRegister;
! 
! /*----< color offset >----*/
! typedef struct {
!     volatile Uint16 ColorOffsetEnable;		/* 180110 */
!     volatile Uint16 ColorOffsetSelect;		/* 180112 */
!     volatile Uint16 ColorOffsetA_RED;		/* 180114 */
!     volatile Uint16 ColorOffsetA_GREEN;		/* 180116 */
!     volatile Uint16 ColorOffsetA_BLUE;		/* 180118 */
!     volatile Uint16 ColorOffsetB_RED;		/* 18011A */
!     volatile Uint16 ColorOffsetB_GREEN;		/* 18011E */
!     volatile Uint16 ColorOffsetB_BLUE;		/* 180120 */
! } SclColOffsetRegister;
! 
! /*---- レジスタバッファのダーティー・フラグ */
! typedef struct
! {
!     volatile Uint32 SclOtherPri:1;
!     volatile Uint32 SclSpPriNum:1;
!     volatile Uint32 SclBgPriNum:1;
!     volatile Uint32 SclSpColMix:1;
!     volatile Uint32 SclBgColMix:1;
!     volatile Uint32 SclColOffset:1;
! } SclPriBuffDirtyFlags;
! 
! #endif /* __PRI_REG */
! 
! 
! extern SclOtherPriRegister	SclOtherPri;
! extern SclSpPriNumRegister	SclSpPriNum;
! extern SclBgPriNumRegister	SclBgPriNum;
! extern SclSpColMixRegister	SclSpColMix;
! extern SclBgColMixRegister	SclBgColMix;
! extern SclColOffsetRegister	SclColOffset;
! extern SclPriBuffDirtyFlags	SclPriBuffDirty;
! 
! /* Following macros never check argument value range.*/
! 
! /* VDP-II manual p.129 */
! #define SCL_SET_SPCCCS(/* 2 bits */ spcccs) /* スプライト色演算条件 */\
!   (SclPriBuffDirty.SclOtherPri = 1,\
!    SclOtherPri.SpriteControl \
!    = (SclOtherPri.SpriteControl & 0x0FFF) | ((spcccs) << 12))
! 
! #define SCL_GET_SPCCCS() \
!   ((SclOtherPri.SpriteControl & 0x3000) >> 12)
! 
! #define SCL_SET_SPCCN(/* 3 bits */ spccn) /* スプライト色演算条件ナンバ */\
!   (SclPriBuffDirty.SclOtherPri = 1,\
!    SclOtherPri.SpriteControl \
!    = (SclOtherPri.SpriteControl & 0xF0FF) | ((spccn) << 8))
! 
! #define SCL_GET_SPCCN() \
!   ((SclOtherPri.SpriteControl & 0x0700) >> 8)
! 
! #define SCL_SET_SPCLMD(/* 1 bit */ spclmd) /* スプライトの色形式 */\
!   (SclPriBuffDirty.SclOtherPri = 1,\
!    SclOtherPri.SpriteControl \
!    = (SclOtherPri.SpriteControl & 0xFFDF) | ((spclmd) << 5))
! 
! #define SCL_GET_SPCLMD() \
!   ((SclOtherPri.SpriteControl & 0x0020) >> 5)
! 
! #define SCL_SET_SPWINEN(/* 1 bit */ spwinen) /* スプライトウィンドウイネーブル */\
!   (SclPriBuffDirty.SclOtherPri = 1,\
!    SclOtherPri.SpriteControl \
!    = (SclOtherPri.SpriteControl & 0xFFEF) | ((spwinen) << 4))    /* -> p.121 */
! 
! #define SCL_GET_SPWINEN() \
!   ((SclOtherPri.SpriteControl & 0x0010) >> 4)
! 
! #define SCL_SET_SPTYPE(/* 4bits */ sptype) /* スプライトのタイプ指定 */\
!   (SclPriBuffDirty.SclOtherPri = 1,\
!    SclOtherPri.SpriteControl \
!    = (SclOtherPri.SpriteControl & 0xFFF0) | (sptype))
! 
! #define SCL_GET_SPTYPE() \
!   (SclOtherPri.SpriteControl & 0x000F)
! 
! /* VDP-II manual p.131 */
! /*-------------------- スプライト用プライオリティレジスタ No.0-7 */
! 
! #define SCL_SET_S0PRIN(/* 3 bits */ s0prin) \
!   (SclPriBuffDirty.SclSpPriNum = 1,\
!    SclSpPriNum.PriorityNumberSP01 \
!    = (SclSpPriNum.PriorityNumberSP01 & 0xFFF0) | (s0prin))
! 
! #define SCL_GET_S0PRIN() \
!   ((SclSpPriNum.PriorityNumberSP01 & 0x0007))
! 
! #define SCL_SET_S1PRIN(/* 3 bits */ s1prin) \
!   (SclPriBuffDirty.SclSpPriNum = 1, \
!    SclSpPriNum.PriorityNumberSP01 \
!    = (SclSpPriNum.PriorityNumberSP01 & 0xF0FF) | ((s1prin) << 8))
! 
! #define SCL_GET_S1PRIN() \
!   ((SclSpPriNum.PriorityNumberSP01 & 0x0700) >> 8)
! 
! #define SCL_SET_S2PRIN(/* 3 bits */ s2prin) \
!   (SclPriBuffDirty.SclSpPriNum = 1, \
!    SclSpPriNum.PriorityNumberSP23 \
!    = (SclSpPriNum.PriorityNumberSP23 & 0xFFF0) | ((s2prin)))
! 
! #define SCL_GET_S2PRIN() \
!   ((SclSpPriNum.PriorityNumberSP23 & 0x0007))
! 
! #define SCL_SET_S3PRIN(/* 3 bits */ s3prin) \
!   (SclPriBuffDirty.SclSpPriNum = 1, \
!    SclSpPriNum.PriorityNumberSP23 \
!    = (SclSpPriNum.PriorityNumberSP23 & 0xF0FF) | ((s3prin) << 8))
! 
! #define SCL_GET_S3PRIN() \
!   ((SclSpPriNum.PriorityNumberSP23 & 0x0700) >> 8)
! 
! #define SCL_SET_S4PRIN(/* 3 bits */ s4prin) \
!   (SclPriBuffDirty.SclSpPriNum = 1, \
!    SclSpPriNum.PriorityNumberSP45 \
!    = (SclSpPriNum.PriorityNumberSP45 & 0xFFF0) | ((s4prin)))
! 
! #define SCL_GET_S4PRIN() \
!   ((SclSpPriNum.PriorityNumberSP45 & 0x0007))
! 
! #define SCL_SET_S5PRIN(/* 3 bits */ s5prin) \
!   (SclPriBuffDirty.SclSpPriNum = 1, \
!    SclSpPriNum.PriorityNumberSP45 \
!    = (SclSpPriNum.PriorityNumberSP45 & 0xF0FF) | ((s5prin) << 8))
! 
! #define SCL_GET_S5PRIN() \
!   ((SclSpPriNum.PriorityNumberSP45 & 0x0700) >> 8)
! 
! #define SCL_SET_S6PRIN(/* 3 bits */ s6prin) \
!   (SclPriBuffDirty.SclSpPriNum = 1, \
!    SclSpPriNum.PriorityNumberSP67 \
!    = (SclSpPriNum.PriorityNumberSP67 & 0xFFF0) | ((s6prin)))
! 
! #define SCL_GET_S6PRIN() \
!   ((SclSpPriNum.PriorityNumberSP67 & 0x0007))
! 
! #define SCL_SET_S7PRIN(/* 3 bits */ s7prin) \
!   (SclPriBuffDirty.SclSpPriNum = 1, \
!    SclSpPriNum.PriorityNumberSP67 \
!    = (SclSpPriNum.PriorityNumberSP67 & 0xF0FF) | ((s7prin) << 8))
! 
! #define SCL_GET_S7PRIN() \
!   ((SclSpPriNum.PriorityNumberSP67 & 0x0700) >> 8)
! 
! /* VDP-II manual p.132 */
! /*------------------- スプライト用カラー演算割合レジスタ No.0-7 */
! 
! #define SCL_SET_S0CCRT(/* 5bits */ s0ccrt) \
!   (SclPriBuffDirty.SclSpColMix = 1, \
!    SclSpColMix.ColMixRateSP01 \
!    = (SclSpColMix.ColMixRateSP01 & 0xFF00) | ((s0ccrt)))
! 
! #define SCL_GET_S0CCRT() \
!   ((SclSpColMix.ColMixRateSP01 & 0x001F) >> 0)
! 
! #define SCL_SET_S1CCRT(/* 5bits */ s1ccrt) \
!   (SclPriBuffDirty.SclSpColMix = 1, \
!    SclSpColMix.ColMixRateSP01 \
!    = (SclSpColMix.ColMixRateSP01 & 0x00FF) | ((s1ccrt) << 8))
! 
! #define SCL_GET_S1CCRT() \
!   ((SclSpColMix.ColMixRateSP01 & 0x1F00) >> 8)
! 
! #define SCL_SET_S2CCRT(/* 5bits */ s2ccrt) \
!   (SclPriBuffDirty.SclSpColMix = 1, \
!    SclSpColMix.ColMixRateSP23 \
!    = (SclSpColMix.ColMixRateSP23 & 0xFF00) | ((s2ccrt)))
! 
! #define SCL_GET_S2CCRT() \
!   ((SclSpColMix.ColMixRateSP23 & 0x001F))
! 
! #define SCL_SET_S3CCRT(/* 5bits */ s3ccrt) \
!   (SclPriBuffDirty.SclSpColMix = 1, \
!    SclSpColMix.ColMixRateSP23 \
!    = (SclSpColMix.ColMixRateSP23 & 0x00FF) | ((s3ccrt) << 8))
! 
! #define SCL_GET_S3CCRT() \
!   ((SclSpColMix.ColMixRateSP23 & 0x1F00) >> 8)
! 
! #define SCL_SET_S4CCRT(/* 5bits */ s4ccrt) \
!   (SclPriBuffDirty.SclSpColMix = 1, \
!    SclSpColMix.ColMixRateSP45 \
!    = (SclSpColMix.ColMixRateSP45 & 0xFF00) | ((s4ccrt)))
! 
! #define SCL_GET_S4CCRT() \
!   ((SclSpColMix.ColMixRateSP45 & 0x001F))
! 
! #define SCL_SET_S5CCRT(/* 5bits */ s5ccrt) \
!   (SclPriBuffDirty.SclSpColMix = 1, \
!    SclSpColMix.ColMixRateSP45 \
!    = (SclSpColMix.ColMixRateSP45 & 0x00FF) | ((s5ccrt) << 8))
! 
! #define SCL_GET_S5CCRT() \
!   ((SclSpColMix.ColMixRateSP45 & 0x1F00) >> 8)
! 
! #define SCL_SET_S6CCRT(/* 5bits */ s6ccrt) \
!   (SclPriBuffDirty.SclSpColMix = 1, \
!    SclSpColMix.ColMixRateSP67 \
!    = (SclSpColMix.ColMixRateSP67 & 0xFF00) | ((s6ccrt)))
! 
! #define SCL_GET_S6CCRT() \
!   ((SclSpColMix.ColMixRateSP67 & 0x001F))
! 
! #define SCL_SET_S7CCRT(/* 5bits */ s7ccrt) \
!   (SclPriBuffDirty.SclSpColMix = 1, \
!    SclSpColMix.ColMixRateSP67 \
!    = (SclSpColMix.ColMixRateSP67 & 0x00FF) | ((s7ccrt) << 8))
! 
! #define SCL_GET_S7CCRT() \
!   ((SclSpColMix.ColMixRateSP67 & 0x1F00) >> 8)
! 
! /* VDP-II manual p.138 */
! /*-- カラー RAM アドレスオフセット N0|R1, N1|EXBG, N2, N3, R0, SPRITE */
! 
! #define SCL_SET_N0CAOS(/* 3bits */ n0caos) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorRamOffset0 \
!    = (SclOtherPri.ColorRamOffset0 & 0xFFF0) | ((n0caos)))
! 
! #define SCL_GET_N0CAOS() \
!   ((SclOtherPri.ColorRamOffset0 & 0x0007))
! 
! #define SCL_SET_N1CAOS(/* 3bits */ n1caos) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorRamOffset0 \
!    = (SclOtherPri.ColorRamOffset0 & 0xFF0F) | ((n1caos) << 4))
! 
! #define SCL_GET_N1CAOS() \
!   ((SclOtherPri.ColorRamOffset0 & 0x0070) >> 4)
! 
! #define SCL_SET_N2CAOS(/* 3bits */ n2caos) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorRamOffset0 \
!    = (SclOtherPri.ColorRamOffset0 & 0xF0FF) | ((n2caos) << 8))
! 
! #define SCL_GET_N2CAOS() \
!   ((SclOtherPri.ColorRamOffset0 & 0x0700) >> 8)
! 
! #define SCL_SET_N3CAOS(/* 3bits */ n3caos) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorRamOffset0 \
!    = (SclOtherPri.ColorRamOffset0 & 0x0FFF) | ((n3caos) << 12))
! 
! #define SCL_GET_N3CAOS() \
!   ((SclOtherPri.ColorRamOffset0 & 0x7000) >> 12)
! 
! #define SCL_SET_R0CAOS(/* 3bits */ r0caos) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorRamOffset1 \
!    = (SclOtherPri.ColorRamOffset1 & 0xFFF0) | ((r0caos) << 0))
! 
! #define SCL_GET_R0CAOS() \
!   ((SclOtherPri.ColorRamOffset1 & 0x0007) >> 0)
! 
! #define SCL_SET_SPCAOS(/* 3bits */ spcaos) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorRamOffset1 \
!    = (SclOtherPri.ColorRamOffset1 & 0xFF0F) | ((spcaos) << 4))
! 
! #define SCL_GET_SPCAOS() \
!   ((SclOtherPri.ColorRamOffset1 & 0x0070) >> 4)
! 
! 
! /*----- ラインカラー画面イネーブル N0|R1, N1|EXBG, N2, N3, R0, SPRITE */
! 
! #define SCL_SET_N0LCEN(/* 1bit */ n0lcen) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.LineColorEnable \
!    = (SclOtherPri.LineColorEnable & 0xFFFE) | ((n0lcen)))
! 
! #define SCL_GET_N0LCEN() \
!   ((SclOtherPri.LineColorEnable & 0x0001))
! 
! #define SCL_SET_N1LCEN(/* 1bit */ n1lcen) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.LineColorEnable \
!    = (SclOtherPri.LineColorEnable & 0xFFFD) | ((n1lcen) << 1))
! 
! #define SCL_GET_N1LCEN() \
!   ((SclOtherPri.LineColorEnable & 0x0002) >> 1)
! 
! #define SCL_SET_N2LCEN(/* 1bit */ n2lcen) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.LineColorEnable \
!    = (SclOtherPri.LineColorEnable & 0xFFFB) | ((n2lcen) << 2))
! 
! #define SCL_GET_N2LCEN() \
!   ((SclOtherPri.LineColorEnable & 0x0004) >> 2)
! 
! #define SCL_SET_N3LCEN(/* 1bit */ n3lcen) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.LineColorEnable \
!    = (SclOtherPri.LineColorEnable & 0xFFF7) | ((n3lcen) << 3))
! 
! #define SCL_GET_N3LCEN() \
!   ((SclOtherPri.LineColorEnable & 0x0008) >> 3)
! 
! #define SCL_SET_R0LCEN(/* 1bit */ r0lcen) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.LineColorEnable \
!    = (SclOtherPri.LineColorEnable & 0xFFEF) | ((r0lcen) << 4))
! 
! #define SCL_GET_R0LCEN() \
!   ((SclOtherPri.LineColorEnable & 0x0010) >> 4)
! 
! #define SCL_SET_SPLCEN(/* 1bit */ splcen) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.LineColorEnable \
!    = (SclOtherPri.LineColorEnable & 0xFFDF) | ((splcen) << 5))
! 
! #define SCL_GET_SPLCEN() \
!   ((SclOtherPri.LineColorEnable & 0x0020) >> 5)
! 
! /*-------- 特殊プライオリティモード N0|R1, N1|EXBG, N2, N3, R0 */
! 
! #define SCL_SET_N0SPRM(/* 2bits */ n0sprm) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.SpecialPriorityMode \
!    = (SclOtherPri.SpecialPriorityMode & 0xFFFC) | ((n0sprm)))
! 
! #define SCL_GET_N0SPRM() \
!   ((SclOtherPri.SpecialPriorityMode & 0x0003))
! 
! #define SCL_SET_N1SPRM(/* 2bits */ n1sprm) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.SpecialPriorityMode \
!    = (SclOtherPri.SpecialPriorityMode & 0xFFF3) | ((n1sprm) << 2))
! 
! #define SCL_GET_N1SPRM() \
!   ((SclOtherPri.SpecialPriorityMode & 0x000C) >> 2)
! 
! #define SCL_SET_N2SPRM(/* 2bits */ n2sprm) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.SpecialPriorityMode \
!    = (SclOtherPri.SpecialPriorityMode & 0xFFCF) | ((n2sprm) << 4))
! 
! #define SCL_GET_N2SPRM() \
!   ((SclOtherPri.SpecialPriorityMode & 0x0030) >> 4)
! 
! #define SCL_SET_N3SPRM(/* 2bits */ n3sprm) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.SpecialPriorityMode \
!    = (SclOtherPri.SpecialPriorityMode & 0xFF3F) | ((n3sprm) << 6))
! 
! #define SCL_GET_N3SPRM() \
!   ((SclOtherPri.SpecialPriorityMode & 0x00C0) >> 6)
! 
! #define SCL_SET_R0SPRM(/* 2bits */ r0sprm) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.SpecialPriorityMode \
!    = (SclOtherPri.SpecialPriorityMode & 0xFCFF) | ((r0sprm) << 8))
! 
! #define SCL_GET_R0SPRM() \
!   ((SclOtherPri.SpecialPriorityMode & 0x0300) >> 8)
! 
! /*---------プライオリティー番号 N0|R1, N1|EXBG, N2, N3, R0 */
! 
! #define SCL_SET_N0PRIN(/* 3 bits */ n0prin) \
!   (SclPriBuffDirty.SclBgPriNum = 1, \
!    SclBgPriNum.PriorityNumberNBG01 \
!    = (SclBgPriNum.PriorityNumberNBG01 & 0xFF00) | ((n0prin)))
! 
! #define SCL_GET_N0PRIN() \
!   ((SclBgPriNum.PriorityNumberNBG01 & 0x0007))
! 
! #define SCL_SET_N1PRIN(/* 3 bits */ n1prin) \
!   (SclPriBuffDirty.SclBgPriNum = 1, \
!    SclBgPriNum.PriorityNumberNBG01 \
!    = (SclBgPriNum.PriorityNumberNBG01 & 0x00FF) | ((n1prin) << 8))
! 
! #define SCL_GET_N1PRIN() \
!   ((SclBgPriNum.PriorityNumberNBG01 & 0x0700) >> 8)
! 
! #define SCL_SET_N2PRIN(/* 3 bits */ n2prin) \
!   (SclPriBuffDirty.SclBgPriNum = 1, \
!    SclBgPriNum.PriorityNumberNBG23 \
!    = (SclBgPriNum.PriorityNumberNBG23 & 0xFF00) | ((n2prin)))
! 
! #define SCL_GET_N2PRIN() \
!   ((SclBgPriNum.PriorityNumberNBG23 & 0x0007))
! 
! #define SCL_SET_N3PRIN(/* 3 bits */ n3prin) \
!   (SclPriBuffDirty.SclBgPriNum = 1, \
!    SclBgPriNum.PriorityNumberNBG23 \
!    = (SclBgPriNum.PriorityNumberNBG23 & 0x00FF) | ((n3prin) << 8))
! 
! #define SCL_GET_N3PRIN() \
!   ((SclBgPriNum.PriorityNumberNBG23 & 0x0700) >> 8)
! 
! #define SCL_SET_R0PRIN(/* 3 bits */ r0prin) \
!   (SclPriBuffDirty.SclBgPriNum = 1, \
!    SclBgPriNum.PriorityNumberRBG0 \
!    = ((r0prin)))
! 
! #define SCL_GET_R0PRIN() \
!    ((SclBgPriNum.PriorityNumberRBG0 & 0x0007))
! 
! #define SCL_SET_BOKEN(/* 1 bits */ boken) /* ボカシ演算イネーブル */\
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorMixControl \
!    = (SclOtherPri.ColorMixControl & 0x7FFF) | ((boken) << 15))
! 
! #define SCL_GET_B0KEN() \
!   ((SclOtherPri.ColorMixControl & 0x8000) >> 15)
! 
! #define SCL_SET_BOKN(/* 3 bits */ bokn) /* ボカシ画面番号 */\
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorMixControl \
!    = (SclOtherPri.ColorMixControl & 0x8FFF) | ((bokn) << 12))
! 
! #define SCL_GET_BOKN() \
!   ((SclOtherPri.ColorMixControl & 0x7000) >> 12)
! 
! #define SCL_SET_EXCCEN(/* 1 bit */ exccn) /* 拡張カラー演算イネーブル */\
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorMixControl \
!    = (SclOtherPri.ColorMixControl & 0xFBFF) | ((exccn) << 10))
! 
! #define SCL_GET_EXCCEN() \
!   ((SclOtherPri.ColorMixControl & 0x0400) >> 10)
! 
! #define SCL_SET_CCRTMD(/* 1 bit */ ccrtmd) /* カラー演算割合モード */\
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorMixControl \
!    = (SclOtherPri.ColorMixControl & 0xFDFF) | ((Uint32)(ccrtmd) << 9))
! 
! #define SCL_GET_CCRTMD() \
!   ((SclOtherPri.ColorMixControl & 0x0200) >> 9)
! 
! #define SCL_SET_CCMD(/* 1 bit */ ccmd) /* カラー演算モード */\
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorMixControl \
!    = (SclOtherPri.ColorMixControl & 0xFEFF) | ((Uint32)(ccmd) << 8))
! 
! #define SCL_GET_CCMD() \
!   ((SclOtherPri.ColorMixControl & 0x0100) >> 8)
! 
! /*------ カラー演算イネーブル N0|R1, N1|EXBG, N2, N3, R0, LC, SPRITE */ 
! #define SCL_SET_SPCCEN(/* 1 bit */ spccen) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorMixControl \
!    = (SclOtherPri.ColorMixControl & 0xFFBF) | ((spccen) << 6))
! 
! #define SCL_GET_SPCCEN() \
!   ((SclOtherPri.ColorMixControl & 0x0040) >> 6)
! 
! #define SCL_SET_LCCCEN(/* 1 bit */ lcccen) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorMixControl \
!    = (SclOtherPri.ColorMixControl & 0xFFDF) | ((lcccen) << 5))
! 
! #define SCL_GET_LCCCEN() \
!   ((SclOtherPri.ColorMixControl & 0x0020) >> 5)
! 
! #define SCL_SET_R0CCEN(/* 1 bit */ r0ccen) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorMixControl \
!    = (SclOtherPri.ColorMixControl & 0xFFEF) | ((r0ccen) << 4))
! 
! #define SCL_GET_R0CCEN() \
!   ((SclOtherPri.ColorMixControl & 0x0010) >> 4)
! 
! #define SCL_SET_N3CCEN(/* 1 bit */ n3ccen) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorMixControl \
!    = (SclOtherPri.ColorMixControl & 0xFFF7) | ((n3ccen) << 3))
! 
! #define SCL_GET_N3CCEN() \
!   ((SclOtherPri.ColorMixControl & 0x0008) >> 3)
! 
! #define SCL_SET_N2CCEN(/* 1 bit */ n2ccen) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorMixControl \
!    = (SclOtherPri.ColorMixControl & 0xFFFB) | ((n2ccen) << 2))
! 
! #define SCL_GET_N2CCEN() \
!   ((SclOtherPri.ColorMixControl & 0x0004) >> 2)
! 
! #define SCL_SET_N1CCEN(/* 1 bit */ n1ccen) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorMixControl \
!    = (SclOtherPri.ColorMixControl & 0xFFFD) | ((n1ccen) << 1))
!   
! #define SCL_GET_N1CCEN() \
!   ((SclOtherPri.ColorMixControl & 0x0002) >> 1)
! 
! #define SCL_SET_N0CCEN(/* 1 bit */ n0ccen) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ColorMixControl \
!    = (SclOtherPri.ColorMixControl & 0xFFFE) | ((n0ccen)))
! 
! #define SCL_GET_N0CCEN() \
!   ((SclOtherPri.ColorMixControl & 0x0001))
! 
! 
! /*-------------- 特殊カラー演算モード N0|R1, N1|EXBG, N2, N3, R0 */
! #define SCL_SET_N0SCCM(/* 2 bits */ n0sccm) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.SpecialColorMixMode \
!    = (SclOtherPri.SpecialColorMixMode & 0xFFFC) | ((n0sccm)))
! 
! #define SCL_GET_N0SCCM() \
!   ((SclOtherPri.SpecialColorMixMode & 0x0003))
! 
! #define SCL_SET_N1SCCM(/* 2 bits */ n1sccm) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.SpecialColorMixMode \
!    = (SclOtherPri.SpecialColorMixMode & 0xFFF3) | ((n1sccm) << 2))
! 
! #define SCL_GET_N1SCCM() \
!   ((SclOtherPri.SpecialColorMixMode & 0x000C) >> 2)
! 
! #define SCL_SET_N2SCCM(/* 2 bits */ n2sccm) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.SpecialColorMixMode \
!    = (SclOtherPri.SpecialColorMixMode & 0xFFCF) | ((n2sccm) << 4))
! 
! #define SCL_GET_N2SCCM() \
!   ((SclOtherPri.SpecialColorMixMode & 0x0030) >> 4)
! 
! #define SCL_SET_N3SCCM(/* 2 bits */ n3sccm) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.SpecialColorMixMode \
!    = (SclOtherPri.SpecialColorMixMode & 0xFF3F) | ((n3sccm) << 6))
! 
! #define SCL_GET_N3SCCM() \
!   ((SclOtherPri.SpecialColorMixMode & 0x00C0) >> 6)
! 
! #define SCL_SET_R0SCCM(/* 2 bits */ r0sccm) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.SpecialColorMixMode \
!   = (SclOtherPri.SpecialColorMixMode & 0xFCFF) | ((r0sccm) << 8))
! 
! #define SCL_GET_R0SCCM() \
!   ((SclOtherPri.SpecialColorMixMode & 0x0300) >> 8)
! 
! /*------ スクロール面用カラー演算割合 N0|R1, N1|EXBG, N2, N3, R0, LC, BACK */
! #define SCL_SET_N0CCRT(/* 5 bits */ n0ccrt) \
!   (SclPriBuffDirty.SclBgColMix = 1, \
!    SclBgColMix.ColMixRateNBG01 \
!    = (SclBgColMix.ColMixRateNBG01 & 0xFF00) | ((n0ccrt)))
! 
! #define SCL_GET_N0CCRT() \
!   ((SclBgColMix.ColMixRateNBG01 & 0x001F))
! 
! #define SCL_SET_N1CCRT(/* 5 bits */ n1ccrt) \
!   (SclPriBuffDirty.SclBgColMix = 1, \
!    SclBgColMix.ColMixRateNBG01 \
!    = (SclBgColMix.ColMixRateNBG01 & 0x00FF) | ((n1ccrt) << 8))
! 
! #define SCL_GET_N1CCRT() \
!   ((SclBgColMix.ColMixRateNBG01 & 0x1F00) >> 8)
! 
! #define SCL_SET_N2CCRT(/* 5 bits */ n2ccrt) \
!   (SclPriBuffDirty.SclBgColMix = 1, \
!    SclBgColMix.ColMixRateNBG23 \
!    = (SclBgColMix.ColMixRateNBG23 & 0xFF00) | ((n2ccrt)))
! 
! #define SCL_GET_N2CCRT() \
!   ((SclBgColMix.ColMixRateNBG23 & 0x001F))
! 
! #define SCL_SET_N3CCRT(/* 5 bits */ n3ccrt) \
!   (SclPriBuffDirty.SclBgColMix = 1, \
!    SclBgColMix.ColMixRateNBG23 \
!    = (SclBgColMix.ColMixRateNBG23 & 0x00FF) | ((n3ccrt) << 8))
! 
! #define SCL_GET_N3CCRT() \
!   ((SclBgColMix.ColMixRateNBG23 & 0x1F00) >> 8)
! 
! #define SCL_SET_R0CCRT(/* 5 bits */ r0ccrt) \
!   (SclPriBuffDirty.SclBgColMix = 1, \
!    SclBgColMix.ColMixRateRBG0 \
!    = ((r0ccrt)))
! 
! #define SCL_GET_R0CCRT() \
!   ((SclBgColMix.ColMixRateRBG0 & 0x001F))
! 
! #define SCL_SET_LCCCRT(/* 5 bits */ lcccrt) \
!   (SclPriBuffDirty.SclBgColMix = 1, \
!    SclBgColMix.ColMixRateLCBAK \
!    = (SclBgColMix.ColMixRateLCBAK & 0xFF00) | ((lcccrt)))
! 
! #define SCL_GET_LCCCRT() \
!   ((SclBgColMix.ColMixRateLCBAK & 0x001F))
! 
! #define SCL_SET_BKCCRT(/* 5 bits */ bkccrt) \
!   (SclPriBuffDirty.SclBgColMix = 1, \
!    SclBgColMix.ColMixRateLCBAK \
!    = (SclBgColMix.ColMixRateLCBAK & 0x00FF) | ((bkccrt) << 8))
! 
! #define SCL_GET_BKCCRT() \
!   ((SclBgColMix.ColMixRateLCBAK & 0x1F00) >> 8)
! 
! /*-- カラーオフセットイネーブル N0|R1, N1|EXBG, N2, N3, R0, BACK, SPRITE */
! 
! #define SCL_SET_N0COEN(/* 1 bit */ n0coen) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetEnable \
!    = (SclColOffset.ColorOffsetEnable & 0xFFFE) | ((n0coen)))
! 
! #define SCL_GET_N0COEN() \
!   ((SclColOffset.ColorOffsetEnable & 0x0001))
! 
! #define SCL_SET_N1COEN(/* 1 bit */ n1coen) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetEnable \
!    = (SclColOffset.ColorOffsetEnable & 0xFFFD) | ((n1coen) << 1))
! 
! #define SCL_GET_N1COEN() \
!   ((SclColOffset.ColorOffsetEnable & 0x0002) >> 1)
! 
! #define SCL_SET_N2COEN(/* 1 bit */ n2coen) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetEnable \
!    = (SclColOffset.ColorOffsetEnable & 0xFFFB) | ((n2coen) << 2))
! 
! #define SCL_GET_N2COEN() \
!   ((SclColOffset.ColorOffsetEnable & 0x0004) >> 2)
! 
! #define SCL_SET_N3COEN(/* 1 bit */ n3coen) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetEnable \
!    = (SclColOffset.ColorOffsetEnable & 0xFFF7) | ((n3coen) << 3))
! 
! #define SCL_GET_N3COEN() \
!   ((SclColOffset.ColorOffsetEnable & 0x0008) >> 3)
! 
! #define SCL_SET_R0COEN(/* 1 bit */ r0coen) \
!    (SclPriBuffDirty.SclColOffset = 1, \
!     SclColOffset.ColorOffsetEnable \
!     = (SclColOffset.ColorOffsetEnable & 0xFFEF) | ((r0coen) << 4))
! 
! #define SCL_GET_R0COEN() \
!   ((SclColOffset.ColorOffsetEnable & 0x0010) >> 4)
! 
! #define SCL_SET_BKCOEN(/* 1 bit */ bkcoen) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetEnable \
!    = (SclColOffset.ColorOffsetEnable & 0xFFDF) | ((bkcoen) << 5))
! 
! #define SCL_GET_BKCOEN() \
!   ((SclColOffset.ColorOffsetEnable & 0x0020) >> 5)
! 
! #define SCL_SET_SPCOEN(/* 1 bit */ spcoen) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetEnable \
!    = (SclColOffset.ColorOffsetEnable & 0xFFBF) | ((spcoen) << 6))
! 
! #define SCL_GET_SPCOEN() \
!   ((SclColOffset.ColorOffsetEnable & 0x0040) >> 6)
! 
! /*--- カラーオフセットレジスタ選択 N0|R1, N1|EXBG, N2, N3, R0, BACK, SPRITE */
! 
! #define SCL_SET_N0COSL(/* 1 bit */ n0cosl) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetSelect \
!    = (SclColOffset.ColorOffsetSelect & 0xFFFE) | (n0cosl))
! 
! #define SCL_GET_N0COSL() \
!   ((SclColOffset.ColorOffsetSelect & 0x0001))
! 
! #define SCL_SET_N1COSL(/* 1 bit */ n1cosl) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetSelect \
!    = (SclColOffset.ColorOffsetSelect & 0xFFFD) | ((n1cosl) << 1))
! 
! #define SCL_GET_N1COSL() \
!   ((SclColOffset.ColorOffsetSelect & 0x0002) >> 1)
! 
! #define SCL_SET_N2COSL(/* 1 bit */ n2cosl) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetSelect \
!    = (SclColOffset.ColorOffsetSelect & 0xFFFB) | ((n2cosl) << 2))
! 
! #define SCL_GET_N2COSL() \
!   ((SclColOffset.ColorOffsetSelect & 0x0004) >> 2)
! 
! #define SCL_SET_N3COSL(/* 1 bit */ n3cosl) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetSelect \
!    = (SclColOffset.ColorOffsetSelect & 0xFFF7) | ((n3cosl) << 3))
! 
! #define SCL_GET_N3COSL() \
!   ((SclColOffset.ColorOffsetSelect & 0x0008) >> 3)
! 
! #define SCL_SET_R0COSL(/* 1 bit */ r0cosl) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetSelect \
!    = (SclColOffset.ColorOffsetSelect & 0xFFEF) | ((r0cosl) << 4))
! 
! #define SCL_GET_R0COSL() \
!   ((SclColOffset.ColorOffsetSelect & 0x0010) >> 4)
! 
! #define SCL_SET_BKCOSL(/* 1 bit */ bkcosl) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetSelect \
!    = (SclColOffset.ColorOffsetSelect & 0xFFDF) | ((bkcosl) << 5))
! 
! #define SCL_GET_BKCOSL() \
!   ((SclColOffset.ColorOffsetSelect & 0x0020) >> 5)
! 
! #define SCL_SET_SPCOSL(/* 1 bit */ spcosl) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetSelect \
!    = (SclColOffset.ColorOffsetSelect & 0xFFBF) | ((spcosl) << 6))
! 
! #define SCL_GET_SPCOSL() \
!   ((SclColOffset.ColorOffsetSelect & 0x0040) >> 6)
! 
! /* カラーオフセットレジスタ A */
! #define SCL_SET_COARD(/* 9 bit */ coard) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetA_RED \
!    = (coard))
! 
! #define SCL_GET_COARD() \
!   (SclColOffset.ColorOffsetA_RED & 0x01FF)
! 
! #define SCL_SET_COAGR(/* 9 bit */ coagr) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetA_GREEN \
!    = (coagr))
! 
! #define SCL_GET_COAGR() \
!   (SclColOffset.ColorOffsetA_GREEN & 0x01FF)
! 
! #define SCL_SET_COABL(/* 9 bit */ coabl) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetA_BLUE \
!    = (coabl))
! 
! #define SCL_GET_COABL() \
!   (SclColOffset.ColorOffsetA_BLUE & 0x01FF)
! 
! /* カラーオフセットレジスタ B*/
! #define SCL_SET_COBRD(/* 9 bit */ cobrd) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetB_RED \
!    = (cobrd))
! 
! #define SCL_GET_COBRD() \
!    (SclColOffset.ColorOffsetB_RED & 0x01FF)
! 
! #define SCL_SET_COBGR(/* 9 bit */ cobgr) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetB_GREEN \
!    = (cobgr))
! 
! #define SCL_GET_COBGR() \
!   (SclColOffset.ColorOffsetB_GREEN & 0x01FF)
! 
! #define SCL_SET_COBBL(/* 9 bit */ cobbl) \
!   (SclPriBuffDirty.SclColOffset = 1, \
!    SclColOffset.ColorOffsetB_BLUE \
!    = (cobbl))
! 
! #define SCL_GET_COBBL() \
!   (SclColOffset.ColorOffsetB_BLUE & 0x01FF)
! 
! /*----------- シャドウコントロール N0|R1, N1|EXBG, N2, N3, R0, BACK */
! 
! #define SCL_SET_N0SDEN(/* 1 bit */ n0sden) \
!    (SclPriBuffDirty.SclOtherPri = 1, \
!     SclOtherPri.ShadowControl \
!     = (SclOtherPri.ShadowControl & 0xFFFE) | ((n0sden)))
! 
! #define SCL_GET_N0SDEN() \
!   ((SclOtherPri.ShadowControl & 0x0001))
! 
! #define SCL_SET_N1SDEN(/* 1 bit */ n1sden) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ShadowControl \
!    = (SclOtherPri.ShadowControl & 0xFFFD) | ((n1sden) << 1))
! 
! #define SCL_GET_N1SDEN() \
!   ((SclOtherPri.ShadowControl & 0x0002) >> 1)
! 
! #define SCL_SET_N2SDEN(/* 1 bit */ n2sden) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ShadowControl \
!    = (SclOtherPri.ShadowControl & 0xFFFB) | ((n2sden) << 2))
! 
! #define SCL_GET_N2SDEN() \
!   ((SclOtherPri.ShadowControl & 0x0004) >> 2)
! 
! #define SCL_SET_N3SDEN(/* 1 bit */ n3sden) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ShadowControl \
!    = (SclOtherPri.ShadowControl & 0xFFF7) | ((n3sden) << 3))
! 
! #define SCL_GET_N3SDEN() \
!   ((SclOtherPri.ShadowControl & 0x0008) >> 3)
! 
! #define SCL_SET_R0SDEN(/* 1 bit */ r0sden) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ShadowControl \
!    = (SclOtherPri.ShadowControl & 0xFFEF) | ((r0sden) << 4))
! 
! #define SCL_GET_R0SDEN() \
!   ((SclOtherPri.ShadowControl & 0x0010) >> 4)
! 
! #define SCL_SET_BKSDEN(/* 1 bit */ bksden) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ShadowControl \
!    = (SclOtherPri.ShadowControl & 0xFFDF) | ((bksden) << 5))
! 
! #define SCL_GET_BKSDEN() \
!   ((SclOtherPri.ShadowControl & 0x0020) >> 5)
! 
! /*--------------------------------------- 透明シャドウセレクト */
! #define SCL_SET_TPSDSL(/* 1 bit */ tpsden) \
!   (SclPriBuffDirty.SclOtherPri = 1, \
!    SclOtherPri.ShadowControl \
!    = (SclOtherPri.ShadowControl & 0xFEFF) | ((tpsden) << 8))
! 
! #define SCL_GET_TPSDSL() \
!   ((SclOtherPri.ShadowControl & 0x0100) >> 8)
! 
! /*---------------------------カラー RAM モード */
! /* 0x1800E 番地にあるので スクロールライブラリで設定する */
! 
! /* 値の定義 */
! 
! #define SCL_RBG0	0x00000001
! #define SCL_RBG1	0x00000002
! #define SCL_NBG0	0x00000004
! #define SCL_NBG1	0x00000008
! #define SCL_NBG2	0x00000010
! #define SCL_NBG3	0x00000020
! 
! #define SCL_EXBG	0x00000080
! #define SCL_SPR 	0x00000100
! #define SCL_SP0 	0x00000100
! #define SCL_SP1 	0x00000200
! #define SCL_SP2 	0x00000400
! #define SCL_SP3 	0x00000800
! #define SCL_SP4 	0x00001000
! #define SCL_SP5 	0x00002000
! #define SCL_SP6 	0x00004000
! #define SCL_SP7 	0x00008000
! #define SCL_RP  	0x00010000
! #define SCL_RP_R	0xfffeffff
! #define SCL_CC  	0x00020000
! #define SCL_LNCL	0x00040000
! #define SCL_BACK	0x00080000
! 
! #define SCL_RBG_TB_A	SCL_RBG0
! #define SCL_RBG_TB_B	SCL_RBG1
! 
! #define SCL_CRM15_1024 0
! #define SCL_CRM15_2048 1
! #define SCL_CRM24_1024 2
! 
! /* スプライトのタイプ指定 */
! #define SCL_TYPE0	0
! #define SCL_TYPE1	1
! #define SCL_TYPE2	2
! #define SCL_TYPE3	3
! #define SCL_TYPE4	4
! #define SCL_TYPE5	5
! #define SCL_TYPE6	6
! #define SCL_TYPE7	7
! #define SCL_TYPE8	8
! #define SCL_TYPE9	9
! #define SCL_TYPEA	10
! #define SCL_TYPEB	11
! #define SCL_TYPEC	12
! #define SCL_TYPED	13
! #define SCL_TYPEE	14
! #define SCL_TYPEF	15
! 
! #define SCL_PALETTE	0
! #define SCL_MIX 	1
! 
! #define SCL_MSB_SHADOW	0
! #define SCL_SP_WINDOW	1
! 
! #define SCL_IF_BEHIND	0
! #define SCL_IF_EQUAL	1
! #define SCL_IF_FRONT	2
! #define SCL_MSB_ON	3
! 
! #define SCL_OFFSET_A	0
! #define SCL_OFFSET_B	1
! 
! #endif /* __PRI_MACRO */
! 
! extern SclOtherPriRegister  SclOtherPri;  /* いろいろ */
! 
! extern SclSpPriNumRegister  SclSpPriNum;  /* スプライトのプライオリティ番号 */
! 
! extern SclBgPriNumRegister  SclBgPriNum;  /* スクロールのプライオリティ番号 */
! 
! extern SclSpColMixRegister  SclSpColMix;  /* スプライトの色演算 */
! 
! extern SclBgColMixRegister  SclBgColMix;  /* スクロールの色演算 */
! 
! extern SclColOffsetRegister SclColOffset; /* カラーオフセット */
! 
! extern SclPriBuffDirtyFlags SclPriBuffDirty; /* レジスタバッファのダーティー・フラグ */
! 
! /*--- REAL Priority Registers (Pointer) ---*/
! 
! extern SclOtherPriRegister  *SclRealOtherPri;
! 
! extern SclSpPriNumRegister  *SclRealSpPriNum;
! 
! extern SclBgPriNumRegister  *SclRealBgPriNum;
! 
! extern SclSpColMixRegister  *SclRealSpColMix;
! 
! extern SclBgColMixRegister  *SclRealBgColMix;
! 
! extern SclColOffsetRegister *SclRealColOffset;
! 
! #endif /* __PRI_GLVAR */
! 
! /* ＶＤＰ２ライブラリのプロトタイプ宣言 */
! #ifndef	SEGA_SCL_PROTO
! #define SEGA_SCL_PROTO
! 
! extern	void	SCL_Vdp2Init(void);
! extern	void	SCL_SetDisplayMode(Uint8 interlace,Uint8 vertical,Uint8 horizontal);
! extern	void	SCL_InitVramConfigTb(SclVramConfig *tp);
! extern	void	SCL_InitConfigTb(SclConfig *scfg);
! extern	void	SCL_InitLineParamTb(SclLineparam *lp);
! extern	void	SCL_SetVramConfig(SclVramConfig *tp);
! extern	void	SCL_SetConfig(Uint16 sclnum, SclConfig *scfg);
! extern	void	SCL_SetCycleTable(Uint16 *tp);
! extern	void	SCL_Open(Uint32 sclnum);
! extern	void	SCL_Close(void);
! extern	void	SCL_SetLineParam(SclLineparam *lp);
! extern	void	SCL_MoveTo(Fixed32 x,Fixed32 y,Fixed32 z);
! extern	void	SCL_Move(Fixed32 x,Fixed32 y,Fixed32 z);
! extern	void	SCL_Scale(Fixed32 Sx, Fixed32 Sy);
! extern	void	SCL_SetColRamMode(Uint32 ComRamMode);
! extern	Uint32	SCL_InitRotateTable(Uint32 Address,Uint16 Mode,Uint32 rA,Uint32 rB);
! extern	void	SCL_RotateTo(Fixed32 xy,Fixed32 z,Fixed32 disp,Uint16 mode);
! extern	void	SCL_Rotate(Fixed32 xy,Fixed32 z,Fixed32 disp);
! extern	void	SCL_SetRotateViewPoint(Uint16 x,Uint16 y,Uint16 z);
! extern	void    SCL_SetRotateZoom(Fixed32 x,Fixed32 y);
! extern	void	SCL_SetRotateCenter(Uint16 x,Uint16 y,Uint16 z);
! extern	void	SCL_SetRotateCenterDisp(Uint16 x,Uint16 y);
! extern	void	SCL_SetCoefficientData(Uint32 sclnum,Uint16 *data,Uint16 x,Uint16 y);
! extern	void	SCL_SetLncl(Uint32 addr,Uint16 tbnum,Uint16 *palNumTb);
! extern	void	SCL_SetBack(Uint32 addr,Uint16 dataSize,Uint16 *dataTb);
! extern	void	SCL_SetMosaic(Uint32 surface,Uint8 x,Uint8 y);
! extern	void	SCL_SetSpriteMode(Uint8 Type, Uint8 ColMode, Uint8 WinMode);
! extern	Uint32	SCL_GetColRamMode(void);
! extern	void	SCL_SetColRam(Uint32 Object, Uint32 Index,Uint32 num,void *Color);
! extern	Uint32	SCL_AllocColRam(Uint32 Surface, Uint32 NumOfColors, Uint8 transparent);
! extern	void	SCL_FreeColRam(Uint32 Surface);
! extern	void	SCL_SetAutoColChg(Uint32 Surface,Uint32 Interval,Uint32 Index,
! 			Uint32 NumOfCol,Uint32 NumOfTbl,Uint32 *ChangeTbl);
! extern	Uint32	SCL_GetColRamOffset(Uint32 Object);
! extern	void	SCL_SetPriority(Uint32 Object, Uint8 Priority);
! extern	Uint8	SCL_GetPriority(Uint32 Object);
! extern	void	SCL_SetColMixMode(Uint32 ColMixPriority, Uint8 Mode);
! extern	void	SCL_SetColMixRate(Uint32 Surfaces, Uint8 Rate);
! extern	void	SCL_SetAutoColMix(Uint32 Surfaces,Uint32 Interval,Uint32 Time,
! 			Uint8 StartRate,Uint8 EndRate);
! extern	void	SCL_SetColOffset(Uint32 OffsetReg, Uint32 Surfaces,
! 			Sint16 red, Sint16 green, Sint16 blue);
! extern	void	SCL_IncColOffset(Uint32 OffsetReg,Sint16 red,Sint16 green,Sint16 blue);
! extern	void	SCL_SetAutoColOffset(Uint32 OffsetReg,Uint32 Interval,Uint32 Time,
! 				SclRgb *start,SclRgb *end);
! extern	void	SCL_EnableBlur(Uint32 Surface);
! extern	void	SCL_DisableBlur(void);
! extern	void	SCL_EnableLineCol(Uint32 Surface);
! extern	void	SCL_DisableLineCol(Uint32 Surface);
! extern	void	SCL_SetWindow(Uint8 win,Uint32 logic,Uint32 enable,Uint32 area,
! 			Uint16 sx,Uint16 sy,Uint16 ex,Uint16 ey);
! extern	void	SCL_SetLineWindow(Uint8 win,Uint32 logic,Uint32 enable,Uint32 area,
! 			Uint32 addr,Uint32 sy,Uint32 tbSize,SclLineWindowTb *tp);
! extern	void	SCL_SetSpriteWindow(Uint32 logic,Uint32 enable,Uint32 area);
! extern	void	SCL_SetFrameInterval(Uint16 count);
! extern	void	SCL_DisplayFrame(void);
! extern	void	SCL_VblankStart(void);
! extern	void	SCL_VblankEnd(void);
! extern	void	SCL_AbortAutoVe(void);
! 
! /* 画面サイズデフォルト */
! extern	Uint16	SclDisplayX;
! extern	Uint16	SclDisplayY;
! 
! /* レジスタバッファ */
! extern	SclSysreg	Scl_s_reg;
! extern	SclDataset	Scl_d_reg;
! extern	SclNorscl	Scl_n_reg;
! extern	SclRotscl	Scl_r_reg;
! extern	SclWinscl	Scl_w_reg;
! extern	Uint16		SclProcess;
! 
! #endif /* SEGA_SCL_PROTO */
diff -crB --binary sbl6/segalib/include/sega_spr.h sbl6_patch/segalib/include/sega_spr.h
*** sbl6/segalib/include/sega_spr.h	1996-02-08 05:23:50.000000000 -0500
--- sbl6_patch/segalib/include/sega_spr.h	2021-11-17 07:11:02.000000000 -0500
***************
*** 1,787 ****
! /*----------------------------------------------------------------------------
!  *  sega_spr.h -- SPR ライブラリ インクルードファイル
!  *  Copyright(c) 1994 SEGA
!  *  Written by H.E on 1994-07-25 Ver.1.00
!  *  Updated by H.E on 1994-07-25 Ver.1.00
!  *  Updated by H.O on 1995-11-14 Ver.1.00a SSHOFF対策
!  *
!  *  スプライト表示用インクルードファイルで使用スプライト表示ライブラリの種別に
!  *  より以下のように定義します。
!  *
!  *  （１）スプライト表示基本処理のみの場合
!  *
!  *        #include "sega_spr.h"
!  *
!  *  （２）スプライト表示拡張処理の場合
!  *
!  *        #define  _SPR2_
!  *        #include "sega_spr.h"
!  *
!  *  （３）スプライト３Ｄ表示処理の場合
!  *
!  *        #define  _SPR3_
!  *        #include "sega_spr.h"
!  *
!  *
!  *----------------------------------------------------------------------------
!  */
! 
! #ifndef SEGA_SPR_H
! #define SEGA_SPR_H
! 
! #include        "sega_xpt.h"
! #include        "sega_def.h"
! #include        "sega_mth.h"
! 
! /*------------------------------------------
!  * Select 3D & Sprite Execute Environment
!  *----------------------------------------*/
! #define  SPR_SYNC_VB_OUT
! #define  USE_SLAVE
! #define  USE_DSP
! #define  USE_INBETWEEN_OBJECT
! #define  USE_DEBUG_INFO
! 
! /*-----------------------------------
!  * Select 3D Execute Machine
!  *---------------------------------*/
! #define  _PC_         0
! #define  _INDIGO2_    1
! #define  _SH_         2
! 
! 
! /*
!  * Set Machine Environment
!  */
! #define NO_EXIST    0
! #define    EXIST    1
! 
! #if defined(_PC)
!    #define _MACHINE  _PC_
!    #define _DSP      NO_EXIST
!    #define _MATH        EXIST
! #endif
! 
! #if defined(_INDIGO2)
!    #define _MACHINE  _INDIGO2_
!    #define _DSP      NO_EXIST
!    #define _MATH        EXIST
! #endif
! 
! #if defined(_SH)
!    #define _MACHINE  _SH_
!    #define _DSP         EXIST
!    #define _MATH     NO_EXIST
! #endif
! 
! #ifdef _SPR3_
!    #define _SPR2_
! #endif
! 
! 
! /*
!  * EXTERNAL FUNCTION PROTOTYPE DECLARATIONS
!  */
! typedef void PARA_RTN(void *parm);
! void  SPR_InitSlaveSH(void);
! void  SPR_RunSlaveSH(PARA_RTN *routine, void *parm);
! void  SPR_WaitEndSlaveSH(void);
! 
! 
! /**************** SEGA_SP1.H *************************************************/
! /*
!  * GLOBAL DEFINES/MACROS DEFINES
!  */
! 
! #define  VRAM_SIZE           512*1024   /* 512 Kbyte                        */
! #define  FBUF_SIZE           256*1024   /* 256 Kbyte * 2 bank               */
! 
! #define  AUTO_FRAME_CHG           0     /* auto frame change mode           */
! #define  MANUAL_FRAME_CHG         1     /* manual frame change mode         */
! #define  NO_INTER_FRAME_CHG       2     /* no interval frame change mode    */
! #define  NO_INTER_VBE_FRAME_CHG   3     /* v-blank erase no interval frm chg*/
! 
! #define  SPR_FBCR_MANUAL     0x0003     /* frame buffer manual change       */
! #define  SPR_FBCR_AUTO       0x0000     /* frame buffer auto change         */
! #define  SPR_FBCR_ERASE      0x0002     /* frame buffer next erase on       */
! #define  SPR_FBCR_DIE        0x0008     /* double interlace on              */
! #define  SPR_FBCR_DIL        0x0004     /* double interlace plot line       */
! #define  SPR_FBCR_EOS        0x0010     /* even/odd data sampling select bit*/
! 
! #define  SPR_TV_NORMAL       0          /* Normal TV mode                   */
! #define  SPR_TV_HIRESO       1          /* High Resolution TV mode          */
! #define  SPR_TV_ROT16        2          /* Rotate 16 bit TV mode            */
! #define  SPR_TV_ROT8         3          /* Rotate 8 bit TV mode             */
! #define  SPR_TV_HDTV         4          /* HDTV TV mode                     */
! 
! #define  SPR_TV_320X224      0          /* Screen size 320 x 224            */
! #define  SPR_TV_320X240      1          /* Screen size 320 x 240            */
! #define  SPR_TV_352X224      2          /* Screen size 352 x 224            */
! #define  SPR_TV_352X240      3          /* Screen size 352 x 240            */
! #define  SPR_TV_640X224      4          /* Screen size 640 x 224            */
! #define  SPR_TV_640X240      5          /* Screen size 640 x 240            */
! #define  SPR_TV_704X224      6          /* Screen size 704 x 224            */
! #define  SPR_TV_704X240      7          /* Screen size 704 x 240            */
! 
! #define  SPR_W_TVMR          0x00000000 /* TV mode selection                */
! #define  SPR_W_FBCR          0x00000002 /* Frame buf change mode            */
! #define  SPR_W_PTMR          0x00000004 /* Draw start control               */
! #define  SPR_W_EWDR          0x00000006 /* Erase write data                 */
! #define  SPR_W_EWLR          0x00000008 /* Erase write area left top point  */
! #define  SPR_W_EWRR          0x0000000A /* Erase write area right bot point */
! #define  SPR_W_ENDR          0x0000000C /* Stop VDP1                        */
! #define  SPR_R_EDSR          0x00000010 /* Transfer complete status         */
! #define  SPR_R_LOPR          0x00000012 /* End command table address        */
! #define  SPR_R_COPR          0x00000014 /* Executing command table address  */
! #define  SPR_R_MODR          0x00000016 /* Write register Mode status       */
! 
! #define  SPR_R_EXTEN         0x00000002 /* VDP2 External Signal Enable Reg  */
! #define  SPR_R_TVSTAT        0x00000004 /* VDP2 TV Status Reg               */
! #define  SPR_R_VCNT          0x0000000A /* VDP2 V Counter Reg               */
! 
! #define  VRAM_ADDR           0x25C00000 /* Sprite IC VRAM area address      */
! #define  FBUF_ADDR           0x25C80000 /* Sprite frame buffer address      */
! #define  VDP1_REG_BASE       0x25D00000 /* Sprite IC Register base address  */
! #define  VDP2_REG_BASE       0x25F80000 /* Sprite IC Register base address  */
! 
! struct SprSpStatus {
!     Uint16  frameChgMode;             /* Frame Change Mode                 */
!     Uint16  frameEraseMode;           /* Frame Erase  Mode                 */
!     Uint16  vbInterval;               /* V-Blank Interval for Frame Change */
!     Uint16  eraseData;
!     Uint16  eraseLeftX;
!     Uint16  eraseTopY;
!     Uint16  eraseRightX;
!     Uint16  eraseBotY;
! };
! 
! typedef struct SprSpStatus SprSpStatus;
! 
! #define SPR_WRITE_REG(reg, val) \
!       *(volatile Uint16*)(VDP1_REG_BASE+(reg)) = (val)
! #define SPR_READ_REG(reg) \
!       (*(volatile Uint16*)(VDP1_REG_BASE+(reg)))
! #define SPR_SCLWRITE_REG(reg, val) \
!       *(volatile Uint16*)(VDP2_REG_BASE+(reg)) = (val)
! #define SPR_SCLREAD_REG(reg) \
!       (*(volatile Uint16*)(VDP2_REG_BASE+(reg)))
! 
! /*
!  * EXTERNAL VARIABLE DECLARATIONS
!  */
! #if	0
! /*
! **■1995-09-19	高橋智延
! **	幾つかのオブジェクトは、割り込み処理の中で触られるので、volatile にする。
! */
! extern Sint32  SpScreenX;               /* TV Screen X Size                  */
! extern Sint32  SpScreenY;               /* TV Screen Y Size                  */
! extern Uint16  SpFrameChgMode;          /* Frame Change Mode                 */
! extern Sint32  SpFrameEraseMode;        /* Frame Erase  Mode                 */
! extern Sint32  VBInterval;              /* V-Blank Interval for Frame Change */
! extern Sint32  VBIntervalCounter;       /* V-Blank Interval Counter          */
! extern Sint32  ReqDisplayFlag;          /* Display Request flag              */
! extern Uint16  SpTvMode;                /* TV Mode                           */
! extern Uint16  SpFbcrMode;              /* Frame Buffer Chane Mode           */
! extern Uint16  SpDie;                   /* Double Interlace Enable Flag      */
! extern Uint16  SpDil;                   /* Double Interlace Plot Line        */
! #else
! extern Sint32			SpScreenX;			/* TV Screen X Size                  */
! extern Sint32			SpScreenY;			/* TV Screen Y Size                  */
! extern volatile Uint16	SpFrameChgMode;		/* Frame Change Mode                 */
! extern volatile Sint32	SpFrameEraseMode;	/* Frame Erase  Mode                 */
! extern volatile Sint32	VBInterval;			/* V-Blank Interval for Frame Change */
! extern volatile Sint32	VBIntervalCounter;	/* V-Blank Interval Counter          */
! extern volatile Sint32	ReqDisplayFlag;		/* Display Request flag              */
! extern Uint16			SpTvMode;			/* TV Mode                           */
! extern Uint16			SpFbcrMode;			/* Frame Buffer Chane Mode           */
! extern Uint16			SpDie;				/* Double Interlace Enable Flag      */
! extern Uint16			SpDil;				/* Double Interlace Plot Line        */
! #endif
! 
! /*
!  * EXTERNAL FUNCTION PROTOTYPE DECLARATIONS
!  */
! void SPR_Initial (Uint8 **VRAM);
! void SPR_SetTvMode(Uint16 mode, Uint16 screenSize, Uint16 doubleInterlace);
! void SPR_GetStatus (SprSpStatus *spStatus);
! void SPR_SetEraseData (Uint16 eraseData, Uint16 leftX,  Uint16 topY,
!                                          Uint16 rightX, Uint16 botY);
! void SPR_WaitDrawEnd (void);
! void SPR_SetEosMode(Sint32 eosFlag);
! void sprMemCpyL(void *dst, void *src, int count);
! void sprMemCpyW(void *dst, void *src, int count);
! 
! 
! #ifdef _SPR2_
! /**************** SEGA_SP2.H *************************************************/
! /*
!  * GLOBAL DEFINES/MACROS DEFINES
!  */
! #define  FIXED32_MIN         0x80000000
! #define  FIXED32_MAX         0x7fffffff
! 
! #define  CTRL_END            0x8000     /* control word end bit mask        */
! #define  CTRL_SKIP           0x4000     /* control word skip bit mask       */
! #define  CTRL_JUMP           0x3000     /* control word jump bit mask       */
! #define  CTRL_ZOOM           0x0f00     /* control word zoom point bit mask */
! #define  CTRL_FUNC           0x000f     /* control word function bit mask   */
! #define  CTRL_DIR            0x0030     /* control word char read bit mask  */
! 
! #define  DRAW_COMPO          0x0003     /* draw mode word color compose mask*/
! #define  DRAW_GOURAU         0x0004     /* draw mode word gouraud shading   */
! #define  DRAW_GOURAU_GRAY    0x0804     /* draw mode word gray gour shading */
! #define  DRAW_COLOR          0x0038     /* draw mode word color mode mask   */
! #define  DRAW_MESH           0x0100     /* draw mode word mesh on           */
! 
! #define  COMPO_REP           0x0000     /* color compose reprace mode       */
! #define  COMPO_SHADOW        0x0001     /* color compose shadow mode        */
! #define  COMPO_HARF          0x0002     /* color compose harf luminance mode*/
! #define  COMPO_TRANS         0x0003     /* color compose trunslucent mode   */
! 
! #define  FUNC_NORMALSP       0x0000     /* draw normal sprite function      */
! #define  FUNC_SCALESP        0x0001     /* draw scaled sprite function      */
! #define  FUNC_DISTORSP       0x0002     /* draw distorted sprite function   */
! #define  FUNC_POLYGON        0x0004     /* draw polygon function            */
! #define  FUNC_POLYLINE       0x0005     /* draw polyline function           */
! #define  FUNC_LINE           0x0006     /* draw line function               */
! #define  FUNC_SCLIP          0x0009     /* set system clipping function     */
! #define  FUNC_UCLIP          0x0008     /* set user clipping function       */
! #define  FUNC_LCOORD         0x000a     /* set local coordinate function    */
! #define  FUNC_TEXTURE        0x0004     /* texture command group mask       */
! 
! #define  JUMP_NEXT           0x0000     /* jump next command                */
! #define  JUMP_ASSIGN         0x1000     /* jump assign command              */
! #define  JUMP_CALL           0x2000     /* call assign command              */
! #define  JUMP_RETURN         0x3000     /* return command subroutine        */
! #define  SKIP_NEXT           0x4000     /* skip next command                */
! #define  SKIP_ASSIGN         0x5000     /* skip assign command              */
! #define  SKIP_CALL           0x6000     /* skip call assign command         */
! #define  SKIP_RETURN         0x7000     /* skip return command subroutine   */
! 
! #define  ZOOM_NOPOINT        0x0000     /* zoom no point                    */
! #define  ZOOM_TL             0x0500     /* zoom point top left              */
! #define  ZOOM_TM             0x0600     /* zoom point top middle            */
! #define  ZOOM_TR             0x0700     /* zoom point top right             */
! #define  ZOOM_ML             0x0900     /* zoom point middle left           */
! #define  ZOOM_MM             0x0a00     /* zoom point center                */
! #define  ZOOM_MR             0x0b00     /* zoom point middle right          */
! #define  ZOOM_BL             0x0c00     /* zoom point bottom left           */
! #define  ZOOM_BM             0x0e00     /* zoom point bottom middle         */
! #define  ZOOM_BR             0x0f00     /* zoom point bottom right          */
! 
! #define  DIR_NOREV           0x0000     /* char read not reverse            */
! #define  DIR_TBREV           0x0020     /* char read top/bottom reverse     */
! #define  DIR_LRREV           0x0010     /* char read left/right reverse     */
! #define  DIR_LRTBREV         0x0030     /* char read left/right/top/bot rev */
! 
! #define  ECD_DISABLE         0x0080     /* ECD disabe & SPD enable          */
! #define  SPD_DISABLE         0x0040     /* ECD enable & SPD disable         */
! #define  ECDSPD_DISABLE      0x00c0     /* ECD & SPD disable                */
! #define  UCLPIN_ENABLE       0x0400     /* CLIP IN enable                   */
! #define  UCLPOUT_ENABLE      0x0600     /* CLIP OUT enable                  */
! #define  HSS_ENABLE          0x1000     /* HSS enable                       */
! #define  PCLP_ENABLE         0x0800     /* PCLP disable                     */
! 
! #define  COLOR_0             0x0000     /* 4 bit/pixel & 16 color bank mode */
! #define  COLOR_1             0x0008     /* 4 bit/pixel & 16 color lookup tbl*/
! #define  COLOR_2             0x0010     /* 8 bit/pixel &  64 color bank mode*/
! #define  COLOR_3             0x0018     /* 8 bit/pixel & 128 color bank mode*/
! #define  COLOR_4             0x0020     /* 8 bit/pixel & 256 color bank mode*/
! #define  COLOR_5             0x0028     /* 16 bit/pixel & RGB mode          */
! 
! #define  NO_GOUR             0xffff     /* no use Gouraud Shading Table No. */
! 
! #define  SPR_2DRAW_PRTY_ON   1          /* command draw priority on         */
! #define  SPR_2DRAW_PRTY_OFF  0          /* command draw priority off        */
! #define  SPR_2MOST_FAR       0          /* draw sprite most far position    */
! #define  SPR_2MOST_NEAR      0x7fffffff /* draw sprite most near position   */
! 
! 
! /*
!  * STRUCTURE DECLARATIONS
!  */
! struct SprSpCmd {                       /* Sprite Command Table             */
!     Uint16  control;                    /* control word                     */
!     Uint16  link;                       /* command link                     */
!     Uint16  drawMode;                   /* draw mode                        */
!     Uint16  color;                      /* color info.                      */
!     Uint16  charAddr;                   /* character address                */
!     Uint16  charSize;                   /* character size                   */
!     Sint16  ax;                         /* point A x                        */
!     Sint16  ay;                         /* point A y                        */
!     Sint16  bx;                         /* point B x                        */
!     Sint16  by;                         /* point B y                        */
!     Sint16  cx;                         /* point C x                        */
!     Sint16  cy;                         /* point C y                        */
!     Sint16  dx;                         /* point D x                        */
!     Sint16  dy;                         /* point D y                        */
!     Uint16  grshAddr;                   /* gouraud shading table address    */
!     Uint16  dummy;                      /* dummy area                       */
! };
! 
! struct SprSpCmdR {
!     Uint32  dummy[8];                   /* dummy area                       */
! };
! 
! 
! struct SprGourTbl {
!     Uint16  entry[4];
! };
! 
! struct SprGourTblR {
!     Uint32  entry[2];
! };
! 
! struct SprLookupTbl {
!     Uint16  entry[16];
! };
! 
! /*
!  * TYPEDEFS
!  */
! typedef Uint16 Vaddr;                       /* Relative Address in The VRAM  */
! typedef struct SprSpCmd     SprSpCmd;
! typedef struct SprSpCmdR    SprSpCmdR;
! typedef struct SprGourTbl   SprGourTbl;
! typedef struct SprGourTblR  SprGourTblR;
! typedef struct SprLookupTbl SprLookupTbl;
! typedef struct SprAreaSize  SprAreaSize;
! /* internal data type */
! typedef	struct SprCharTbl    SprCharTbl;
! typedef struct SprDrawPrtyBlk SprDrawPrtyBlk;
! typedef	struct Spr2WorkArea   Spr2WorkArea;
! 
! struct SprCharTbl {                         /* Character Entry Table         */
!     Vaddr     addr;                         /* Character Relative Address    */
!     Uint16    xySize;                       /* Charcter Size (X * Y)         */
!     Uint16    mode;                         /* Charcter Mode (0-5)           */
!     Uint16    color;                        /* Color Bank or LookUp Tbl No   */
!     Uint16    size;                         /* Charcter Size (by the 32 byte)*/
! };
! 
! struct SprDrawPrtyBlk {         /* 描画プライオリティブロックテーブル        */
!     Uint16      topNo;          /* 先頭コマンドチェインエントリ番号          */
!     Uint16      botNo;          /* 末尾コマンドチェインエントリ番号          */
! };
! 
! struct Spr2WorkArea {                    /* SP2 Work Area Define             */
!     Uint16         commandMax;           /* Command Max                      */
!     Uint16         gourTblMax;           /* Gour Tbl Max                     */
!     Uint16         lookupTblMax;         /* Lookup Tbl Max                   */
!     Uint16         charMax;              /* Char Max                         */
!     Uint16         drawPrtyBlkMax;       /* Draw Priority Block Max          */
!     SprCharTbl     *charTbl;             /* Character Tbl Pointer            */
!     SprSpCmd       *mstCmd;              /* Master Command Buffer            */
!     SprDrawPrtyBlk *mstDrawPrtyBlk;      /* Master Draw Priority Block       */
!     SprSpCmd       *slvCmd;              /* Slave Command Buffer             */
!     SprDrawPrtyBlk *slvDrawPrtyBlk;      /* Slave Draw Priority Block        */
!     SprGourTbl     *gourTbl;             /* Gour Tbl Max                     */
! };
! 
! struct SprAreaSize {                     /* SP2 Work Area Size               */
!     Uint16         commandMax;           /* Command Max                      */
!     Uint16         gourTblMax;           /* Gour Tbl Max                     */
!     Uint16         lookupTblMax;         /* Lookup Tbl Max                   */
!     Uint16         charMax;              /* Char Max                         */
!     Uint16         drawPrtyBlkMax;       /* Draw Priority Block Max          */
!     Uint16         useCommandCount;      /* Using Command Block Count        */
!     Uint16         charRemainBlkCount;   /* Char Total Remain Null Blk Count */
!     Uint16         charNullBlkMaxSize;   /* Char Null Block Max Size         */
! };
! 
! /*
!  * EXTERNAL VARIABLE DECLARATIONS
!  */
! extern Sint32  SpLCoordX;                   /* Local Origin X Position       */
! extern Sint32  SpLCoordY;                   /* Local Origin Y Position       */
! 
! #ifdef _SPR3_
! #define   SPR_2DefineWork(sp2WorkArea, sp2CommandMax, sp2GourTblMax, \
! 			  sp2LookupTblMax, sp2CharMax, sp2DrawPrtyBlkMax) \
! static SprCharTbl      sp2CharTbl         [sp2CharMax]; \
! static SprSpCmdR       sp2MstSpCmd        [sp2CommandMax/2]; \
! static SprDrawPrtyBlk  sp2MstDrawPrtyBlk  [sp2DrawPrtyBlkMax]; \
! static SprSpCmdR       sp2SlvSpCmd        [sp2CommandMax/2]; \
! static SprDrawPrtyBlk  sp2SlvDrawPrtyBlk  [sp2DrawPrtyBlkMax]; \
! static SprGourTblR     sp2GourTbl         [sp2GourTblMax+32]; \
! static Spr2WorkArea sp2WorkArea  = {  \
! 	sp2CommandMax, sp2GourTblMax+32, sp2LookupTblMax, sp2CharMax, \
! 	sp2DrawPrtyBlkMax, sp2CharTbl, \
! 	(SprSpCmd*)sp2MstSpCmd, sp2MstDrawPrtyBlk, (SprSpCmd*)sp2SlvSpCmd, \
!         sp2SlvDrawPrtyBlk, (SprGourTbl*)sp2GourTbl };
! #else
! #define   SPR_2DefineWork(sp2WorkArea, sp2CommandMax, sp2GourTblMax, \
! 			  sp2LookupTblMax, sp2CharMax, sp2DrawPrtyBlkMax) \
! static SprCharTbl      sp2CharTbl         [sp2CharMax]; \
! static SprSpCmdR       sp2MstSpCmd        [sp2CommandMax]; \
! static SprDrawPrtyBlk  sp2MstDrawPrtyBlk  [sp2DrawPrtyBlkMax]; \
! static SprGourTblR     sp2GourTbl         [sp2GourTblMax+1]; \
! static Spr2WorkArea sp2WorkArea  = {  \
! 	sp2CommandMax, sp2GourTblMax, sp2LookupTblMax, sp2CharMax, \
! 	sp2DrawPrtyBlkMax, sp2CharTbl, \
! 	(SprSpCmd*)sp2MstSpCmd, sp2MstDrawPrtyBlk, NULL, \
!         NULL, (SprGourTbl*)sp2GourTbl };
! #endif
! 
! /*
!  * PROTOTYPE DECLARATIONS
!  */
! void   SPR_2Initial (Spr2WorkArea  *workArea);
! /** SSHOFF対策。SPR_2Initial2追加 '95-11/14 **/
! void   SPR_2Initial2(Spr2WorkArea  *workArea);
! void   SPR_2SetTvMode(Uint16 mode, Uint16 screenSize, Uint16 doubleInterlace);
! void   SPR_2FrameChgIntr (Uint16);
! void   SPR_2FrameEraseData (Uint16);
! void   SPR_2SetGourTbl (Uint16, SprGourTbl *);
! void   SPR_2SetLookupTbl (Uint16, SprLookupTbl *);
! #if	0
! /*
! **■1995-09-11	高橋智延
! **	＜仕様変更＞
! **	領域の確保に失敗したら、あるいは、確保されている領域のサイズよりもセッ
! **	トしようとするデータのサイズが大きい場合には、エラーコードを返すように
! **	する。
! */
! void   SPR_2SetChar (Uint16, Uint16, Uint16, Uint16, Uint16, Uint8 *);
! #else
! int		SPR_2SetChar(Uint16, Uint16, Uint16, Uint16, Uint16, Uint8 *);
! #endif
! void   SPR_2ClrChar (Uint16);
! void   SPR_2ClrAllChar (void);
! Uint16 SPR_2GourTblNoToVram (Uint16);
! Uint16 SPR_2LookupTblNoToVram (Uint16);
! Uint16 SPR_2CharNoToVram (Uint16);
! void   SPR_2GetAreaSizeInfo(SprAreaSize  *areaSizeInfo);
! void   SPR_2OpenCommand (Uint16);
! void   SPR_2CloseCommand (void);
! void   SPR_2FlushDrawPrty (void);
! void   SPR_2LocalCoord (Sint32, XyInt *);
! void   SPR_2SysClip (Sint32, XyInt *);
! void   SPR_2UserClip (Sint32, XyInt *);
! void   SPR_2Line (Sint32, Uint16, Uint16, XyInt *, Uint16);
! void   SPR_2PolyLine (Sint32, Uint16, Uint16, XyInt *, Uint16);
! void   SPR_2Polygon (Sint32, Uint16, Uint16, XyInt *, Uint16);
! void   SPR_2NormSpr (Sint32, Uint16, Uint16, Uint16, Uint16, XyInt *, Uint16);
! void   SPR_2ScaleSpr (Sint32, Uint16, Uint16, Uint16, 
!                                       Uint16, XyInt *xy, Uint16);
! void   SPR_2DistSpr (Sint32, Uint16, Uint16, Uint16,
!                                      Uint16, XyInt *xy, Uint16);
! void   SPR_2Cmd (Sint32, SprSpCmd *);
! 
! #endif /* _SPR2_ */
! 
! #ifdef _SPR3_
! /**************** SEGA_SP3.H *************************************************/
! /*
!  * TYPEDEFS
!  */
! typedef	struct SprCluster   SprCluster;
! typedef	struct SprObject3D  SprObject3D;
! typedef	struct SprSurface   SprSurface;
! typedef	struct SprInbetInf  SprInbetInf;
! typedef	struct SprTexture   SprTexture;
! typedef struct Spr3dStatus  Spr3dStatus;
! /* internal data type */
! typedef	struct Spr3WorkArea Spr3WorkArea;
! 
! 
! /*
!  * STRUCTURE DECLARATIONS
!  */
! struct SprCluster {
!     Uint16	no;             /* クラスタ番号                              */
!     Uint16	angleSeq;       /* 回転順序                                  */
!     MthXyz	angle;	        /* 親クラスタの座標系における回転            */
!     MthXyz	point;	        /* 親クラスタの座標系における原点の座標      */
!     SprObject3D	*object;        /* ３Ｄオブジェクト                          */
!     SprCluster	*next;       	/* 次クラスタ                                */
!     SprCluster	*child;      	/* 子クラスタ                                */
!     SprInbetInf *inbetInf;     	/* ３Ｄオブジェクト間接続ポリゴン情報        */
!     void        (*transStart)(SprCluster*);
!                                 /* 座標変換開始前ユーザコールバックルーチン  */
!     void        (*transEnd)(SprCluster*, SprObject3D*, MthMatrix*, MthXyz*);
!                                 /* 座標変換終了後ユーザコールバックルーチン  */
!     void        *context;       /* ユーザコンテキストエリア                  */
! };
! 
! struct SprObject3D {
!     Uint16	no;             /* オブジェクト番号                          */
!     Uint16      dispFlag;       /* 表示フラグ                                */
!     Uint16      vertCount;      /* 頂点数                                    */
!     Uint16      surfaceCount;   /* 面数                                      */
!     MthXyz      *vertPoint;     /* 頂点座標テーブル                          */
!     MthXyz      *vertNormal;    /* 頂点の法線ベクトルテーブル                */
!     SprSurface  *surface;       /* 面定義テーブル                            */
!     MthXyz      *surfaceNormal; /* 面の法線ベクトルテーブル                  */
!     void        *filler;        /* 未使用                                    */
!     Uint16      **shdIdxTbl;    /* シェーディングインデックステーブル        */
!     Fixed32     surfNormK;      /* 面法線ベクトルの計算補正値                */
!     SprObject3D *next;          /* 次３Ｄオブジェクト                        */
! };
! 
! struct SprSurface {
!     Uint16     vertNo[4];       /* 面を構成する頂点番号                      */
!     Uint16     drawMode;        /* 描画モード                                */
!     Uint16     color;           /* カラーデータ                              */
! };
! 
! struct SprInbetInf {
!     Sint32       vertCount;     /* 取り出し頂点数                            */
!     SprObject3D  *fromObj;      /* 接続頂点データ取り出しオブジェクト        */
!     Uint16       *fromVertNo;   /* 取り出し頂点番号配列                      */
!     SprObject3D  *toObj;        /* 接続頂点データ設定オブジェクト            */
!     Uint16       *toVertNo;     /* 設定頂点番号配列                          */
!     SprInbetInf  *next;         /* 次３Ｄオブジェクト間接続ポリゴン情報      */
! };
! 
! struct SprTexture {
!     Uint16       charNo;        /* キャラクタ番号                            */
!     Uint16       colorMode;     /* カラーモード                              */
!     Uint16       color;         /* カラーデータ（ｶﾗｰﾊﾞﾝｸorﾙｯｸｱｯﾌﾟﾃｰﾌﾞﾙNo）   */
!     Uint16       width;         /* キャラクタの幅                            */
!     Uint16       height;        /* キャラクタの高さ                          */
!     Uint8        *charData;     /* キャラクタデータのポインタ                */
!     SprLookupTbl *lookupTbl;    /* ルックアップテーブルのポインタ            */
! };
! 
! struct Spr3WorkArea {
!     Uint16      objSurfMax;        /* オブジェクト内最大面数                 */
!     Uint16      objVertMax;        /* オブジェクト内最大頂点数               */
!     Sint32      *surfBright;       /* 面輝度テーブル                         */
!     Sint32      *vertBright;       /* 頂点輝度テーブル                       */
!     MthXyz      *coordView3D;      /* ３Ｄ視点座標変換後テーブル             */
!     XyInt       *coord2D;          /* ２Ｄ透視変換後テーブル                 */
!     MthXyz      *coordWorld3D;     /* ３Ｄワールド座標変換後テーブル         */
! };
! 
! struct Spr3dStatus {
!     MthXyz    lightAngle;       /* 光源アングル                           */
!     MthXyz    viewCoordPoint;   /* 視点座標系内の視点位置                 */
!     MthXyz    viewPoint;        /* 視点座標                               */
!     MthXyz    viewAngle;        /* 視点アングル                           */
!     Sint32    viewAngleSeq;     /* 視点アングル回転操作                   */
!     Sint32    zSortMode;        /* ＺソートＺ座標値の採用モード           */
!     Fixed32   zSortZMin;        /* フラッシュ単位現Ｚ座標最小値           */
!     Fixed32   zSortZMax;        /* フラッシュ単位現Ｚ座標最大値           */
!     Fixed32   clipZMin;         /* 視点座標系クリップＺ最小値座標         */
!     Fixed32   clipZMax;         /* 視点座標系クリップＺ最大値座標         */
!     Sint32    clipLevel;        /* クリッピングレベル                     */
!     Sint32    unitPixelX;       /* X 1.0 に対するスクリーンのピクセル数   */
!     Sint32    unitPixelY;       /* Y 1.0 に対するスクリーンのピクセル数   */
! };
! 
! typedef struct TComTbl  TComTbl;
! struct TComTbl {
!     Fixed32     zSortBZMin;     /* i   フラッシュ単位前Ｚ座標最小値          */
!     int         zSftCnt;        /* i   ＺソートＺシフト数                    */
!     int         zSortBlkCnt;    /* i   Ｚソートブロック数                    */
!     Sint32      spriteDrawFlag; /* i   変形スプライト描画フラグ              */
!     Sint32      otherDrawFlag;  /* i   その他ポリゴン描画フラグ              */
!     Sint32      *unitPixel;     /* i   X,Y 1.0に対するスクリーンのピクセル数 */
!     Fixed32     *clipRatio;     /* i   ３Ｄクリッピング率 [0]=X, [1]=Y       */
!     Fixed32     *clipZ;         /* i   視点座標系クリップＺ [0]=min, [1]=max */
!     SprCharTbl  *charTbl;       /* i   スプライトキャラクタテーブル          */
!     Sint32      *vertBright;    /* i   頂点輝度テーブル                      */
!     MthXyz      *coordView3D;   /* i   ３Ｄ視点座標変換後テーブル            */
!     XyInt       *coord2D;       /* i   ２Ｄ透視変換後テーブル                */
!     int         dispFlag;       /* i   表示フラグ                            */
!     Uint16      **shdIdxTbl;    /* i   シェーディングインデックステーブル    */
!     Uint32      gourGrayTopR;   /* i   グーログレイ先頭ＶＲＡＭアドレス      */
!     Uint32      lookupTblR;     /* i   ルックアップテーブルＶＲＡＭ内位置    */
!     MthXyz      *lightVector;   /* i   光源ベクタ                            */
!     MthMatrix   *viewMatrix;    /* i   視点座標系への座標変換マトリックス    */
!     MthMatrix   *worldMatrix;   /* i   ワールド座標系への座標変換マトリックス*/
! };
! 
! typedef struct T3Dto2D  T3Dto2D;
! struct T3Dto2D {
!     int         vertCount;      /* i   頂点数                                */
!     int         surfaceCount;   /* i   面数                                  */
!     SprSurface  *surfInfo;      /* i   面定義テーブル                        */
!     MthXyz      *vertPoint;     /* i   頂点座標テーブル                      */
!     MthXyz      *surfaceNormal; /* i   面の法線ベクトルテーブル              */
!     MthXyz      *vertNormal;    /* i   頂点の法線ベクトルテーブル            */
!     MthXyz      *coordView3D;   /* o   ３Ｄ視点座標変換後テーブル            */
!     XyInt       *coord2D;       /* o   ２Ｄ透視変換後テーブル                */
!     Sint32      *surfBright;    /* o   面輝度テーブル                        */
!     Sint32      *vertBright;    /* o   頂点輝度テーブル                      */
!     MthXyz      *coordWorld3D;  /* o   頂点のワールド座標テーブル            */
! };
! 
! typedef struct T2DtoCmd  T2DtoCmd;
! struct T2DtoCmd {
!     int         surfaceCount;   /* i   面数                                  */
!     SprSurface  *surface;       /* i   面定義テーブル                        */
!     Sint32      *surfBright;    /* i   面輝度テーブル                        */
!     Fixed32     zSortZMin;      /* i/o フラッシュ単位現Ｚ座標最小値          */
!     Fixed32     zSortZMax;      /* i/o フラッシュ単位現Ｚ座標最大値          */
!     SprDrawPrtyBlk *prtyTbl;    /* i/o 描画プライオリティブロックテーブル    */
!     SprSpCmd    *cmdBuf;        /* o   スプライトコマンドバッファ            */
!     int         outCmdPos;      /* o   書き込みコマンド数                    */
!     SprGourTbl  *gourTblCur;    /* i/o グーロテーブルカレントアドレス        */
!     Uint32      gourTblCurR;    /* i/o グーロカレントＶＲＡＭアドレス        */
! };
! 
! typedef struct GetSurfNormPara  GetSurfNormPara;
! struct GetSurfNormPara {
!     int         surfaceCount;   /* i   面数                                  */
!     SprSurface  *surface;       /* i   面定義テーブル                        */
!     MthXyz      *vertPoint;     /* i   頂点座標テーブル                      */
!     Fixed32     surfNormK;      /* i   面法線ベクトルの計算補正値            */
!     MthXyz      *surfaceNormal; /* o   面の法線ベクトルテーブル              */
! };
! 
! 
! 
! /*
!  * GLOBAL DEFINES/MACROS DEFINES
!  */
! #define   ROT_SEQ_ZYX       0x0000
! #define   ROT_SEQ_ZXY       0x0001
! #define   ROT_SEQ_YZX       0x0002
! #define   ROT_SEQ_YXZ       0x0003
! #define   ROT_SEQ_XYZ       0x0004
! #define   ROT_SEQ_XZY       0x0005
! 
! #define   DISP_POLYGON      0x0000
! #define   DISP_POLYLINE     0x8000
! #define   DISP_MASK         0xc000
! #define   BOTH_FACE         0x1000
! 
! #define   NO_SHADING        0x0000
! #define   FLAT_SHADING      0x0100
! #define   GOURAUD_SHADING   0x0200
! #define   SHADING_MASK      0x0300
! #define   INBETWEEN_OBJECT  0x0010
! 
! #define   MATE_COLOR        0x0000
! #define   MATE_TEXTURE      0x4000
! #define   MATE_SHADING_TBL  0x8000
! #define   MATE_AUTO_SHADING 0xc000
! #define   MATE_MASK         0xc000
! 
! #define   ZSORT_MIN         0x0000
! #define   ZSORT_MAX         0x1000
! #define   ZSORT_MID         0x2000
! #define   ZSORT_MASK        0x3000
! #define   ZSORT_FLOAT_MODE  0
! #define   ZSORT_FIXED_MODE  1
! 
! #define   DRAW_MODE_MASK    0x07ff
! 
! 
! #define   SPR_3mac1(sp3ObjSurfMax) \
! static Sint32    sp3SurfBright [sp3ObjSurfMax];
! 
! #ifdef SPR_3NEED_WORLD_VERT
! #define   SPR_3mac2(sp3ObjVertMax) \
! static MthXyz    sp3CoordView3D   [sp3ObjVertMax];   \
! static XyInt     sp3Coord2D       [sp3ObjVertMax];   \
! static Sint32    sp3VertBright    [sp3ObjVertMax];   \
! static MthXyz    sp3CoordWorld3D  [sp3ObjVertMax];
! #else
! #define   SPR_3mac2(sp3ObjVertMax) \
! static MthXyz    sp3CoordView3D   [sp3ObjVertMax];   \
! static XyInt     sp3Coord2D       [sp3ObjVertMax];   \
! static Sint32    sp3VertBright    [sp3ObjVertMax];
! #endif
! 
! 
! 
! #ifdef SPR_3NEED_WORLD_VERT
! #define   SPR_3mac3(sp3WorkArea, sp3ObjSurfMax, sp3ObjVertMax) \
! static Spr3WorkArea  sp3WorkArea = {                          \
!    sp3ObjSurfMax, sp3ObjVertMax, sp3SurfBright, \
!    sp3VertBright, sp3CoordView3D, sp3Coord2D, sp3CoordWorld3D };
! #else
! #define   SPR_3mac3(sp3WorkArea, sp3ObjSurfMax, sp3ObjVertMax) \
! static Spr3WorkArea  sp3WorkArea = {                          \
!    sp3ObjSurfMax, sp3ObjVertMax, sp3SurfBright, \
!    sp3VertBright, sp3CoordView3D, sp3Coord2D, NULL };
! #endif
! 
! #define   SPR_3DefineWork(sp3WorkArea, sp3ObjSurfMax, sp3ObjVertMax) \
!  SPR_3mac1(sp3ObjSurfMax) \
!  SPR_3mac2(sp3ObjVertMax) \
!  SPR_3mac3(sp3WorkArea, sp3ObjSurfMax, sp3ObjVertMax)
! 
! 
! #ifdef USE_DEBUG_INFO
! extern int  dbgComputePol;
! extern int  dbgDrawPol;
! #endif
! 
! /*
!  * PROTOTYPE DECLARATIONS
!  */
! void   SPR_3Initial       (Spr3WorkArea  *workArea);
! void   SPR_3SetLight      (Uint16 moveKind, MthXyz *lightAngle);
! void   SPR_3SetView       (Uint16 moveKind, MthXyz *viewPoint,
!                            MthXyz *viewAngle, Uint16 angleSeq,
!                            MthXyz *viewCoordPoint);
! void   SPR_3MoveCluster   (SprCluster *cluster, Uint16 moveKind,
! 					   MthXyz *angle, MthXyz *point);
! void   SPR_3DrawModel     (SprCluster *rootCluster);
! void   SPR_3Flush         (void);
! void   SPR_3SetTexture    (SprTexture *texture);
! void   SPR_3ChangeTexColor(Uint16 charNo, Uint16 color,
!                                           SprLookupTbl *lookupTbl);
! void   SPR_3ClrTexture    (SprTexture *texture);
! void   SPR_3SetZSortMinMax(Uint16 pZSortMode,
!                                        Fixed32 pZSortZMin, Fixed32 pZSortZMax);
! void   SPR_3SetClipLevel  (Uint16 pClipLevel,
! 				       Fixed32 pClipZMin, Fixed32 pClipZMax);
! void   SPR_3SetPixelCount (Uint16 pixelCountX, Uint16 pixelCountY);
! void   SPR_3GetStatus (Spr3dStatus *spr3dStatus);
! void   SPR_3CallAllCluster(SprCluster *cluster, void (*userFunc)(SprCluster*));
! void   SPR_3SetSurfNormVect(SprObject3D  *obj);
! void   SPR_3SetDrawSpeed(Sint32 hssFlag, Sint32 eosFlag, Sint32 pclpFlag);
! void   SPR_3AllCoordTransClipPers(MthMatrix *matrix,
!                        MthXyz *src, MthXyz *ans, XyInt *ans2D, int vertCnt,
!                        Sint32 *unitPixel, Fixed32 *clipRatio, Fixed32 *clipZ);
! void   SPR_3AllCoordTrans(MthMatrix *matrix, MthXyz *src, int vertCnt,
!                           MthXyz *ans);
! void   SPR_3AllSurfaceBright(MthMatrix *matrix, SprSurface *surfInfo,
!                           MthXyz *surfaceNormal, Sint32 *surfaceBright,
!                      MthXyz *lightVector, Sint32 surfCnt, MthXyz *coordView3D);
! void   SPR_3AllVertBright(MthMatrix *matrix, MthXyz *vertNormal,
!                       Sint32 *vertBright, MthXyz *lightVector, Sint32 vertCnt);
! 
! 
! /*
!  * ＤＳＰによるマトリックス合成
!  */
! #define MTX_OP_CLEAR	1            /*　出力マトリックスエリアのクリア      */
! #define MTX_OP_REV_Z	2            /*　Ｚの符号反転合成                    */
! #define MTX_OP_MOV_XYZ	3            /*　平行移動合成                        */
! #define MTX_OP_ROT_X	4            /*　Ｘ回転移動合成                      */
! #define MTX_OP_ROT_Y	5            /*　Ｙ回転移動合成                      */
! #define MTX_OP_ROT_Z	6            /*　Ｚ回転移動合成                      */
! #define MTX_OP_END	7            /*　処理終了                            */
! 
! typedef struct  SprDspMatrixOp {     /* マトリックス合成オペレーション       */
!          Fixed32     x;              /* Ｘ値                                 */
!          Fixed32     y;              /* Ｙ値                                 */
!          Fixed32     z;              /* Ｚ値                                 */
!          Sint32      opCode;         /* オペレーションコード                 */
! } SprDspMatrixOp;
! 
! typedef struct  SprDspMatrixParm {   /* ＤＳＰ用マトリックス合成パラメータ   */
!          MthMatrix   *inputMatrix;   /* 入力マトリックスのアドレス           */
!          MthMatrix   *outputMatrix;  /* 出力マトリックスのアドレス           */
!          SprDspMatrixOp  op[15];     /* マトリックス合成オペレーション       */
! } SprDspMatrixParm;
! 
! void    SPR_3MatrixCompoInit(void);
! void    SPR_3MatrixCompoExec(SprDspMatrixParm *dspMatrixParm);
! void    SPR_3MatrixCompoCheck(void);
! 
! 
! #endif /* _SPR3_ */
! 
! 
! #endif /* ifndef SEGA_SPR_H */
! #define SLAVE
! /*  end of file */
! 
\ No newline at end of file
--- 1,642 ----
! /*----------------------------------------------------------------------------
!  *  sega_spr.h -- SPR ライブラリ インクルードファイル
!  *  Copyright(c) 1994 SEGA
!  *  Written by H.E on 1994-07-25 Ver.1.00
!  *  Updated by H.E on 1994-07-25 Ver.1.00
!  *
!  *  スプライト表示用インクルードファイルで使用スプライト表示ライブラリの種別に
!  *  より以下のように定義します。
!  *
!  *  （１）スプライト表示基本処理のみの場合
!  *
!  *        #include "sega_spr.h"
!  *
!  *  （２）スプライト表示拡張処理の場合
!  *
!  *        #define  _SPR2_
!  *        #include "sega_spr.h"
!  *
!  *  （３）スプライト３Ｄ表示処理の場合
!  *
!  *        #define  _SPR3_
!  *        #include "sega_spr.h"
!  *
!  *
!  *----------------------------------------------------------------------------
!  */
! 
! #ifndef SEGA_SPR_H
! #define SEGA_SPR_H
! 
! #include        "sega_xpt.h"
! #include        "sega_def.h"
! #include        "sega_mth.h"
! 
! /*-----------------------------------
!  * Select 3D Execute Machine
!  *---------------------------------*/
! #define  _PC_         0
! #define  _INDIGO2_    1
! #define  _SH_         2
! 
! 
! /*
!  * Set Machine Environment
!  */
! #define NO_EXIST    0
! #define    EXIST    1
! 
! #if defined(_PC)
!    #define _MACHINE  _PC_
!    #define _DSP      NO_EXIST
!    #define _MATH        EXIST
! #endif
! 
! #if defined(_INDIGO2)
!    #define _MACHINE  _INDIGO2_
!    #define _DSP      NO_EXIST
!    #define _MATH        EXIST
! #endif
! 
! #if defined(_SH)
!    #define _MACHINE  _SH_
!    #define _DSP         EXIST
!    #define _MATH     NO_EXIST
! #endif
! 
! #ifdef _SPR3_
!    #define _SPR2_
! #endif
! 
! 
! /**************** SEGA_SP1.H *************************************************/
! /*
!  * GLOBAL DEFINES/MACROS DEFINES
!  */
! 
! #define  VRAM_SIZE           512*1024   /* 512 Kbyte                        */
! #define  FBUF_SIZE           256*1024   /* 256 Kbyte * 2 bank               */
! 
! #define  AUTO_FRAME_CHG           0     /* auto frame change mode           */
! #define  MANUAL_FRAME_CHG         1     /* manual frame change mode         */
! #define  NO_INTER_FRAME_CHG       2     /* no interval frame change mode    */
! #define  NO_INTER_VBE_FRAME_CHG   3     /* v-blank erase no interval frm chg*/
! 
! #define  SPR_FBCR_MANUAL     0x0003     /* frame buffer manual change       */
! #define  SPR_FBCR_AUTO       0x0000     /* frame buffer auto change         */
! #define  SPR_FBCR_ERASE      0x0002     /* frame buffer next erase on       */
! #define  SPR_FBCR_DIE        0x0008     /* double interlace on              */
! #define  SPR_FBCR_DIL        0x0004     /* double interlace plot line       */
! #define  SPR_FBCR_EOS        0x0010     /* even/odd data sampling select bit*/
! 
! #define  SPR_TV_NORMAL       0          /* Normal TV mode                   */
! #define  SPR_TV_HIRESO       1          /* High Resolution TV mode          */
! #define  SPR_TV_ROT16        2          /* Rotate 16 bit TV mode            */
! #define  SPR_TV_ROT8         3          /* Rotate 8 bit TV mode             */
! #define  SPR_TV_HDTV         4          /* HDTV TV mode                     */
! 
! #define  SPR_TV_320X224      0          /* Screen size 320 x 224            */
! #define  SPR_TV_320X240      1          /* Screen size 320 x 240            */
! #define  SPR_TV_352X224      2          /* Screen size 352 x 224            */
! #define  SPR_TV_352X240      3          /* Screen size 352 x 240            */
! #define  SPR_TV_640X224      4          /* Screen size 640 x 224            */
! #define  SPR_TV_640X240      5          /* Screen size 640 x 240            */
! #define  SPR_TV_704X224      6          /* Screen size 704 x 224            */
! #define  SPR_TV_704X240      7          /* Screen size 704 x 240            */
! 
! #define  SPR_W_TVMR          0x00000000 /* TV mode selection                */
! #define  SPR_W_FBCR          0x00000002 /* Frame buf change mode            */
! #define  SPR_W_PTMR          0x00000004 /* Draw start control               */
! #define  SPR_W_EWDR          0x00000006 /* Erase write data                 */
! #define  SPR_W_EWLR          0x00000008 /* Erase write area left top point  */
! #define  SPR_W_EWRR          0x0000000A /* Erase write area right bot point */
! #define  SPR_W_ENDR          0x0000000C /* Stop VDP1                        */
! #define  SPR_R_EDSR          0x00000010 /* Transfer complete status         */
! #define  SPR_R_LOPR          0x00000012 /* End command table address        */
! #define  SPR_R_COPR          0x00000014 /* Executing command table address  */
! #define  SPR_R_MODR          0x00000016 /* Write register Mode status       */
! 
! #define  SPR_R_EXTEN         0x00000002 /* VDP2 External Signal Enable Reg  */
! #define  SPR_R_TVSTAT        0x00000004 /* VDP2 TV Status Reg               */
! #define  SPR_R_VCNT          0x0000000A /* VDP2 V Counter Reg               */
! 
! #define  VRAM_ADDR           0x25C00000 /* Sprite IC VRAM area address      */
! #define  FBUF_ADDR           0x25C80000 /* Sprite frame buffer address      */
! #define  VDP1_REG_BASE       0x25D00000 /* Sprite IC Register base address  */
! #define  VDP2_REG_BASE       0x25F80000 /* Sprite IC Register base address  */
! 
! struct SprSpStatus {
!     Uint16  frameChgMode;             /* Frame Change Mode                 */
!     Uint16  frameEraseMode;           /* Frame Erase  Mode                 */
!     Uint16  vbInterval;               /* V-Blank Interval for Frame Change */
!     Uint16  eraseData;
!     Uint16  eraseLeftX;
!     Uint16  eraseTopY;
!     Uint16  eraseRightX;
!     Uint16  eraseBotY;
! };
! 
! typedef struct SprSpStatus SprSpStatus;
! 
! #define SPR_WRITE_REG(reg, val) \
!       *(Uint16*)(VDP1_REG_BASE+(reg)) = (val)
! #define SPR_READ_REG(reg) \
!       (*(volatile Uint16*)(VDP1_REG_BASE+(reg)))
! #define SPR_SCLWRITE_REG(reg, val) \
!       *(Uint16*)(VDP2_REG_BASE+(reg)) = (val)
! #define SPR_SCLREAD_REG(reg) \
!       (*(volatile Uint16*)(VDP2_REG_BASE+(reg)))
! 
! /*
!  * EXTERNAL VARIABLE DECLARATIONS
!  */
! extern Sint32  SpScreenX;               /* TV Screen X Size                  */
! extern Sint32  SpScreenY;               /* TV Screen Y Size                  */
! extern volatile Uint16  SpFrameChgMode;          /* Frame Change Mode                 */
! extern volatile Sint32  SpFrameEraseMode;        /* Frame Erase  Mode                 */
! extern volatile Sint32  VBInterval;              /* V-Blank Interval for Frame Change */
! extern volatile Sint32  VBIntervalCounter;       /* V-Blank Interval Counter          */
! extern volatile Sint32  ReqDisplayFlag;          /* Display Request flag              */
! extern Uint16  SpTvMode;                /* TV Mode                           */
! extern Uint16  SpFbcrMode;              /* Frame Buffer Chane Mode           */
! extern Uint16  SpDie;                   /* Double Interlace Enable Flag      */
! extern Uint16  SpDil;                   /* Double Interlace Plot Line        */
! 
! /*
!  * EXTERNAL FUNCTION PROTOTYPE DECLARATIONS
!  */
! void SPR_Initial (Uint8 **VRAM);
! void SPR_SetTvMode(Uint16 mode, Uint16 screenSize, Uint16 doubleInterlace);
! void SPR_GetStatus (SprSpStatus *spStatus);
! void SPR_SetEraseData (Uint16 eraseData, Uint16 leftX,  Uint16 topY,
!                                          Uint16 rightX, Uint16 botY);
! void SPR_WaitDrawEnd (void);
! void SPR_SetEosMode(Sint32 eosFlag);
! 
! 
! #ifdef _SPR2_
! /**************** SEGA_SP2.H *************************************************/
! /*
!  * GLOBAL DEFINES/MACROS DEFINES
!  */
! #define  CTRL_END            0x8000     /* control word end bit mask        */
! #define  CTRL_SKIP           0x4000     /* control word skip bit mask       */
! #define  CTRL_JUMP           0x3000     /* control word jump bit mask       */
! #define  CTRL_ZOOM           0x0f00     /* control word zoom point bit mask */
! #define  CTRL_FUNC           0x000f     /* control word function bit mask   */
! #define  CTRL_DIR            0x0030     /* control word char read bit mask  */
! 
! #define  DRAW_COMPO          0x0003     /* draw mode word color compose mask*/
! #define  DRAW_GOURAU         0x0004     /* draw mode word gouraud shading   */
! #define  DRAW_GOURAU_GRAY    0x0804     /* draw mode word gray gour shading */
! #define  DRAW_COLOR          0x0038     /* draw mode word color mode mask   */
! #define  DRAW_MESH           0x0100     /* draw mode word mesh on           */
! 
! #define  COMPO_REP           0x0000     /* color compose reprace mode       */
! #define  COMPO_SHADOW        0x0001     /* color compose shadow mode        */
! #define  COMPO_HARF          0x0002     /* color compose harf luminance mode*/
! #define  COMPO_TRANS         0x0003     /* color compose trunslucent mode   */
! 
! #define  FUNC_NORMALSP       0x0000     /* draw normal sprite function      */
! #define  FUNC_SCALESP        0x0001     /* draw scaled sprite function      */
! #define  FUNC_DISTORSP       0x0002     /* draw distorted sprite function   */
! #define  FUNC_POLYGON        0x0004     /* draw polygon function            */
! #define  FUNC_POLYLINE       0x0005     /* draw polyline function           */
! #define  FUNC_LINE           0x0006     /* draw line function               */
! #define  FUNC_SCLIP          0x0009     /* set system clipping function     */
! #define  FUNC_UCLIP          0x0008     /* set user clipping function       */
! #define  FUNC_LCOORD         0x000a     /* set local coordinate function    */
! #define  FUNC_TEXTURE        0x0004     /* texture command group mask       */
! 
! #define  JUMP_NEXT           0x0000     /* jump next command                */
! #define  JUMP_ASSIGN         0x1000     /* jump assign command              */
! #define  JUMP_CALL           0x2000     /* call assign command              */
! #define  JUMP_RETURN         0x3000     /* return command subroutine        */
! 
! #define  ZOOM_NOPOINT        0x0000     /* zoom no point                    */
! #define  ZOOM_TL             0x0500     /* zoom point top left              */
! #define  ZOOM_TM             0x0600     /* zoom point top middle            */
! #define  ZOOM_TR             0x0700     /* zoom point top right             */
! #define  ZOOM_ML             0x0900     /* zoom point middle left           */
! #define  ZOOM_MM             0x0a00     /* zoom point center                */
! #define  ZOOM_MR             0x0b00     /* zoom point middle right          */
! #define  ZOOM_BL             0x0c00     /* zoom point bottom left           */
! #define  ZOOM_BM             0x0e00     /* zoom point bottom middle         */
! #define  ZOOM_BR             0x0f00     /* zoom point bottom right          */
! 
! #define  DIR_NOREV           0x0000     /* char read not reverse            */
! #define  DIR_TBREV           0x0020     /* char read top/bottom reverse     */
! #define  DIR_LRREV           0x0010     /* char read left/right reverse     */
! #define  DIR_LRTBREV         0x0030     /* char read left/right/top/bot rev */
! 
! #define  ECD_DISABLE         0x0080     /* ECD disabe & SPD enable          */
! #define  SPD_DISABLE         0x0040     /* ECD enable & SPD disable         */
! #define  ECDSPD_DISABLE      0x00c0     /* ECD & SPD disable                */
! #define  UCLPIN_ENABLE       0x0400     /* CLIP IN enable                   */
! #define  UCLPOUT_ENABLE      0x0600     /* CLIP OUT enable                  */
! #define  HSS_ENABLE          0x1000     /* HSS enable                       */
! #define  PCLP_ENABLE         0x0800     /* PCLP disable                     */
! 
! #define  COLOR_0             0x0000     /* 4 bit/pixel & 16 color bank mode */
! #define  COLOR_1             0x0008     /* 4 bit/pixel & 16 color lookup tbl*/
! #define  COLOR_2             0x0010     /* 8 bit/pixel &  64 color bank mode*/
! #define  COLOR_3             0x0018     /* 8 bit/pixel & 128 color bank mode*/
! #define  COLOR_4             0x0020     /* 8 bit/pixel & 256 color bank mode*/
! #define  COLOR_5             0x0028     /* 16 bit/pixel & RGB mode          */
! 
! #define  NO_GOUR             0xffff     /* no use Gouraud Shading Table No. */
! 
! #define  SPR_2DRAW_PRTY_ON   1          /* command draw priority on         */
! #define  SPR_2DRAW_PRTY_OFF  0          /* command draw priority off        */
! #define  SPR_2MOST_FAR       0          /* draw sprite most far position    */
! #define  SPR_2MOST_NEAR      0x7fffffff /* draw sprite most near position   */
! 
! 
! /*
!  * STRUCTURE DECLARATIONS
!  */
! struct SprSpCmd {                       /* Sprite Command Table             */
!     Uint16  control;                    /* control word                     */
!     Uint16  link;                       /* command link                     */
!     Uint16  drawMode;                   /* draw mode                        */
!     Uint16  color;                      /* color info.                      */
!     Uint16  charAddr;                   /* character address                */
!     Uint16  charSize;                   /* character size                   */
!     Sint16  ax;                         /* point A x                        */
!     Sint16  ay;                         /* point A y                        */
!     Sint16  bx;                         /* point B x                        */
!     Sint16  by;                         /* point B y                        */
!     Sint16  cx;                         /* point C x                        */
!     Sint16  cy;                         /* point C y                        */
!     Sint16  dx;                         /* point D x                        */
!     Sint16  dy;                         /* point D y                        */
!     Uint16  grshAddr;                   /* gouraud shading table address    */
!     Uint16  dummy;                      /* dummy area                       */
! };
! 
! struct SprGourTbl {
!     Uint16  entry[4];
! };
! 
! struct SprLookupTbl {
!     Uint16  entry[16];
! };
! 
! /*
!  * TYPEDEFS
!  */
! typedef Uint16 Vaddr;                       /* Relative Address in The VRAM  */
! typedef struct SprSpCmd     SprSpCmd;
! typedef struct SprGourTbl   SprGourTbl;
! typedef struct SprLookupTbl SprLookupTbl;
! /* internal data type */
! typedef	struct SprCharTbl     SprCharTbl;
! typedef	struct SprCmdChain    SprCmdChain;
! typedef struct SprDrawPrtyBlk SprDrawPrtyBlk;
! typedef	struct Spr2WorkArea   Spr2WorkArea;
! typedef	struct SprAreaSize    SprAreaSize;
! 
! struct SprCharTbl {                         /* Character Entry Table         */
!     Vaddr     addr;                         /* Character Relative Address    */
!     Uint16    xySize;                       /* Charcter Size (X * Y)         */
!     Uint16    mode;                         /* Charcter Mode (0-5)           */
!     Uint16    color;                        /* Color Bank or LookUp Tbl No   */
!     Uint16    size;                         /* Charcter Size (by the 32 byte)*/
! };
! 
! struct SprCmdChain {            /* コマンドチェイン管理テーブル              */
!     Uint16      nextNo;         /* 次のコマンドチェインエントリ番号          */
!     Uint16      cmdNo;          /* 対応するコマンド番号                      */
! };
! 
! struct SprDrawPrtyBlk {         /* 描画プライオリティブロックテーブル        */
!     Uint16      topNo;          /* 先頭コマンドチェインエントリ番号          */
!     Uint16      botNo;          /* 末尾コマンドチェインエントリ番号          */
! };
! 
! struct Spr2WorkArea {                    /* SP2 Work Area Define             */
!     Uint16         commandMax;           /* Command Max                      */
!     Uint16         gourTblMax;           /* Gour Tbl Max                     */
!     Uint16         lookupTblMax;         /* Lookup Tbl Max                   */
!     Uint16         charMax;              /* Char Max                         */
!     Uint16         drawPrtyBlkMax;       /* Draw Priority Block Max          */
!     SprCharTbl     *charTbl;             /* Character Tbl Pointer            */
!     SprCmdChain    *cmdChain;            /* Command Draw Priority Chain Tbl  */
!     SprDrawPrtyBlk *drawPrtyBlk;         /* Draw Priority Block Start        */
! };
! 
! struct SprAreaSize {                     /* SP2 Work Area Size               */
!     Uint16         commandMax;           /* Command Max                      */
!     Uint16         gourTblMax;           /* Gour Tbl Max                     */
!     Uint16         lookupTblMax;         /* Lookup Tbl Max                   */
!     Uint16         charMax;              /* Char Max                         */
!     Uint16         drawPrtyBlkMax;       /* Draw Priority Block Max          */
!     Uint16         useCommandCount;      /* Using Command Block Count        */
!     Uint16         charRemainBlkCount;   /* Char Total Remain Null Blk Count */
!     Uint16         charNullBlkMaxSize;   /* Char Null Block Max Size         */
! };
! 
! /*
!  * EXTERNAL VARIABLE DECLARATIONS
!  */
! extern Sint32  SpLCoordX;                   /* Local Origin X Position       */
! extern Sint32  SpLCoordY;                   /* Local Origin Y Position       */
! 
! 
! #define   SPR_2DefineWork(sp2WorkArea, sp2CommandMax, sp2GourTblMax, \
! 		          sp2LookupTblMax, sp2CharMax, sp2DrawPrtyBlkMax) \
! static SprCharTbl      sp2CharTbl      [sp2CharMax]; \
! static SprCmdChain     sp2CmdChain     [sp2CommandMax]; \
! static SprDrawPrtyBlk  sp2DrawPrtyBlk  [sp2DrawPrtyBlkMax]; \
! static Spr2WorkArea sp2WorkArea  = {  \
!         sp2CommandMax, sp2GourTblMax, sp2LookupTblMax, sp2CharMax, \
!         sp2DrawPrtyBlkMax, sp2CharTbl, sp2CmdChain, sp2DrawPrtyBlk };
! 
! 
! /*
!  * PROTOTYPE DECLARATIONS
!  */
! void   SPR_2Initial (Spr2WorkArea  *workArea);
! void   SPR_2SetTvMode(Uint16 mode, Uint16 screenSize, Uint16 doubleInterlace);
! void   SPR_2FrameChgIntr (Uint16);
! void   SPR_2FrameEraseData (Uint16);
! void   SPR_2SetGourTbl (Uint16, SprGourTbl *);
! void   SPR_2SetLookupTbl (Uint16, SprLookupTbl *);
! void   SPR_2SetChar (Uint16, Uint16, Uint16, Uint16, Uint16, Uint8 *);
! void   SPR_2ClrChar (Uint16);
! void   SPR_2ClrAllChar (void);
! Uint16 SPR_2GourTblNoToVram (Uint16);
! Uint16 SPR_2LookupTblNoToVram (Uint16);
! Uint16 SPR_2CharNoToVram (Uint16);
! void   SPR_2GetAreaSizeInfo(SprAreaSize  *areaSizeInfo);
! void   SPR_2OpenCommand (Uint16);
! void   SPR_2CloseCommand (void);
! void   SPR_2FlushDrawPrty (void);
! void   SPR_2LocalCoord (Sint32, XyInt *);
! void   SPR_2SysClip (Sint32, XyInt *);
! void   SPR_2UserClip (Sint32, XyInt *);
! void   SPR_2Line (Sint32, Uint16, Uint16, XyInt *, Uint16);
! void   SPR_2PolyLine (Sint32, Uint16, Uint16, XyInt *, Uint16);
! void   SPR_2Polygon (Sint32, Uint16, Uint16, XyInt *, Uint16);
! void   SPR_2NormSpr (Sint32, Uint16, Uint16, Uint16, Uint16, XyInt *, Uint16);
! void   SPR_2ScaleSpr (Sint32, Uint16, Uint16, Uint16, 
!                                       Uint16, XyInt *xy, Uint16);
! void   SPR_2DistSpr (Sint32, Uint16, Uint16, Uint16,
!                                      Uint16, XyInt *xy, Uint16);
! void   SPR_2Cmd (Sint32, SprSpCmd *);
! 
! #endif /* _SPR2_ */
! 
! #ifdef _SPR3_
! /**************** SEGA_SP3.H *************************************************/
! /*
!  * TYPEDEFS
!  */
! typedef	struct SprCluster   SprCluster;
! typedef	struct SprObject3D  SprObject3D;
! typedef	struct SprSurface   SprSurface;
! typedef	struct SprInbetInf  SprInbetInf;
! typedef	struct SprTexture   SprTexture;
! typedef struct Spr3dStatus  Spr3dStatus;
! /* internal data type */
! typedef	struct Spr3WorkArea Spr3WorkArea;
! 
! 
! /*
!  * STRUCTURE DECLARATIONS
!  */
! struct SprCluster {
!     Uint16	no;             /* クラスタ番号                              */
!     Uint16	angleSeq;       /* 回転順序                                  */
!     MthXyz	angle;	        /* 親クラスタの座標系における回転            */
!     MthXyz	point;	        /* 親クラスタの座標系における原点の座標      */
!     SprObject3D	*object;        /* ３Ｄオブジェクト                          */
!     SprCluster	*next;       	/* 次クラスタ                                */
!     SprCluster	*child;      	/* 子クラスタ                                */
!     SprInbetInf *inbetInf;     	/* ３Ｄオブジェクト間接続ポリゴン情報        */
!     void        (*transStart)(SprCluster*);
!                                 /* 座標変換開始前ユーザコールバックルーチン  */
!     void        (*transEnd)(SprCluster*, SprObject3D*, MthMatrix*, MthXyz*);
!                                 /* 座標変換終了後ユーザコールバックルーチン  */
!     void        *context;       /* ユーザコンテキストエリア                  */
! };
! 
! struct SprObject3D {
!     Uint16	no;             /* オブジェクト番号                          */
!     Uint16      dispFlag;       /* 表示フラグ                                */
!     Uint16      vertCount;      /* 頂点数                                    */
!     Uint16      surfaceCount;   /* 面数                                      */
!     MthXyz      *vertPoint;     /* 頂点座標テーブル                          */
!     MthXyz      *vertNormal;    /* 頂点の法線ベクトルテーブル                */
!     SprSurface  *surface;       /* 面定義テーブル                            */
!     MthXyz      *surfaceNormal; /* 面の法線ベクトルテーブル                  */
!     MthXyz      *surfaceVert;   /* 面の代表頂点座標テーブル                  */
!     Uint16      **shdIdxTbl;    /* シェーディングインデックステーブル        */
!     Fixed32     surfNormK;      /* 面法線ベクトルの計算補正値                */
!     SprObject3D *next;          /* 次３Ｄオブジェクト                        */
! };
! 
! struct SprSurface {
!     Uint16     vertNo[4];       /* 面を構成する頂点番号                      */
!     Uint16     drawMode;        /* 描画モード                                */
!     Uint16     color;           /* カラーデータ                              */
! };
! 
! struct SprInbetInf {
!     Sint32       vertCount;     /* 取り出し頂点数                            */
!     SprObject3D  *fromObj;      /* 接続頂点データ取り出しオブジェクト        */
!     Uint16       *fromVertNo;   /* 取り出し頂点番号配列                      */
!     SprObject3D  *toObj;        /* 接続頂点データ設定オブジェクト            */
!     Uint16       *toVertNo;     /* 設定頂点番号配列                          */
!     SprInbetInf  *next;         /* 次３Ｄオブジェクト間接続ポリゴン情報      */
! };
! 
! struct SprTexture {
!     Uint16       charNo;        /* キャラクタ番号                            */
!     Uint16       colorMode;     /* カラーモード                              */
!     Uint16       color;         /* カラーデータ（ｶﾗｰﾊﾞﾝｸorﾙｯｸｱｯﾌﾟﾃｰﾌﾞﾙNo）   */
!     Uint16       width;         /* キャラクタの幅                            */
!     Uint16       height;        /* キャラクタの高さ                          */
!     Uint8        *charData;     /* キャラクタデータのポインタ                */
!     SprLookupTbl *lookupTbl;    /* ルックアップテーブルのポインタ            */
! };
! 
! struct Spr3WorkArea {
!     Uint16      objSurfMax;        /* オブジェクト内最大面数                 */
!     Uint16      objVertMax;        /* オブジェクト内最大頂点数               */
!     Sint32      *surfBright[2];    /* 面輝度テーブル                         */
!     Sint32      *vertBright[2];    /* 頂点輝度テーブル                       */
!     MthXyz      *coordView3D[2];   /* ３Ｄ視点座標変換後テーブル             */
!     MthXyz      *coordWorld3D[2];  /* ３Ｄワールド座標変換後テーブル         */
!     XyInt       *coord2D;          /* ２Ｄ透視変換後テーブル                 */
!     Uint8       *coord2DFlag;      /* ２Ｄ透視変換処理フラグテーブル         */
! };
! 
! struct Spr3dStatus {
!     MthXyz    lightAngle;       /* 光源アングル                           */
!     MthXyz    viewCoordPoint;   /* 視点座標系内の視点位置                 */
!     MthXyz    viewPoint;        /* 視点座標                               */
!     MthXyz    viewAngle;        /* 視点アングル                           */
!     Sint32    viewAngleSeq;     /* 視点アングル回転操作                   */
!     Sint32    zSortMode;        /* ＺソートＺ座標値の採用モード           */
!     Fixed32   zSortZMin;        /* フラッシュ単位現Ｚ座標最小値           */
!     Fixed32   zSortZMax;        /* フラッシュ単位現Ｚ座標最大値           */
!     Fixed32   clipZMin;         /* 視点座標系クリップＺ最小値座標         */
!     Fixed32   clipZMax;         /* 視点座標系クリップＺ最大値座標         */
!     Sint32    clipLevel;        /* クリッピングレベル                     */
!     MthXy     unitPixel;        /* X,Y 1.0 に対するスクリーンのピクセル数 */
! };
! 
! 
! 
! /*
!  * GLOBAL DEFINES/MACROS DEFINES
!  */
! #define   ROT_SEQ_ZYX       0x0000
! #define   ROT_SEQ_ZXY       0x0001
! #define   ROT_SEQ_YZX       0x0002
! #define   ROT_SEQ_YXZ       0x0003
! #define   ROT_SEQ_XYZ       0x0004
! #define   ROT_SEQ_XZY       0x0005
! 
! #define   DISP_POLYGON      0x0000
! #define   DISP_POLYLINE     0x8000
! #define   DISP_MASK         0xc000
! #define   BOTH_FACE         0x1000
! 
! #define   NO_SHADING        0x0000
! #define   FLAT_SHADING      0x0100
! #define   GOURAUD_SHADING   0x0200
! #define   SHADING_MASK      0x0300
! #define   INBETWEEN_OBJECT  0x0010
! 
! #define   MATE_COLOR        0x0000
! #define   MATE_TEXTURE      0x4000
! #define   MATE_SHADING_TBL  0x8000
! #define   MATE_AUTO_SHADING 0xc000
! #define   MATE_MASK         0xc000
! 
! #define   ZSORT_MIN         0x0000
! #define   ZSORT_MAX         0x1000
! #define   ZSORT_MID         0x2000
! #define   ZSORT_MASK        0x3000
! #define   ZSORT_FLOAT_MODE  0
! #define   ZSORT_FIXED_MODE  1
! 
! #define   DRAW_MODE_MASK    0x07ff
! 
! #ifdef SPR_3USE_DOUBLE_BUF
! #define   SPR_3mac1(sp3ObjSurfMax) \
! static Sint32    sp3SurfBright1 [sp3ObjSurfMax]; \
! static Sint32    sp3SurfBright2 [sp3ObjSurfMax];
! #else
! #define   SPR_3mac1(sp3ObjSurfMax) \
! static Sint32    sp3SurfBright1 [sp3ObjSurfMax];
! #endif
! 
! #ifdef SPR_3USE_DOUBLE_BUF
!   #ifdef SPR_3NEED_WORLD_VERT
! #define   SPR_3mac2(sp3ObjVertMax) \
! static Sint32    sp3VertBright1   [sp3ObjVertMax];   \
! static MthXyz    sp3CoordView3D1  [sp3ObjVertMax];   \
! static MthXyz    sp3CoordWorld3D1 [sp3ObjVertMax];   \
! static Sint32    sp3VertBright2   [sp3ObjVertMax];   \
! static MthXyz    sp3CoordView3D2  [sp3ObjVertMax];   \
! static MthXyz    sp3CoordWorld3D2 [sp3ObjVertMax];   \
! static XyInt     sp3Coord2D       [sp3ObjVertMax];   \
! static Uint8     sp3Coord2DFlag   [sp3ObjVertMax];
!   #else
! #define   SPR_3mac2(sp3ObjVertMax) \
! static Sint32    sp3VertBright1   [sp3ObjVertMax];   \
! static MthXyz    sp3CoordView3D1  [sp3ObjVertMax];   \
! static Sint32    sp3VertBright2   [sp3ObjVertMax];   \
! static MthXyz    sp3CoordView3D2  [sp3ObjVertMax];   \
! static XyInt     sp3Coord2D       [sp3ObjVertMax];   \
! static Uint8     sp3Coord2DFlag   [sp3ObjVertMax];
!   #endif
! #else
!   #ifdef SPR_3NEED_WORLD_VERT
! #define   SPR_3mac2(sp3ObjVertMax) \
! static Sint32    sp3VertBright1   [sp3ObjVertMax];   \
! static MthXyz    sp3CoordView3D1  [sp3ObjVertMax];   \
! static MthXyz    sp3CoordWorld3D1 [sp3ObjVertMax];   \
! static XyInt     sp3Coord2D       [sp3ObjVertMax];   \
! static Uint8     sp3Coord2DFlag   [sp3ObjVertMax];
!   #else
! #define   SPR_3mac2(sp3ObjVertMax) \
! static Sint32    sp3VertBright1   [sp3ObjVertMax];   \
! static MthXyz    sp3CoordView3D1  [sp3ObjVertMax];   \
! static XyInt     sp3Coord2D       [sp3ObjVertMax];   \
! static Uint8     sp3Coord2DFlag   [sp3ObjVertMax];
!   #endif
! #endif
! 
! #ifdef SPR_3USE_DOUBLE_BUF
!   #ifdef SPR_3NEED_WORLD_VERT
! #define   SPR_3mac3(sp3WorkArea, sp3ObjSurfMax, sp3ObjVertMax)  \
! static Spr3WorkArea  sp3WorkArea = {                          \
!    sp3ObjSurfMax, sp3ObjVertMax, \
!    sp3SurfBright1, sp3SurfBright2, sp3VertBright1, sp3VertBright2, \
!    sp3CoordView3D1, sp3CoordView3D2, sp3CoordWorld3D1, sp3CoordWorld3D2, \
!    sp3Coord2D, sp3Coord2DFlag };
!   #else
! #define   SPR_3mac3(sp3WorkArea, sp3ObjSurfMax, sp3ObjVertMax)  \
! static Spr3WorkArea  sp3WorkArea = {                          \
!    sp3ObjSurfMax, sp3ObjVertMax, \
!    sp3SurfBright1, sp3SurfBright2, sp3VertBright1, sp3VertBright2, \
!    sp3CoordView3D1, sp3CoordView3D2,              NULL,            NULL, \
!    sp3Coord2D, sp3Coord2DFlag };
!   #endif
! #else
!   #ifdef SPR_3NEED_WORLD_VERT
! #define   SPR_3mac3(sp3WorkArea, sp3ObjSurfMax, sp3ObjVertMax) \
! static Spr3WorkArea  sp3WorkArea = {                          \
!    sp3ObjSurfMax, sp3ObjVertMax, \
!    sp3SurfBright1,           NULL, sp3VertBright1,           NULL, \
!    sp3CoordView3D1,          NULL, sp3CoordWorld3D1,         NULL, \
!    sp3Coord2D, sp3Coord2DFlag };
!   #else
! #define   SPR_3mac3(sp3WorkArea, sp3ObjSurfMax, sp3ObjVertMax) \
! static Spr3WorkArea  sp3WorkArea = {                          \
!    sp3ObjSurfMax, sp3ObjVertMax, \
!    sp3SurfBright1,            NULL, sp3VertBright1,           NULL, \
!    sp3CoordView3D1,           NULL,             NULL,             NULL, \
!    sp3Coord2D, sp3Coord2DFlag };
!   #endif
! #endif
! 
! #define   SPR_3DefineWork(sp3WorkArea, sp3ObjSurfMax, sp3ObjVertMax) \
!  SPR_3mac1(sp3ObjSurfMax) \
!  SPR_3mac2(sp3ObjVertMax) \
!  SPR_3mac3(sp3WorkArea, sp3ObjSurfMax, sp3ObjVertMax)
! 
! /*
!  * PROTOTYPE DECLARATIONS
!  */
! void   SPR_3Initial       (Spr3WorkArea  *workArea);
! void   SPR_3SetLight      (Uint16 moveKind, MthXyz *lightAngle);
! void   SPR_3SetView       (Uint16 moveKind, MthXyz *viewPoint,
!                            MthXyz *viewAngle, Uint16 angleSeq,
!                            MthXyz *viewCoordPoint);
! void   SPR_3MoveCluster   (SprCluster *cluster, Uint16 moveKind,
! 					   MthXyz *angle, MthXyz *point);
! void   SPR_3DrawModel     (SprCluster *rootCluster);
! void   SPR_3Flush         (void);
! void   SPR_3SetTexture    (SprTexture *texture);
! void   SPR_3ChangeTexColor(Uint16 charNo, Uint16 color,
!                                           SprLookupTbl *lookupTbl);
! void   SPR_3ClrTexture    (SprTexture *texture);
! void   SPR_3SetZSortMinMax(Uint16 pZSortMode,
!                                        Fixed32 pZSortZMin, Fixed32 pZSortZMax);
! void   SPR_3SetClipLevel  (Uint16 pClipLevel,
! 				       Fixed32 pClipZMin, Fixed32 pClipZMax);
! void   SPR_3SetPixelCount (Uint16 pixelCountX, Uint16 pixelCountY);
! void   SPR_3GetStatus (Spr3dStatus *spr3dStatus);
! void   SPR_3CallAllCluster(SprCluster *cluster, void (*userFunc)(SprCluster*));
! void   SPR_3SetSurfNormVect(SprObject3D  *obj);
! void   SPR_3SetDrawSpeed(Sint32 hssFlag, Sint32 eosFlag, Sint32 pclpFlag);
! #endif /* _SPR3_ */
! 
! #endif /* ifndef SEGA_SPR_H */
! 
! /*  end of file */
diff -crB --binary sbl6/segalib/include/sega_sys.h sbl6_patch/segalib/include/sega_sys.h
*** sbl6/segalib/include/sega_sys.h	1996-02-08 05:23:50.000000000 -0500
--- sbl6_patch/segalib/include/sega_sys.h	2022-03-07 20:57:50.000000000 -0500
***************
*** 41,49 ****
   *      void  test()
   *      {
   *           void (*tmp)();
!  *           Sint32 rep;
!  *           Uint32 msk, clk, lval1;
!  *           Uint8  p0;
   *           const Uint32 PriTab[32] = {
   *              0x00f0ffff, 0x00e0fffe, 0x00d0fffc, 0x00c0fff8,
   *              0x00b0fff0, 0x00a0ffe0, 0x0090ffc0, 0x0080ff80,
--- 41,49 ----
   *      void  test()
   *      {
   *           void (*tmp)();
!  *           Sint32	rep;
!  *           Uint32	msk, clk, lval1;
!  *           Uint8 	p0;
   *           const Uint32 PriTab[32] = {
   *              0x00f0ffff, 0x00e0fffe, 0x00d0fffc, 0x00c0fff8,
   *              0x00b0fff0, 0x00a0ffe0, 0x0090ffc0, 0x0080ff80,
***************
*** 94,158 ****
   *           // ... 実行文 ... //
   *      }
   *
   */
  
! #ifndef SEGA_SYS_H
  #define SEGA_SYS_H
  
- /***********************************************************************
-  *      インクルードファイル
-  ***********************************************************************/
  #include "sega_xpt.h"
  
- /*****************************************************************************
-  *      定数マクロ
-  *****************************************************************************/
- 
- /* バージョン */
-                     /*             1         2         3         4    */
-                     /*    1234567890123456789012345678901234567890    */
-                     /*    ++++++++++++++++++++++++++++++++            */
- #define SYS_VERSION_STR ("SYS Version 2.10 1996-01-31")
- #define SYS_VERSION_LEN         (32)
- 
- /***********************************************************************
-  *      処理マクロ
-  ***********************************************************************/
  #define SYS_SETUINT(_Num_, _Hdr_) \
!         ((**(volatile void(**)(Uint32, void*))0x6000300)((_Num_), (_Hdr_)))
  #define SYS_GETUINT(_Num_) \
          ((void*)(**(void(*(**)(Uint32))(Uint32))0x6000304)(_Num_))
  
  #define SYS_SETSINT(_Num_, _Hdr_) \
!         ((**(volatile void(**)(Uint32, void*))0x6000310)((_Num_), (_Hdr_)))
  #define SYS_GETSINT(_Num_) \
          ((void*)(**(void(*(**)(Uint32))(Uint32))0x6000314)(_Num_))
  
  #define SYS_TASSEM(_Num_) \
!         ((**(volatile Uint32(**)(Uint32))0x6000330)(_Num_))
  #define SYS_CLRSEM(_Num_) \
!         ((**(volatile void(**)(Uint32))0x6000334)(_Num_))
  
  #define SYS_SETSCUIM(_MaskPat_) \
!         ((**(volatile void(**)(Uint32))0x6000340)(_MaskPat_))
  #define SYS_CHGSCUIM(_AndMask_, _OrMask_) \
!         ((**(volatile void(**)(Uint32, Uint32))0x6000344)((_AndMask_), (_OrMask_)))
  #define SYS_GETSCUIM \
!         (*(volatile Uint32*)0x6000348)
  
  #define SYS_CHGSYSCK(_CkMode_) \
!         ((**(volatile void(**)(Uint32))0x6000320)(_CkMode_))
  #define SYS_GETSYSCK \
!         (*(volatile Uint32*)0x6000324)
  
  #define SYS_CHGUIPR(_IprTab_) \
!         ((**(volatile void(**)(Uint32*))0x6000280)(_IprTab_))
  
  #define SYS_EXECDMP \
!         (**(volatile void(**)(void))0x600026C)
  
  #define SYS_PCLRMEM \
!         (*(volatile Uint8*)0x6000210)
  
  #define SYS_CHKMPEG(_dummy_) \
          ((**(volatile Sint32(**)(Sint32))0x6000274)(_dummy_))
--- 94,147 ----
   *           // ... 実行文 ... //
   *      }
   *
+  *
+  * 日付:        1994/05/06  for BOOT 0.90,0.901,0.91  by T. S.
+  *              1994/07/16  for BOOT 0.92x,0.95       by T. S.
+  *              1994/07/29  for BOOT 0.96x,1.00       by T. S.
+  *              1994/08/31  how to exec CD multi-player
+  *              1994/09/21  for Ver.1.00 BOOT ROM
   */
  
! #ifndef	SEGA_SYS_H
  #define SEGA_SYS_H
  
  #include "sega_xpt.h"
  
  #define SYS_SETUINT(_Num_, _Hdr_) \
!         ((**(void(**)(Uint32, void*))0x6000300)((_Num_), (_Hdr_)))
  #define SYS_GETUINT(_Num_) \
          ((void*)(**(void(*(**)(Uint32))(Uint32))0x6000304)(_Num_))
  
  #define SYS_SETSINT(_Num_, _Hdr_) \
!         ((**(void(**)(Uint32, void*))0x6000310)((_Num_), (_Hdr_)))
  #define SYS_GETSINT(_Num_) \
          ((void*)(**(void(*(**)(Uint32))(Uint32))0x6000314)(_Num_))
  
  #define SYS_TASSEM(_Num_) \
!         ((**(Uint32(**)(Uint32))0x6000330)(_Num_))
  #define SYS_CLRSEM(_Num_) \
!         ((**(void(**)(Uint32))0x6000334)(_Num_))
  
  #define SYS_SETSCUIM(_MaskPat_) \
!         ((**(void(**)(Uint32))0x6000340)(_MaskPat_))
  #define SYS_CHGSCUIM(_AndMask_, _OrMask_) \
!         ((**(void(**)(Uint32, Uint32))0x6000344)((_AndMask_), (_OrMask_)))
  #define SYS_GETSCUIM \
!         (*(Uint32*)0x6000348)
  
  #define SYS_CHGSYSCK(_CkMode_) \
!         ((**(void(**)(Uint32))0x6000320)(_CkMode_))
  #define SYS_GETSYSCK \
!         (*(Uint32*)0x6000324)
  
  #define SYS_CHGUIPR(_IprTab_) \
!         ((**(void(**)(Uint32*))0x6000280)(_IprTab_))
  
  #define SYS_EXECDMP \
!         (**(void(**)(void))0x600026C)
  
  #define SYS_PCLRMEM \
!         (*(Uint8*)0x6000210)
  
  #define SYS_CHKMPEG(_dummy_) \
          ((**(volatile Sint32(**)(Sint32))0x6000274)(_dummy_))
***************
*** 164,167 ****
  void SYS_Exit(Sint32 code);
  
  #endif
- 
\ No newline at end of file
--- 153,155 ----
diff -crB --binary sbl6/segalib/include/sl_def.h sbl6_patch/segalib/include/sl_def.h
*** sbl6/segalib/include/sl_def.h	1996-02-08 05:23:52.000000000 -0500
--- sbl6_patch/segalib/include/sl_def.h	2022-04-17 20:10:22.000000000 -0400
***************
*** 1,10 ****
  /*							*/
  /*  SEGA Library defines	*/
  /*							*/
! 
  #ifndef SEGA_XPT_H
  #define SEGA_XPT_H
! 
  /*****************************************************************************/
  /****************************** 基本データ型宣言 *****************************/
  /*****************************************************************************/
--- 1,25 ----
  /*							*/
  /*  SEGA Library defines	*/
  /*							*/
! 
  #ifndef SEGA_XPT_H
  #define SEGA_XPT_H
! 
! #if 0
! #  define ST_V				/* or ST_VE (for Enhanced ST-V) */
! #  define TITAN
! #endif
! 
! #define		shc		1
! #define		sh_gcc		2
! #define		Compiler	sh_gcc		/* fot Hitachi then "shc" */
! 
! #if Compiler == shc
! #  define  STCNS  static const
! #else
! #  define  STCNS  static
! #endif
! 
  /*****************************************************************************/
  /****************************** 基本データ型宣言 *****************************/
  /*****************************************************************************/
***************
*** 58,66 ****
  #define ABS(x)          ((x) < 0 ? -(x) : (x))  /* 絶対値 */
  
  /*---------------------------------------------------------------------------*/
! #endif  /* SEGA_XPT_H */
! 
! 
  #ifndef SL_DEF_H
  #define SL_DEF_H
  
--- 73,81 ----
  #define ABS(x)          ((x) < 0 ? -(x) : (x))  /* 絶対値 */
  
  /*---------------------------------------------------------------------------*/
! #endif  /* SEGA_XPT_H */
! 
! 
  #ifndef SL_DEF_H
  #define SL_DEF_H
  
***************
*** 97,103 ****
  typedef     FIXED	VECTOR[XYZ] ;		/* ベクトルデータ */
  typedef     FIXED	POINT[XYZ] ;		/* 頂点の位置データ */
  
! #define	    CURRENT		0	/* Current Matrix */
  
  enum mtrx {M00 , M01 , M02 ,		/* マトリクスの要素番号 */
  	   M10 , M11 , M12 ,
--- 112,119 ----
  typedef     FIXED	VECTOR[XYZ] ;		/* ベクトルデータ */
  typedef     FIXED	POINT[XYZ] ;		/* 頂点の位置データ */
  
! #define	    CURRENT		0		/* Current Matrix */
! #define	    ORIGINAL		(0.99999)	/* Original Scale */
  
  enum mtrx {M00 , M01 , M02 ,		/* マトリクスの要素番号 */
  	   M10 , M11 , M12 ,
***************
*** 107,129 ****
  	   } ;
  
  enum tvsz {
! 	TV_320x224 ,
! 	TV_320x240 ,
! 	TV_352x224 ,
! 	TV_352x240 ,
! 	TV_640x224 ,
! 	TV_640x240 ,
! 	TV_704x224 ,
! 	TV_704x240 ,
! 
! 	TV_320x448 ,
! 	TV_320x480 ,
! 	TV_352x448 ,
! 	TV_352x480 ,
! 	TV_640x448 ,
! 	TV_640x480 ,
! 	TV_704x448 ,
! 	TV_704x480
      } ;
  
  #define		_SysPause		64
--- 123,137 ----
  	   } ;
  
  enum tvsz {
! 	TV_320x224 , TV_320x240 , TV_320x256 , TV_dummy1 ,
! 	TV_352x224 , TV_352x240 , TV_352x256 , TV_dummy2 ,
! 	TV_640x224 , TV_640x240 , TV_640x256 , TV_dummy3 ,
! 	TV_704x224 , TV_704x240 , TV_704x256 , TV_dummy4 ,
! 
! 	TV_320x448 , TV_320x480 , TV_320x512 , TV_dummy5 ,
! 	TV_352x448 , TV_352x480 , TV_352x512 , TV_dummy6 ,
! 	TV_640x448 , TV_640x480 , TV_640x512 , TV_dummy7 ,
! 	TV_704x448 , TV_704x480 , TV_704x512 , TV_dummy8
      } ;
  
  #define		_SysPause		64
***************
*** 132,144 ****
--- 140,158 ----
  
  /*----------------------------------------------------------------------------------*/
  
+ #ifndef M_PI
+ #define     M_PI                3.1415926535897932
+ #endif
+ 
  #define	    toFIXED(a)		((FIXED)(65536.0 * (a)))
  #define	    POStoFIXED(x,y,z)	{toFIXED(x),toFIXED(y),toFIXED(z)}
  #define	    ATTRIBUTE(f,s,t,c,g,a,d,o)	{f,(s)|(((d)>>16)&0x1c)|(o),t,(a)|(((d)>>24)&0xc0),c,g,(d)&0x3f}
  #define	    SPR_ATTRIBUTE(t,c,g,a,d)	{t,(a)|(((d)>>24)&0xc0),c,g,(d)&0x0f3f}
  #define	    DEGtoANG(d)		((ANGLE)((65536.0 * (d)) / 360.0))
+ #define     RADtoANG(d)         ((ANGLE)((65536.0 * (d)) / (2*M_PI)))
  #define	    RGB(r,g,b)		(0x8000|((b)<<10)|((g)<<5)|(r))
  #define	    DGTtoRGB(c)		(0x8000|(((c)&0x0f00)<<3)|(((c)&0x4000)>>4)|(((c)&0x00f0)<<2)|(((c)&0x2000)>>8)|(((c)&0x000f)<<1)|(((c)&0x1000)>>12))
+ #define	    SLocate(x,y,p)	((p) * Page + (y) * Line + (x))
  
  /*  Sprite control function */
  
***************
*** 162,167 ****
--- 176,184 ----
  #define	    _ZmRC		(0x0b << 8)	/* Zoom base Right Center */
  #define	    _ZmRB		(0x0f << 8)	/* Zoom base Right Bottom */
  
+ #define	    MSBon		(1 << 15)	/* フレームバッファに書き込むＭＳＢを１にする */
+ #define	    HSSon		(1 << 12)	/* ハイスピードシュリンク有効 */
+ #define	    HSSoff		(0 << 12)	/* ハイスピードシュリンク無効(default) */
  #define	    No_Window		(0 << 9)	/* ウィンドウの制限を受けない(default)*/
  #define	    Window_In		(2 << 9)	/* ウィンドウの内側に表示 */
  #define	    Window_Out		(3 << 9)	/* ウィンドウの外側に表示 */
***************
*** 185,209 ****
  
  #define	    UseTexture		(1 << 2)	/* テクスチャを貼るポリゴン */
  #define	    UseLight		(1 << 3)	/* 光源の影響を受けるポリゴン */
! #define	    UseClip		(1 << 4)	/* 画面外に頂点が出たら表示しない */
! #define	    UsePalette		(1 << 5)	/*  */
  
! #define	    sprHflip		(1 << 4) | FUNC_Texture | (UseTexture << 16)
! #define	    sprVflip		(1 << 5) | FUNC_Texture | (UseTexture << 16)
! #define	    sprHVflip		(3 << 4) | FUNC_Texture | (UseTexture << 16)
! #define	    sprNoflip		(0) | FUNC_Texture | (UseTexture << 16)
! #define	    sprPolygon		FUNC_Polygon | ((ECdis | SPdis) << 24)
! #define	    sprPolyLine		FUNC_PolyLine | ((ECdis | SPdis) << 24)
! #define	    sprLine		FUNC_Line | ((ECdis | SPdis) << 24)
  
  #define	    No_Texture		0		/* テクスチャを使用しない時 */
  #define	    No_Option		0		/* オプションを使用しない時 */
  #define	    No_Gouraud		0		/* グーローシェーディングを使用しない時 */
  #define	    No_Palet	        0		/* カラーパレットの指定がいらない時 */
! #define	    GouraudRAM		(0x00080000 - (33*8))	/* 光源の影響用のグーローバッファ */
  
  typedef struct {
!     VECTOR	 norm ;				/* 法線ベクトル */
      Uint16	 Vertices[4] ;		/* ポリゴンを構成する頂点番号 */
  } POLYGON ;
  
--- 202,237 ----
  
  #define	    UseTexture		(1 << 2)	/* テクスチャを貼るポリゴン */
  #define	    UseLight		(1 << 3)	/* 光源の影響を受けるポリゴン */
! #define	    UsePalette		(1 << 5)	/* ポリゴンのカラー */
  
! /* SGL Ver3.0 Add */
! #define	    UseNearClip		(1 << 6)	/* ニア・クリッピングをする */
! #define	    UseGouraud		(1 << 7)	/* リアルグーロー */
! #define	    UseDepth		(1 << 4)	/* デプスキュー */
! /* */
! 
! #if 0 /* SGL Ver3.0 Delete */
! #define	    UseClip		(1 << 4)		/* 画面外に頂点が出たら表示しない */
! #else
! #define	    UseClip		UseNearClip		/* ニア・クリッピングをする */
! #endif
! 
! #define	    sprHflip		((1 << 4) | FUNC_Texture | (UseTexture << 16))
! #define	    sprVflip		((1 << 5) | FUNC_Texture | (UseTexture << 16))
! #define	    sprHVflip		((3 << 4) | FUNC_Texture | (UseTexture << 16))
! #define	    sprNoflip		((0) | FUNC_Texture | (UseTexture << 16))
! #define	    sprPolygon		(FUNC_Polygon | ((ECdis | SPdis) << 24))
! #define	    sprPolyLine		(FUNC_PolyLine | ((ECdis | SPdis) << 24))
! #define	    sprLine		(FUNC_Line | ((ECdis | SPdis) << 24))
  
  #define	    No_Texture		0		/* テクスチャを使用しない時 */
  #define	    No_Option		0		/* オプションを使用しない時 */
  #define	    No_Gouraud		0		/* グーローシェーディングを使用しない時 */
  #define	    No_Palet	        0		/* カラーパレットの指定がいらない時 */
! #define	    GouraudRAM		(0x00080000 - (32*8))	/* 光源の影響用のグーローバッファ */
  
  typedef struct {
!     VECTOR	 norm ;			/* 法線ベクトル */
      Uint16	 Vertices[4] ;		/* ポリゴンを構成する頂点番号 */
  } POLYGON ;
  
***************
*** 214,220 ****
      Uint16	 atrb ;			/* アトリビュートデータ(表示モード) */
      Uint16	 colno ;		/* カラーナンバー */
      Uint16	 gstb ;			/* グーローシェーディングテーブル */
!     Uint16	 dir ; 			/* テクスチャの反転とファンクションナンバー */
  } ATTR ;
  
  typedef struct spratr{
--- 242,248 ----
      Uint16	 atrb ;			/* アトリビュートデータ(表示モード) */
      Uint16	 colno ;		/* カラーナンバー */
      Uint16	 gstb ;			/* グーローシェーディングテーブル */
!     Uint16	 dir ;			/* テクスチャの反転とファンクションナンバー */
  } ATTR ;
  
  typedef struct spratr{
***************
*** 233,238 ****
--- 261,368 ----
      ATTR	*attbl ;		/* ポリゴンのアトリビュートテーブル */
  } PDATA ;
  
+ /* SGL Ver3.0 Add */
+ typedef struct {
+     POINT	*pntbl ;		/* 頂点の位置データテーブル */
+     Uint32	 nbPoint ;		/* 頂点の数 */
+     POLYGON	*pltbl ;		/* ポリゴン定義テーブル */
+     Uint32	 nbPolygon ;		/* ポリゴンの数 */
+     ATTR	*attbl ;		/* ポリゴンのアトリビュートテーブル */
+     VECTOR	*vntbl;
+ } XPDATA ;
+ /* */
+ 
+ #ifdef ST_VE
+ 
+ typedef struct {
+     Uint16	 pmod ;			/* スプライト表示モード */
+     Uint16	 colno ;		/* カラーナンバー */
+     Uint16	 CGadr ;		/* スプライトＣＧアドレス / ８ */
+     Uint16	 HVsize ;		/* Ｈサイズ/８、Ｖサイズ(ハード用) */
+ } gxATTR_VDP1 ;
+ 
+ typedef struct {
+     Uint32	 texcel ;		/* テクスチャセルアドレス */
+     Uint16	 dspmode ;		/* ディスプレイモードフラグ */
+     Uint16	 colno ;		/* カラーデータ */
+     Uint8	 TXA , TYA ;		/* テクスチャポイント */
+     Uint8	 TXB , TYB ;
+     Uint8	 TXC , TYC ;
+     Uint8	 TXD , TYD ;
+ } gxATTR_ENHC ;
+ 
+ typedef struct{
+     Uint16	 texno ;		/* テクスチャ番号 */
+     Uint16	 atrb ;			/* アトリビュートデータ(表示モード) */
+     Uint16	 colno ;		/* カラーナンバー */
+     Uint16	 gstb ;			/* グーローシェーディングテーブル */
+     Uint16	 dir ;			/* テクスチャの反転とファンクションナンバー */
+ } gxSPR_ATTR ;
+ 
+ typedef struct {
+     Uint16	texno ;			/* テクスチャオフセットアドレス */
+     Uint8	attr ;			/* 質感コード、ソーティングモード等 */
+     Uint8	nvface ;		/* 面法線ベクトルナンバー */
+     Uint8	nvnum[4] ;		/* 頂点法線ベクトルナンバー */
+     Uint8	Vertices[4] ;		/* ポリゴンを構成する頂点番号 */
+ } gxPOLYGON ;
+ 
+ typedef struct {
+     POINT	*pntbl ;		/* 頂点の位置データテーブル */
+     Uint16	 nbPoint ;		/* 頂点の数 */
+     Uint16	 nbNVector ;		/* 法線ベクトルの数 */
+     VECTOR	*nvtbl ;		/* 法線ベクトルデータテーブル */
+     gxPOLYGON	*pltbl ;		/* ポリゴン定義テーブル */
+     Uint32	 nbPolygon ;		/* ポリゴンの数 */
+     gxATTR_VDP1	*attbl ;		/* ポリゴンのアトリビュートテーブル */
+ } gxPDATA ;
+ 
+ typedef struct {
+     Uint32	 texadr ;		/* テクスチャデータテーブル */
+     Uint8	 BD ;			/* 各頂点の輝度 */
+     Uint8	 BC ;
+     Uint8	 BB ;
+     Uint8	 BA ;
+     Sint16	 XA ;			/* 各頂点の位置 */
+     Sint16	 YA ;
+     Sint16	 XB ;
+     Sint16	 YB ;
+     Sint16	 XC ;
+     Sint16	 YC ;
+     Sint16	 XD ;
+     Sint16	 YD ;
+     Uint16	 ZA ;			/* 各頂点のＺ値 */
+     Uint16	 ZB ;
+     Uint16	 ZC ;
+     Uint16	 ZD ;
+     Uint16	 winno ;		/* ウィンドウナンバー */
+     Uint16	 ZF ;			/* 代表Ｚ値 */
+ } gxDIRECT ;
+ 
+ #define		winEXn		0	/* エンハンサ側 手前(near) */
+ #define		winEXf		1	/* エンハンサ側 奥(far) */
+ #define		winSTn		2	/* ＳＴ-Ｖ側 手前(near) */
+ #define		winSTf		3	/* ＳＴ-Ｖ側 奥(far) */
+ 
+ #define	    gxPOLYTBL(f,s,t,m,n)	{((f)<<16)|((t)<<20)|((s)<<12)|((m)<<8)|(n)
+ #define	    gxNormal(a,b,c,d)		(a,b,c,d)
+ #define	    gxVertices(a,b,c,d)		(a,b,c,d)}
+ #define	    gxATTRVDP1(p,c,a,s)		{p,c,a,s}
+ #define	    gxATTRENHC(cx,cy,sx,sy,cm,cl,an,hf,ms,sp,te,fm)	{\
+ 					((cx)<<4)|((cy)<<14)|(sx)|((sy)<<10)|(cm),\
+ 					((ms)>>5)|(((sp)^SPdis)>>4)|((te)<<1)|\
+ 					((an)<<8)|((hf)<<6)|(fm),(cl)
+ #endif
+ 
+ typedef struct obj{
+     PDATA	*pat ;			/* ポリゴンモデルデータテーブル */
+     FIXED	 pos[XYZ] ;		/* 相対位置データ */
+     ANGLE	 ang[XYZ] ;		/* 回転角データ */
+     FIXED	 scl[XYZ] ;		/* スケーリングデータ */
+     struct obj	*child ;		/* 子オブジェクトデータ */
+     struct obj	*sibling ;		/* 兄弟オブジェクトデータ */
+ } OBJECT ;
+ 
  typedef struct {
      Uint16	 Hsize ;		/* スプライトのＨサイズ */
      Uint16	 Vsize ;		/* スプライトのＶサイズ */
***************
*** 271,284 ****
      Uint16	COLR ;			/* カラーデータ */
      Uint16	SRCA ;			/* ＣＧアドレス */
      Uint16	SIZE ;			/* キャラクタサイズ */
!     Uint16	  XA ;			/* 表示位置 Ａ */
!     Uint16	  YA ;
!     Uint16	  XB ;			/* 表示位置 Ｂ */
!     Uint16	  YB ;
!     Uint16	  XC ;			/* 表示位置 Ｃ */
!     Uint16	  YC ;
!     Uint16	  XD ;			/* 表示位置 Ｄ */
!     Uint16	  YD ;
      Uint16	GRDA ;			/* グーローシェーディングテーブル */
      Uint16	DMMY ;			/* サイズ合わせ用 ダミーデータ */
  } SPRITE ;
--- 401,414 ----
      Uint16	COLR ;			/* カラーデータ */
      Uint16	SRCA ;			/* ＣＧアドレス */
      Uint16	SIZE ;			/* キャラクタサイズ */
!     Sint16	  XA ;			/* 表示位置 Ａ */
!     Sint16	  YA ;
!     Sint16	  XB ;			/* 表示位置 Ｂ */
!     Sint16	  YB ;
!     Sint16	  XC ;			/* 表示位置 Ｃ */
!     Sint16	  YC ;
!     Sint16	  XD ;			/* 表示位置 Ｄ */
!     Sint16	  YD ;
      Uint16	GRDA ;			/* グーローシェーディングテーブル */
      Uint16	DMMY ;			/* サイズ合わせ用 ダミーデータ */
  } SPRITE ;
***************
*** 344,349 ****
--- 474,484 ----
  #define	    VDP2_COLRAM    		0x25f00000
  
  #define	    CG_Size		(8*8)		/* １セルの大きさ(CG) */
+ #define     CG16Size            (8*8/2)         /* １セルの大きさ(CG 16Colors) */
+ #define     CG256Size           (8*8)           /* １セルの大きさ(CG 256Colors) */
+ #define     CG2048Size          (8*8*2)         /* １セルの大きさ(CG 2048Colors) */
+ #define     CG32KSize           (8*8*2)         /* １セルの大きさ(CG 32KColors) */
+ 
  typedef     Uint16		CELL ;		/* １セルの大きさ(Pattern name) */
  #define	    Line		64		/* １ラインの大きさ */
  #define	    Page		(64*Line)	/* １ページの大きさ */
***************
*** 382,387 ****
--- 517,527 ----
      Sint32	DKA ;		/* 係数テーブル水平方向アドレス増分 ＫＡ */
  } ROTSCROLL ;
  
+ /* slExtSignal */
+ #define		EXLTEN			0x0200		/* External latch enable */
+ #define		EXSYEN			0x0100		/* External synch enable */
+ #define		DASEL			0x0002		/* Display area select */
+ #define		EXBGEN			0x0001		/* External background screen enable */
  
  /* slColRAMMode */
  #define		CRM16_1024		0
***************
*** 515,520 ****
--- 655,662 ----
  #define		scnNBG2			3
  #define		scnNBG3			2
  #define		scnRBG0			5
+ #define		scnRBGA			5
+ #define		scnRBGB			4
  #define		scnSPR			4
  #define		scnROT			7
  #define		scnCCAL			6
***************
*** 660,689 ****
  #define		SoundRAM		0x25a00000
  
  /*------[ System Work Assignments ]---------------------------------------*/
! 
! /*
!     extern const Uint16  MaxVertices ;
!     extern const Uint16  MaxPolygons ;
!     extern const void*   SortList ;	
!     extern const void*   TransList ;
!     extern const void*   Zbuffer ;	
!     extern const void*   SlSpriteBuf ;	
!     extern const void*   MsSpriteBuf ;	
!     extern const Uint16  SpriteBufSize ;
!     extern const void*   Pbuffer ;	
!     extern const void*   CLOfstBuf ;	
!     extern const void*   CommandBuf ;	
! */
! 
! 
  /*------[ Prottype ]------------------------------------------------------*/
  
  /*  Int library	*/
  
      extern  void  BlankIn(void) ;
      extern  void  BlankOut(void) ;
! 
! 
  /*  Math library	*/
  
      extern  FIXED  slSin(ANGLE) ;
--- 802,840 ----
  #define		SoundRAM		0x25a00000
  
  /*------[ System Work Assignments ]---------------------------------------*/
! 
!     extern const void*   MasterStack ;	/* Stack area End */
!     extern const Uint16  MaxVertices ;	/* Calculatable vertice numbers */
!     extern const Uint16  MaxPolygons ;	/* Calculatable polygon numbers */
!     extern const Uint16  EventSize ;	/* sizeof(EVENT) */
!     extern const Uint16  WorkSize ;	/* sizeof(WORK) */
!     extern const Uint16  MaxEvents ;	/* Useful Event count */
!     extern const Uint16  MaxWorks ;	/* Useful Work count */
!     extern const void*   SortList ;	/* SCU D.M.A. Table */
!     extern const Uint32  SortListSize ;	/* Sprite transfer request table size */
!     extern const void*   TransList ;	/* SCU D.M.A. Table */
!     extern const void*   Zbuffer ;	/* (128 + 128 + 256) * 4 Bytes fix */
!     extern const void*   SpriteBuf ;	/* Sprite control data buffer */
!     extern const Uint32  SpriteBufSize ; /* Sprite control data buffer size */
!     extern const void*   Pbuffer ;	/* Point calculate buffer */
!     extern const void*   CLOfstBuf ;	/* 32 * 32 Bytes fix */
!     extern const void*   CommandBuf ;	/* Command for slave CPU buffer */
!     extern const void*   PCM_Work ;	/* PCM data buffer */
!     extern const Uint32  PCM_WkSize ;	/* PCM data buffer size */
! 
!     extern EVENT  EventBuf[] ;		/* buffer for Event use */
!     extern WORK   WorkBuf[] ;		/* buffer for Work use */
!     extern EVENT* RemainEvent[] ;	/* Remain Event address buffer */
!     extern WORK*  RemainWork[] ;	/* Remain Work address buffer */
! 
  /*------[ Prottype ]------------------------------------------------------*/
  
  /*  Int library	*/
  
      extern  void  BlankIn(void) ;
      extern  void  BlankOut(void) ;
! 
! 
  /*  Math library	*/
  
      extern  FIXED  slSin(ANGLE) ;
***************
*** 696,715 ****
--- 847,877 ----
      extern  FIXED  slDivFX(FIXED , FIXED) ;
      extern  FIXED  slInnerProduct(VECTOR vct1 , VECTOR vct2) ;
      extern  FIXED  slCalcPoint(FIXED , FIXED , FIXED , FIXED ans[XYZ]) ;
+     extern  FIXED  slCalcVector(VECTOR vct , VECTOR ans) ;
      extern  FIXED  slRandom(void) ;
      extern  void   slNormalVector(VECTOR , VECTOR , VECTOR , VECTOR) ;
+     extern  void   slRevNormalVector(VECTOR , VECTOR , VECTOR , VECTOR) ;
  
      extern  void   slInitMatrix(void) ;
      extern  void   slUnitMatrix(MATRIX) ;
      extern  Bool   slPushMatrix(void) ;
      extern  Bool   slPopMatrix(void) ;
      extern  Bool   slPushUnitMatrix(void) ;
+     extern  Bool   slIncMatrixPtr(void) ;
+     extern  Bool   slDecMatrixPtr(void) ;
      extern  void   slLoadMatrix(MATRIX) ;
      extern  void   slGetMatrix(MATRIX) ;
+     extern  Bool   slCopyMatrix() ;
+     extern  void   slGetTranslate(FIXED*) ;
+     extern  void   slLoadTranslate(FIXED , FIXED , FIXED) ;
+     extern  void   slRegistMatrix(MATRIX) ;
      extern  void   slInversMatrix(void) ;
      extern  void   slTransposeMatrix(void) ;
+     extern  void   slUnitAngle(MATRIX) ;
+     extern  void   slUnitTranslate(MATRIX) ;
  
      extern  void   slTranslate(FIXED , FIXED , FIXED) ;
+     extern  void   slRegistTranslate(FIXED , FIXED , FIXED) ;
      extern  void   slMultiMatrix(MATRIX) ;
      extern  void   slScale(FIXED , FIXED , FIXED) ;
      extern  void   slRotX(ANGLE) ;
***************
*** 722,732 ****
--- 884,899 ----
      extern  void   slLookAt(FIXED *camera , FIXED *target , ANGLE) ;
      extern  FIXED  slBallCollision(FIXED *pos1 , FIXED size1 , FIXED *pos2 , FIXED size2) ;
      extern  FIXED  slCheckOnScreen(FIXED *pos , FIXED size) ;
+     extern  FIXED  slCheckOnScreen0(FIXED size) ;
      extern  void   slBezier(VECTOR p1,VECTOR p2,VECTOR p3,VECTOR p4,FIXED time,VECTOR ans) ;
+     extern  FIXED  slConvert3Dto2D( FIXED pos[XYZ], Sint32 ans[XY]) ;
+     extern  FIXED  slConvert3Dto2DFX( FIXED pos[XYZ], FIXED ans[XY]) ;
  
  /*  Text display library	*/
  
      extern void   *slLocate(Uint16 , Uint16) ;
+     extern void    slCurScrn(Uint16) ;
+     extern void    slCurColor(Uint16) ;
      extern void    slDispHex(Uint32 , void *) ;
      extern void    slPrintHex(Uint32 , void *) ;
      extern void    slPrintMatrix(MATRIX , void *) ;
***************
*** 740,763 ****
      extern void    set_vbar(Uint16) ;
      extern void    reset_vbar(Uint16) ;
      extern void    slExtendScroll(Uint8 * , void *) ;
  
  /*  Sprite library	*/
  
!     extern  void   slPutPolygon(PDATA *) ;
!     extern  void   slPutPolygonS(PDATA *) ;
!     extern  void   slDispPolygon(PDATA *, Uint16) ;
!     extern  void   slPutSprite(FIXED * , SPR_ATTR *attr , ANGLE) ;
!     extern  void   slDispSprite(FIXED * , SPR_ATTR *attr , ANGLE) ;
      extern  void   slPerspective(ANGLE) ;
!     extern  void   slWindow(Sint16 , Sint16 , Sint16 , Sint16 , Sint16 , Sint16 , Sint16) ;
      extern  void   slLight(VECTOR) ;
!     extern  void   slSetSprite(SPRITE * , FIXED) ;
      extern  void   slZdspLevel(Uint16) ;
  
  /*  Scroll library	*/
  
      extern  void    slTVOn(void) ;
      extern  void    slTVOff(void) ;
      extern  void    slColRAMMode(Uint16) ;
      extern  void    slVRAMMode(Uint16) ;
      extern  void    slScrCycleSet(Uint32 , Uint32 , Uint32 , Uint32) ;
--- 907,953 ----
      extern void    set_vbar(Uint16) ;
      extern void    reset_vbar(Uint16) ;
      extern void    slExtendScroll(Uint8 * , void *) ;
+     extern void   *slLocateNbg(Uint16 , Uint16 , Uint16) ;
+ #define		slLocateNbg0(x,y)	slLocateNbg(x,y,scnNBG0)
+ #define		slLocateNbg1(x,y)	slLocateNbg(x,y,scnNBG1)
+ #define		slLocateNbg2(x,y)	slLocateNbg(x,y,scnNBG2)
+ #define		slLocateNbg3(x,y)	slLocateNbg(x,y,scnNBG3)
+     extern void   *slLocatePage(Uint16 , Uint16 , Uint16) ;
  
  /*  Sprite library	*/
  
!     extern  Bool   slPutPolygon(PDATA *) ;
!     extern  Bool   slPutPolygonS(PDATA *) ;
!     extern  Bool   slDispPolygon(PDATA * , Uint16) ;
!     extern  Bool   slPutSprite(FIXED * , SPR_ATTR *attr , ANGLE) ;
!     extern  Bool   slDispSprite(FIXED * , SPR_ATTR *attr , ANGLE) ;
!     extern  Bool   slDispSpriteHV(FIXED * , SPR_ATTR *attr , ANGLE) ;
!     extern  Bool   slDispSpriteSZ(FIXED * , SPR_ATTR *attr , ANGLE) ;
!     extern  Bool   slDispSprite4P(FIXED * , FIXED , SPR_ATTR *attr) ;
      extern  void   slPerspective(ANGLE) ;
!     extern  void   slSetScreenDist(FIXED) ;
!     extern  Bool   slWindow(Sint16 , Sint16 , Sint16 , Sint16 , Sint16 , Sint16 , Sint16) ;
      extern  void   slLight(VECTOR) ;
!     extern  Bool   slSetSprite(SPRITE * , FIXED) ;
      extern  void   slZdspLevel(Uint16) ;
+     extern  Bool   slPutObject(OBJECT *) ;
+     extern  void   slCurWindow(Uint8) ;
+     enum {
+ 	winFar ,		/* Far side Window */
+ 	winNear			/* Near side Window */
+     } ;
+     extern  Uint8  slSprWinNum() ;
+     extern  void   slFrameClipSize(Sint16 , Sint16 );
+     extern  void   slSetScreenDist(FIXED);
+     extern  void   slGetFrameData(void * , Uint16 , Uint16 );
  
  /*  Scroll library	*/
  
      extern  void    slTVOn(void) ;
      extern  void    slTVOff(void) ;
+     extern  Uint16  slGetHCount(void) ;
+     extern  Uint16  slGetVCount(void) ;
+     extern  void    slExtSignal(Uint16 , Uint16) ;
      extern  void    slColRAMMode(Uint16) ;
      extern  void    slVRAMMode(Uint16) ;
      extern  void    slScrCycleSet(Uint32 , Uint32 , Uint32 , Uint32) ;
***************
*** 774,780 ****
      extern  void    slColorCalc(Uint16) ;
      extern  void    slColorCalcMode(Uint16) ;
      extern  void    slColorCalcOn(Uint16) ;
!     extern  void    slColRate(Uint16 , Uint16) ;
  #define		slColRateNbg0(rate)	slColRate(scnNBG0 , rate)
  #define		slColRateNbg1(rate)	slColRate(scnNBG1 , rate)
  #define		slColRateNbg2(rate)	slColRate(scnNBG2 , rate)
--- 964,970 ----
      extern  void    slColorCalc(Uint16) ;
      extern  void    slColorCalcMode(Uint16) ;
      extern  void    slColorCalcOn(Uint16) ;
!     extern  void    slColRate(Sint16 , Uint16) ;
  #define		slColRateNbg0(rate)	slColRate(scnNBG0 , rate)
  #define		slColRateNbg1(rate)	slColRate(scnNBG1 , rate)
  #define		slColRateNbg2(rate)	slColRate(scnNBG2 , rate)
***************
*** 791,796 ****
--- 981,988 ----
  #define		slColRateSpr6(rate)	slColRate(scnSPR6 , rate)
  #define		slColRateSpr7(rate)	slColRate(scnSPR7 , rate)
      extern  void    slColOffsetOn(Uint16) ;
+     extern  void    slColOffsetOff(Uint16) ;
+     extern  void    slColOffsetAUse(Uint16) ;
      extern  void    slColOffsetBUse(Uint16) ;
      extern  void    slColOffsetScrn(Uint16 , Uint16) ;
      extern  void    slColOffsetA(Sint16 r,Sint16 g,Sint16 b) ;
***************
*** 854,859 ****
--- 1046,1054 ----
      extern  void    slZoomNbg0(FIXED x,FIXED y) ;
      extern  void    slZoomNbg1(FIXED x,FIXED y) ;
      extern  void    slZoomR(FIXED x,FIXED y) ;
+     extern  void    slScrScaleNbg0(FIXED x,FIXED y) ;
+     extern  void    slScrScaleNbg1(FIXED x,FIXED y) ;
+     extern  void    slScrScaleR(FIXED x,FIXED y) ;
      extern  void    slZoomMode(Uint16 , Uint16) ;
  #define		slZoomModeNbg0(mode)	slZoomMode(scnNBG0 , mode)
  #define		slZoomModeNbg1(mode)	slZoomMode(scnNBG1 , mode)
***************
*** 863,869 ****
      extern  void    slSpriteCCalcNum(Uint16) ;
      extern  void    slSpriteColMode(Uint16) ;
      extern  void    slSpriteWinMode(Uint16) ;
! 	extern  void    slSpriteType(Uint16) ;
      extern  void    slScrMosaicOn(Uint16) ;
      extern  void    slScrMosSize(Uint16 , Uint16) ;
      extern  void    slScrWindow0(Uint16 , Uint16 , Uint16 , Uint16) ;
--- 1058,1064 ----
      extern  void    slSpriteCCalcNum(Uint16) ;
      extern  void    slSpriteColMode(Uint16) ;
      extern  void    slSpriteWinMode(Uint16) ;
!     extern  void    slSpriteType(Uint16) ;
      extern  void    slScrMosaicOn(Uint16) ;
      extern  void    slScrMosSize(Uint16 , Uint16) ;
      extern  void    slScrWindow0(Uint16 , Uint16 , Uint16 , Uint16) ;
***************
*** 939,948 ****
  #define		slSpecialCCalcBitBMN0(flag)	slSpecialCCalcBitN01(scnNBG0 , flag)
  #define		slSpecialCCalcBitBMN1(flag)	slSpecialCCalcBitN01(scnNBG1 , flag)
  #define		slSpecialCCalcBitBMR0(flag)	slSpecialCCalcBitRbg0(flag)
!     extern  void    setASC_1to8(Uint8 * , Uint16 * , Uint32 , Uint8) ;
!     extern  void    setASC_4to8(Uint8 * , Uint16 * , Uint32 , Uint8) ;
      extern  Uint8   SGL_ASCII_CG[] ;
  
  /*  Peripheral control */
  
  #define	SMPC_MASK_STE		0x80	/* ＳＥＴＴＩＭＥ実行済マスク		*/
--- 1134,1223 ----
  #define		slSpecialCCalcBitBMN0(flag)	slSpecialCCalcBitN01(scnNBG0 , flag)
  #define		slSpecialCCalcBitBMN1(flag)	slSpecialCCalcBitN01(scnNBG1 , flag)
  #define		slSpecialCCalcBitBMR0(flag)	slSpecialCCalcBitRbg0(flag)
!     extern  void    setASC_1to8(Uint8 * , void * , Uint32 , Uint8) ;
!     extern  void    setASC_4to8(Uint8 * , void * , Uint32 , Uint8) ;
!     extern  void    setASC_1to4(Uint8 * , void * , Uint32 , Uint8 , Sint32) ;
      extern  Uint8   SGL_ASCII_CG[] ;
  
+ /*  BitMap graphics library */
+ 
+     extern  Bool    slInitBitMap(Uint16 , Uint16 , void*) ;
+ #define         slInitBitMapNbg0(sz,adr)        slInitBitMap(bmNBG0,sz,adr)
+ #define         slInitBitMapNbg1(sz,adr)        slInitBitMap(bmNBG1,sz,adr)
+ #define         slInitBitMapRbg0(sz,adr)        slInitBitMap(bmRBG0,sz,adr)
+     extern  void    slBitMapBase(Sint16 , Sint16) ;
+     extern  Sint8  *slLocateBitMap(Sint16 , Sint16) ;
+     extern  void    slClearBitMap(Sint8) ;
+     extern  Bool    slBMPset(Sint16 , Sint16 , Sint8) ;
+     extern  Sint8   slBMPoint(Sint16 , Sint16) ;
+     extern  void    slBMCircle(Sint16 , Sint16 , Sint16 , Sint8) ;
+     extern  Bool    slBMLine(Sint16 , Sint16 , Sint16 , Sint16 , Sint8) ;
+     extern  Bool    slBMBox(Sint16 , Sint16 , Sint16 , Sint16 , Sint8) ;
+     extern  Bool    slBMBoxFill(Sint16 , Sint16 , Sint16 , Sint16 , Sint8) ;
+     extern  Bool    slBMGet(Sint16 , Sint16 , Sint16 , Sint16 , Sint8*) ;
+     extern  Bool    slBMPut(Sint16 , Sint16 , Sint16 , Sint16 , Sint8*) ;
+     extern  Bool    slBMSprPut(Sint16 , Sint16 , Sint16 , Sint16 , Sint8*) ;
+ 
+ #ifdef ST_VE
+ /*  Graphics enhancer control */
+ 
+     extern  Bool gxInitEnhancer(Uint16 , Uint16 , Uint16) ;
+ #define	    EGX_IMMPAL		0	/* パレット直接 */
+ #define	    EGX_PAL15		1	/* パレット間接 １５ビットカラー */
+ #define	    EGX_PAL24		2	/* パレット間接 ２４ビットカラー */
+ #define	    EGX_PAL_RGB15	3	/* パレット、ＲＧＢ混在 １５ビットカラー */
+ #define	    EGX_PAL_RGB24	4	/* パレット、ＲＧＢ混在 ２４ビットカラー */
+ 
+ #define	    USE_EXVDP1		0
+ #define	    USE_DSPDMA		1
+ 
+     extern  void gxFocus(FIXED , FIXED) ;
+     extern  void gxCalcMode(Uint16) ;
+ #define	    CALCNVECTOR		1	/* 法線再計算 */
+ #define	    USENVECTOR		0	/* 法線使用 */
+ 
+ #define	    NOSHADE		2	/* シェーディングなし */
+ #define	    FLAT		4	/* フラットシェーディング */
+ #define	    GOURAUD		8	/* グーローシェーディング */
+ 
+     extern  void gxSetMaterial(Uint16 , Uint16 , Uint16 , Uint16 , Uint16) ;
+ 
+ #define	    EFUNC_LoadTrans	0x0c0c0c0c
+ #define	    EFUNC_FlashMatrix	0x10101010
+ #define	    EFUNC_BaseMatrix	0x11111111
+ #define	    EFUNC_PushMatrix	0x12121212
+ #define	    EFUNC_PopMatrix	0x13131313
+ #define	    EFUNE_Translate	0x14141414
+ #define	    EFUNE_Scale		0x15151515
+ #define	    EFUNE_RotX		0x16161616
+ #define	    EFUNE_RotY		0x17171717
+ #define	    EFUNE_RotZ		0x18181818
+ #define	    EFUNE_MultiMatrix	0x19191919
+ #define	    EFUNC_RotLight	0x1a1a1a1a
+ 
+     extern  void gxFuncOut(Uint32) ;
+     extern  void gxFuncOut2(Uint32 , Uint32) ;
+     extern  void gxFuncOut3(Uint32 , Uint32 , Uint32 , Uint32) ;
+ #define	    gxFlashMatrix()	gxFuncOut(EFUNC_FlashMatrix)
+ #define	    gxBaseMatrix()	gxFuncOut(EFUNC_BaseMatrix)
+ #define	    gxPushMatrix()	gxFuncOut(EFUNC_PushMatrix)
+ #define	    gxPopMatrix()	gxFuncOut(EFUNC_PopMatrix)
+ #define	    gxRotLight()	gxFuncOut(EFUNC_RotLight)
+ 
+ #define	    gxLoadTrans(x,y,z)	gxFuncOut3(EFUNC_LoadTrans , x , y , z)
+ #define	    gxTranslate(x,y,z)	gxFuncOut3(EFUNC_Translate , x , y , z)
+ #define	    gxScale(x,y,z)	gxFuncOut3(EFUNC_Scale , x , y , z)
+ #define	    gxRotX(ax)		gxFuncOut2(EFUNC_RotX , ax)
+ #define	    gxRotY(ay)		gxFuncOut2(EFUNC_RotY , ay)
+ #define	    gxRotZ(az)		gxFuncOut2(EFUNC_RotZ , az)
+ 
+     extern  void gxMatrixOut(Uint32 , MATRIX) ;
+ #define	    gxLoadMatrix(mtrx)	gxMatrixOut(EFUNC_LoadMatrix , mtrx)
+ #define	    gxMultiMatrix(mtrx)	gxMatrixOut(EFUNC_MultiMatrix , mtrx)
+ 
+     extern  void gxPutPolygon(gxPDATA*) ;
+ #endif
+ 
  /*  Peripheral control */
  
  #define	SMPC_MASK_STE		0x80	/* ＳＥＴＴＩＭＥ実行済マスク		*/
***************
*** 971,976 ****
--- 1246,1252 ----
  #define	PER_ID_StnLacing	0x13	/* サターンレーシングコントローラー	*/
  #define	PER_ID_StnAnalog	0x15	/* サターンアナログジョイスティック	*/
  #define	PER_ID_StnMouse		0x23	/* サターンマウス			*/
+ #define	PER_ID_StnShooting	0x25	/* サターンシューティングコントローラー */
  #define	PER_ID_StnKeyBoard	0x34	/* サターンキーボード			*/
  #define	PER_ID_MD3BtnPad	0xe1	/* メガドライブ３ボタンパッド		*/
  #define	PER_ID_MD6BtnPad	0xe2	/* メガドライブ６ボタンパッド		*/
***************
*** 1235,1245 ****
  extern	PerDigital*	Smpc_Peripheral;
  extern	Uint8		Per_Connect1, Per_Connect2;
  
  #define	slMasterOn()			slRequestCommand(SMPC_MSHON , SMPC_NO_WAIT)
  #define	slSlaveOn()			slRequestCommand(SMPC_SSHON , SMPC_NO_WAIT)
  #define	slSlaveOff()			slRequestCommand(SMPC_SSHOFF, SMPC_NO_WAIT)
! #define	slSoundOn()			slRequestCommand(SMPC_SNDON , SMPC_NO_WAIT)
! #define	slSoundOff()			slRequestCommand(SMPC_SNDOFF, SMPC_NO_WAIT)
  #define	slCDOn()			slRequestCommand(SMPC_CDON  , SMPC_NO_WAIT)
  #define	slCDOff()			slRequestCommand(SMPC_CDOFF , SMPC_NO_WAIT)
  #define	slSystemReset()			slRequestCommand(SMPC_SYSRES, SMPC_NO_WAIT)
--- 1511,1556 ----
  extern	PerDigital*	Smpc_Peripheral;
  extern	Uint8		Per_Connect1, Per_Connect2;
  
+ #ifdef  TITAN
+ typedef struct {                        /* System Switch */
+         Uint8   dummy ;
+         Uint8   data ;
+         Uint8   push ;
+         Uint8   pull ;
+ } SysSwitch ;
+ 
+     extern  PerDigital  PerDigitalBuf[4] ;
+     extern  SysSwitch   SystemSwitchBuf ;
+ 
+ #define     _ServiceSw          0x80    /* 基盤上のスイッチとＪＡＭＭＡ入力の ＯＲしたもの */
+ #define     _TestSw             0x40
+ #define     _ServiceSwBD        0x20    /* 基盤上のタクトスイッチ */
+ #define     _TestSwBD           0x10
+ #define     _ServiceSwJM        0x08    /* ＪＡＭＭＡコネクタからのスイッチ入力 */
+ #define     _TestSwJM           0x04
+ #define     _Coin2              0x02
+ #define     _Coin1              0x01
+ #endif
+ 
+ #ifdef  ST_V
+     extern  PerDigital	PerDigitalBuf[4] ;
+ #endif
+ #ifdef  ST_VE
+     extern  PerDigital	PerDigitalBuf[4] ;
+ #endif
+ 
  #define	slMasterOn()			slRequestCommand(SMPC_MSHON , SMPC_NO_WAIT)
  #define	slSlaveOn()			slRequestCommand(SMPC_SSHON , SMPC_NO_WAIT)
  #define	slSlaveOff()			slRequestCommand(SMPC_SSHOFF, SMPC_NO_WAIT)
! 
! #ifdef TITAN
!     extern void slSoundOn() ;
!     extern void slSoundOff() ;
! #else
! #define	slSoundOn()		slRequestCommand(SMPC_SNDON , SMPC_NO_WAIT)
! #define	slSoundOff()		slRequestCommand(SMPC_SNDOFF, SMPC_NO_WAIT)
! #endif
! 
  #define	slCDOn()			slRequestCommand(SMPC_CDON  , SMPC_NO_WAIT)
  #define	slCDOff()			slRequestCommand(SMPC_CDOFF , SMPC_NO_WAIT)
  #define	slSystemReset()			slRequestCommand(SMPC_SYSRES, SMPC_NO_WAIT)
***************
*** 1289,1299 ****
      extern void    slSlaveFunc(void (*func)() , void *) ;
  
  /*  System library */
!     extern  void   slInitSystem(Uint16 , TEXTURE * , Uint16) ;
      extern  void   slSynch(void) ;
      extern  void   slInitSynch(void) ;
      extern  Bool   slTransferEntry(void * , void * , Uint16) ;
      extern  void   slIntFunction(void (*func)()) ;
      extern  void   SetCDFunc(void (*func)()) ;
      extern  void   slSetTrayCheck(Uint8) ;
      extern  void   slCashPurge() ;
--- 1600,1615 ----
      extern void    slSlaveFunc(void (*func)() , void *) ;
  
  /*  System library */
!     extern  void   slInitSystem(Uint16 , TEXTURE * , Sint8) ;
!     extern  void   slSetTVMode(Uint16) ;
!     extern  void   slSetScrTVMode(Uint16) ;
!     extern  void   slSetSprTVMode(Uint16) ;
!     extern  Bool   slDynamicFrame(Uint16) ;
      extern  void   slSynch(void) ;
      extern  void   slInitSynch(void) ;
      extern  Bool   slTransferEntry(void * , void * , Uint16) ;
      extern  void   slIntFunction(void (*func)()) ;
+     extern  void   slSynchFunction(void (*func)()) ;
      extern  void   SetCDFunc(void (*func)()) ;
      extern  void   slSetTrayCheck(Uint8) ;
      extern  void   slCashPurge() ;
***************
*** 1306,1312 ****
      extern  Bool   slBGMOff() ;
      extern  Bool   slBGMFade(Uint8 , Uint8) ;
      extern  Bool   slBGMTempo(Sint16) ;
! #define	    slBGMStat()		slSequenceStat(0)
      extern  Bool   slSoundAllOff() ;
      extern  Bool   slSoundAllPause() ;
      extern  Bool   slSoundAllCont() ;
--- 1622,1628 ----
      extern  Bool   slBGMOff() ;
      extern  Bool   slBGMFade(Uint8 , Uint8) ;
      extern  Bool   slBGMTempo(Sint16) ;
! #define     slBGMStat()    slSequenceStat(0)
      extern  Bool   slSoundAllOff() ;
      extern  Bool   slSoundAllPause() ;
      extern  Bool   slSoundAllCont() ;
***************
*** 1325,1345 ****
      extern  void   slWaitSound(void *) ;
      extern  Bool   slCDDAOn(Uint8 , Uint8 , Sint8 , Sint8) ;
      extern  Bool   slCDDAOff() ;
!     extern  Uint8  slPCMOn(PCM * , void * , Uint32) ;
      extern  Bool   slPCMOff(PCM *) ;
      extern  Bool   slPCMParmChange(PCM *) ;
      extern  Bool   slPCMStat(PCM *) ;
!     extern  Uint8  slSndPCMNum() ;
      extern  Uint8  slSndSeqNum() ;
      extern  Bool   slSndEffect(Uint8) ;
      extern  Bool   slSndMixChange(Uint8 , Uint8) ;
      extern  Bool   slSndMixParmChange(Uint8 , Uint8 , Sint8) ;
      extern  Sint8  slSoundRequest(const char*,...) ;
  
!     extern  Uint8  sddrv_129i[] ;
!     extern  Uint32 sizeof_129i ;
  
  /*------------------------------------------------------------------------*/
  
! #endif  /* SL_DEF_H */
! 
\ No newline at end of file
--- 1641,1678 ----
      extern  void   slWaitSound(void *) ;
      extern  Bool   slCDDAOn(Uint8 , Uint8 , Sint8 , Sint8) ;
      extern  Bool   slCDDAOff() ;
!     extern  Sint8  slPCMOn(PCM * , void * , Uint32) ;
      extern  Bool   slPCMOff(PCM *) ;
      extern  Bool   slPCMParmChange(PCM *) ;
      extern  Bool   slPCMStat(PCM *) ;
!     extern  Sint8  slSndPCMNum() ;
      extern  Uint8  slSndSeqNum() ;
      extern  Bool   slSndEffect(Uint8) ;
      extern  Bool   slSndMixChange(Uint8 , Uint8) ;
      extern  Bool   slSndMixParmChange(Uint8 , Uint8 , Sint8) ;
      extern  Sint8  slSoundRequest(const char*,...) ;
+     extern  void   slSndFlush() ;
+ 
+ /*  Gouraud library */
+ 
+     typedef Uint16 GOURAUDTBL[4];
+ 
+     extern  void slInitGouraud( GOURAUDTBL *, Uint32, Uint32, Uint8 *);
+     extern  void slPutPolygonX( XPDATA *, FIXED *);
+     extern  void slGouraudTblCopy(void);
+     extern  void slSetGouraudTbl( Uint16 *);
+     extern  void slSetGouraudColor( Uint16 );
+     extern  void slSetAmbient( Uint16);
+ 
+     extern  void slSetFlatColor( Uint16);
+ 
+     extern  void slSetDepthLimit( Uint32, Uint16, Uint16 );
+     extern  void slSetDepthTbl( Uint16 *, Uint16, Uint16 );
  
!     extern  void slNearClipFlag( Uint32 );
!     extern  void slDispPlaneLevel( Sint32 );
!     extern  void slWindowClipLevel( Sint32 );
  
  /*------------------------------------------------------------------------*/
  
! #endif
diff -crB --binary sbl6/segalib/int/int.c sbl6_patch/segalib/int/int.c
*** sbl6/segalib/int/int.c	1996-02-08 05:23:54.000000000 -0500
--- sbl6_patch/segalib/int/int.c	2021-12-28 19:46:12.000000000 -0500
***************
*** 537,540 ****
  interrupt_t	INT_GetScuFunc( int	n ){
  	return	__interrupt_vector[n];
  }
! 
\ No newline at end of file
--- 537,540 ----
  interrupt_t	INT_GetScuFunc( int	n ){
  	return	__interrupt_vector[n];
  }
! 
diff -crB --binary sbl6/segalib/mth/mth_dsp.c sbl6_patch/segalib/mth/mth_dsp.c
*** sbl6/segalib/mth/mth_dsp.c	1996-02-08 05:25:02.000000000 -0500
--- sbl6_patch/segalib/mth/mth_dsp.c	2021-11-14 20:09:08.000000000 -0500
***************
*** 15,20 ****
--- 15,24 ----
   */
  
  /*
+  * C STANDARD LIBRARY FUNCTIONS/MACROS DEFINES
+  */
+ #include <string.h>
+ /*
   * USER SUPPLIED INCLUDE FILES
   */
  #include "sega_mth.h"
***************
*** 160,163 ****
  }
  
  /*  end of file */
! 
\ No newline at end of file
--- 164,167 ----
  }
  
  /*  end of file */
! 
Only in sbl6_patch/segalib/mth: mth_fixd.s
Only in sbl6_patch/segalib/mth: mth_mtrx.s
Only in sbl6_patch/segalib/mth: mth_norm.s
Only in sbl6_patch/segalib/mth: mth_ps2d.s
Only in sbl6_patch/segalib/mth: mth_tri.s
diff -crB --binary sbl6/segalib/scl/scl_fu03.c sbl6_patch/segalib/scl/scl_fu03.c
*** sbl6/segalib/scl/scl_fu03.c	1995-09-29 10:38:48.000000000 -0400
--- sbl6_patch/segalib/scl/scl_fu03.c	2022-01-17 19:53:04.000000000 -0500
***************
*** 417,422 ****
--- 417,424 ----
  
  		    }
  		    break;
+ 		default:
+ 			exit(0);
  	}
  /*
   *	Set Map Address
***************
*** 475,478 ****
  	}
  	if(SclProcess == 0)	SclProcess = 1;
  }
! 
\ No newline at end of file
--- 477,480 ----
  	}
  	if(SclProcess == 0)	SclProcess = 1;
  }
! 
diff -crB --binary sbl6/segalib/scl/scl_func.c sbl6_patch/segalib/scl/scl_func.c
*** sbl6/segalib/scl/scl_func.c	1996-04-01 07:31:58.000000000 -0500
--- sbl6_patch/segalib/scl/scl_func.c	2021-11-17 07:35:52.000000000 -0500
***************
*** 22,29 ****
  
  #include <sega_scl.h> 
  #include <sega_dma.h> 
! #include	<sgl_work.h>
! #include	<sgl.h>
  
  #define	DMAOFF
  
--- 22,29 ----
  
  #include <sega_scl.h> 
  #include <sega_dma.h> 
! //#include	<sgl_work.h>
! //#include	<sgl.h>
  
  #define	DMAOFF
  
***************
*** 53,59 ****
  	SclNorscl	Scl_n_reg;
  	SclRotscl	Scl_r_reg;
  	SclWinscl	Scl_w_reg;
! 	SclSblSgl	Scl_flag;
  
  /* このファイルが参照する大域変数の宣言 */
  extern	SclPriBuffDirtyFlags	SclPriBuffDirty;
--- 53,59 ----
  	SclNorscl	Scl_n_reg;
  	SclRotscl	Scl_r_reg;
  	SclWinscl	Scl_w_reg;
! 	//SclSblSgl	Scl_flag;
  
  /* このファイルが参照する大域変数の宣言 */
  extern	SclPriBuffDirtyFlags	SclPriBuffDirty;
***************
*** 102,109 ****
  	void	SCL_ScrollShow(void);
  	void	SCL_PriIntProc(void);
  	void	SCL_Memcpyw(void *dest,void *src,Uint32 tcnt);
! 	void	SCL_SglOn(void);		/*	use SGL	*/
! 	void	SCL_SglOff(void);		/*	use SGL	*/
  
  extern	void   SCL_Rotate(Fixed32 xy,Fixed32 z,Fixed32 disp);
  
--- 102,109 ----
  	void	SCL_ScrollShow(void);
  	void	SCL_PriIntProc(void);
  	void	SCL_Memcpyw(void *dest,void *src,Uint32 tcnt);
! 	//void	SCL_SglOn(void);		/*	use SGL	*/
! 	//void	SCL_SglOff(void);		/*	use SGL	*/
  
  extern	void   SCL_Rotate(Fixed32 xy,Fixed32 z,Fixed32 disp);
  
***************
*** 828,840 ****
  
  }
  
! void SCL_SglOn(void){
  	SclRotregBuff = ( SclRotreg * )RotScrParA;
  	Scl_flag.sgl_flag=0x0001;
! }
  
! void SCL_SglOff(void){
  	Scl_flag.sgl_flag=0x0000;
  	SclRotregBuff = _SclRotregBuff;
! }
  
--- 828,840 ----
  
  }
  
! /*void SCL_SglOn(void){
  	SclRotregBuff = ( SclRotreg * )RotScrParA;
  	Scl_flag.sgl_flag=0x0001;
! }*/
  
! /*void SCL_SglOff(void){
  	Scl_flag.sgl_flag=0x0000;
  	SclRotregBuff = _SclRotregBuff;
! }*/
  
diff -crB --binary sbl6/segalib/scl/scl_pr03.c sbl6_patch/segalib/scl/scl_pr03.c
*** sbl6/segalib/scl/scl_pr03.c	1995-08-30 22:00:00.000000000 -0400
--- sbl6_patch/segalib/scl/scl_pr03.c	2022-01-17 19:59:22.000000000 -0500
***************
*** 83,92 ****
  		}
  	}else{
  		for(i=0;i<Max256;i++)
! 			if(SclColRamAlloc256[i] != 0) return((Uint32 )NULL);
  		SclColRamAlloc2048[0] = Surface;
  		SCL_SetColRamOffset(Surface,0,transparent);
  		return(SCL_COLRAM_ADDR);
  	}
  }
! 
\ No newline at end of file
--- 83,92 ----
  		}
  	}else{
  		for(i=0;i<Max256;i++)
! 			if(SclColRamAlloc256[i] != 0) return(0);
  		SclColRamAlloc2048[0] = Surface;
  		SCL_SetColRamOffset(Surface,0,transparent);
  		return(SCL_COLRAM_ADDR);
  	}
  }
! 
diff -crB --binary sbl6/segalib/snd/snd_main.c sbl6_patch/segalib/snd/snd_main.c
*** sbl6/segalib/snd/snd_main.c	1996-07-09 21:08:00.000000000 -0400
--- sbl6_patch/segalib/snd/snd_main.c	2022-01-17 19:57:36.000000000 -0500
***************
*** 355,361 ****
  
  void SND_MoveData(Uint16 *source, Uint32 size,Uint16 data_kind, Uint16 data_no)
  {
!     void *adr;                                  /* 転送先アドレス            */
      Uint32 *load_mark_adr;                      /* 転送済みビット設定ｱﾄﾞﾚｽ  */
  
      GetSndMapInfo(&adr, &load_mark_adr, data_kind, data_no);
--- 355,361 ----
  
  void SND_MoveData(Uint16 *source, Uint32 size,Uint16 data_kind, Uint16 data_no)
  {
!     void *adr = NULL;                           /* 転送先アドレス            */
      Uint32 *load_mark_adr;                      /* 転送済みビット設定ｱﾄﾞﾚｽ  */
  
      GetSndMapInfo(&adr, &load_mark_adr, data_kind, data_no);
***************
*** 1686,1689 ****
  	HOST_SET_RETURN(SND_RET_SET);
  }
  
! 
\ No newline at end of file
--- 1686,1689 ----
  	HOST_SET_RETURN(SND_RET_SET);
  }
  
! 
diff -crB --binary sbl6/segalib/stm/stm_init.c sbl6_patch/segalib/stm/stm_init.c
*** sbl6/segalib/stm/stm_init.c	1996-02-08 05:25:46.000000000 -0500
--- sbl6_patch/segalib/stm/stm_init.c	2022-01-17 20:03:48.000000000 -0500
***************
*** 667,673 ****
  void    STM_CloseGrp(StmGrpHn grp)
  {
      StmHn               stm;
!     Bool                close_flag = TRUE;
  
      STMERR_SetFunc(STM_CLOSEGRP);
      if (grp == NULL) {
--- 667,673 ----
  void    STM_CloseGrp(StmGrpHn grp)
  {
      StmHn               stm;
! //    Bool                close_flag = TRUE;
  
      STMERR_SetFunc(STM_CLOSEGRP);
      if (grp == NULL) {
diff -crB --binary sbl6/segalib/stm/stm_svr.c sbl6_patch/segalib/stm/stm_svr.c
*** sbl6/segalib/stm/stm_svr.c	1996-02-08 05:25:48.000000000 -0500
--- sbl6_patch/segalib/stm/stm_svr.c	2022-01-17 20:06:06.000000000 -0500
***************
*** 913,919 ****
      Sint32      nsct;
      Sint32      sfad, efad;
      Sint32      trfad;
!     Bool        req;
      Bool        complete = TRUE;
      Bool        set = FALSE;
      Uint8       atr;
--- 913,919 ----
      Sint32      nsct;
      Sint32      sfad, efad;
      Sint32      trfad;
! //    Bool        req;
      Bool        complete = TRUE;
      Bool        set = FALSE;
      Uint8       atr;
***************
*** 1022,1028 ****
   *************************************************/
  STM_LOCAL Bool  stm_trans(StmGrpHn grp, Uint8 cdstat)
  {
!     StmHn       stm, first;
      Sint32      stat;
      Bool        bflag;
      Bool        ret;
--- 1022,1029 ----
   *************************************************/
  STM_LOCAL Bool  stm_trans(StmGrpHn grp, Uint8 cdstat)
  {
! //    StmHn       stm;
!     StmHn	first;
      Sint32      stat;
      Bool        bflag;
      Bool        ret;
***************
*** 1036,1042 ****
      /* 各ストリームを１度づつ実行を試みる       */
      /* 転送中または１周まわったらおわり         */
      do {
!         stm = STM_GRP_NEXTTRNS(grp);
          ret = stm_trans_sub(grp, first, cdstat, &bflag, &stat);
      } while(bflag == FALSE);
  
--- 1037,1043 ----
      /* 各ストリームを１度づつ実行を試みる       */
      /* 転送中または１周まわったらおわり         */
      do {
!         /*stm = */STM_GRP_NEXTTRNS(grp);
          ret = stm_trans_sub(grp, first, cdstat, &bflag, &stat);
      } while(bflag == FALSE);
  
***************
*** 1076,1082 ****
      Sint32      ret;
      Bool        read, trans;
      Bool        complete;
!     Sint32      hirq;
      Sint32      stat;
  
      /* 処理中のタスクがある場合 */
--- 1077,1083 ----
      Sint32      ret;
      Bool        read, trans;
      Bool        complete;
! //    Sint32      hirq;
      Sint32      stat;
  
      /* 処理中のタスクがある場合 */
***************
*** 1222,1228 ****
      Sint32      nsct;
      Sint32      stat;
      Sint32      sfad, efad;
!     Uint16      hirq;
  
      STMERR_SetFunc(STM_ISCOMPLETE);
      if (stm == NULL) {
--- 1223,1229 ----
      Sint32      nsct;
      Sint32      stat;
      Sint32      sfad, efad;
! //    Uint16      hirq;
  
      STMERR_SetFunc(STM_ISCOMPLETE);
      if (stm == NULL) {
***************
*** 1255,1261 ****
   *************************************************/
  Bool    STM_ExecTrans(StmHn stm)
  {
!     GfsHn       gfs;
      Sint32      tsct;
      GftrHn      gftr;
      Bool        trans;
--- 1256,1262 ----
   *************************************************/
  Bool    STM_ExecTrans(StmHn stm)
  {
! //    GfsHn       gfs;
      Sint32      tsct;
      GftrHn      gftr;
      Bool        trans;
diff -crB --binary sbl6/segalib/stm/stm_trn.c sbl6_patch/segalib/stm/stm_trn.c
*** sbl6/segalib/stm/stm_trn.c	1996-02-08 05:25:48.000000000 -0500
--- sbl6_patch/segalib/stm/stm_trn.c	2022-01-17 20:03:02.000000000 -0500
***************
*** 142,148 ****
  
  void    STM_SetTrBuf(StmHn stm, void *buffer, Sint32 nunit, Sint32 unitsize)
  {
!     Sint32      bufsize;
  
      STMERR_SetFunc(STM_SETTRBUF);
      if (stm == NULL) {
--- 142,148 ----
  
  void    STM_SetTrBuf(StmHn stm, void *buffer, Sint32 nunit, Sint32 unitsize)
  {
! //    Sint32      bufsize;
  
      STMERR_SetFunc(STM_SETTRBUF);
      if (stm == NULL) {
***************
*** 190,197 ****
  
  void    STM_ResetTrBuf(StmHn stm)
  {
!     Uint8       *data;
!     Sint32      bsize;
  
      STMERR_SetFunc(STM_RESETTRBUF);
      if (stm == NULL) {
--- 190,197 ----
  
  void    STM_ResetTrBuf(StmHn stm)
  {
! //    Uint8       *data;
! //    Sint32      bsize;
  
      STMERR_SetFunc(STM_RESETTRBUF);
      if (stm == NULL) {
diff -crB --binary sbl6/segasmp/bup/font/fnt_cod1.c sbl6_patch/segasmp/bup/font/fnt_cod1.c
*** sbl6/segasmp/bup/font/fnt_cod1.c	1996-02-08 05:26:36.000000000 -0500
--- sbl6_patch/segasmp/bup/font/fnt_cod1.c	2021-12-18 11:44:08.000000000 -0500
***************
*** 1,3 ****
--- 1,5 ----
+ #include <string.h>
+ 
  #include	<sega_xpt.h>
  
  #define		FNT_JAPAN	1
***************
*** 89,95 ****
  #ifndef __GNUC__
  	if(wx > FntXsize)	wx = FntXsize/2 - strlen(str)*4;
  #else
! 	if(wx > FntXsize)	wx = FntXsize/2 - strlen((Uint8 *)str)*4;
  #endif
  
  	i=0;
--- 91,97 ----
  #ifndef __GNUC__
  	if(wx > FntXsize)	wx = FntXsize/2 - strlen(str)*4;
  #else
! 	if(wx > FntXsize)	wx = FntXsize/2 - strlen((const char *)str)*4;
  #endif
  
  	i=0;
***************
*** 118,121 ****
  		i++;
  	}
  }
! 
\ No newline at end of file
--- 120,123 ----
  		i++;
  	}
  }
! 
diff -crB --binary sbl6/segasmp/bup/smpbup1.c sbl6_patch/segasmp/bup/smpbup1.c
*** sbl6/segasmp/bup/smpbup1.c	1996-02-08 05:26:38.000000000 -0500
--- sbl6_patch/segasmp/bup/smpbup1.c	2021-12-18 11:31:22.000000000 -0500
***************
*** 20,27 ****
  #include	"sega_scl.h"
  #include	"sega_per.h"
  #include	"sega_bup.h"
! #include	"..\v_blank\v_blank.h"
! #include	"font\smp_font.h"
  
  #define 	BUP_START_ADDR	0x6070000
  
--- 20,27 ----
  #include	"sega_scl.h"
  #include	"sega_per.h"
  #include	"sega_bup.h"
! #include	"v_blank/v_blank.h"
! #include	"font/smp_font.h"
  
  #define 	BUP_START_ADDR	0x6070000
  
***************
*** 73,79 ****
  	"SAT"
  };
  
! void main(void)
  {
  /* #if !(__GNUC__) */
  #ifndef __GNUC__
--- 73,79 ----
  	"SAT"
  };
  
! int main(void)
  {
  /* #if !(__GNUC__) */
  #ifndef __GNUC__
***************
*** 433,438 ****
--- 433,440 ----
  			PadInputWait();
  			break;
  	}
+ 
+ 	return 0;
  }
  
  
***************
*** 865,868 ****
  
  	return(ret);
  }
! 
\ No newline at end of file
--- 867,870 ----
  
  	return(ret);
  }
! 
diff -crB --binary sbl6/segasmp/csh/smpcsh.c sbl6_patch/segasmp/csh/smpcsh.c
*** sbl6/segasmp/csh/smpcsh.c	1996-02-08 05:28:00.000000000 -0500
--- sbl6_patch/segasmp/csh/smpcsh.c	2021-12-18 11:30:38.000000000 -0500
***************
*** 1,13 ****
  #include "sega_xpt.h"
  #include "sega_csh.h"
  
! void main(void)
  {
  	CSH_Init(CSH_4WAY);
  	CSH_AllClr();
! 	CSH_Purge((volatile void *)0x06000008, (Uint32)0x10);
  
  	while(1)
  		;
  }
! 
\ No newline at end of file
--- 1,14 ----
  #include "sega_xpt.h"
  #include "sega_csh.h"
  
! int main(void)
  {
  	CSH_Init(CSH_4WAY);
  	CSH_AllClr();
! 	CSH_Purge((void *)0x06000008, (Uint32)0x10);
  
  	while(1)
  		;
+ 	return 0;
  }
! 
diff -crB --binary sbl6/segasmp/dbg/smpdbg1/smpdbg10.c sbl6_patch/segasmp/dbg/smpdbg1/smpdbg10.c
*** sbl6/segasmp/dbg/smpdbg1/smpdbg10.c	1996-02-08 05:28:04.000000000 -0500
--- sbl6_patch/segasmp/dbg/smpdbg1/smpdbg10.c	2022-09-17 20:33:48.000000000 -0400
***************
*** 12,17 ****
--- 12,18 ----
  
  #include	<stdio.h>
  #include	<stdlib.h>
+ #include	<string.h>
  #include	<machine.h>
  
  #define		_SPR2_
***************
*** 322,328 ****
  extern Uint16	PadData1;
  #endif
  
! void main()
  {
      Uint8  *VRAM;
      int    i, j, l;
--- 323,329 ----
  extern Uint16	PadData1;
  #endif
  
! int main(void)
  {
      Uint8  *VRAM;
      int    i, j, l;
***************
*** 378,384 ****
          if(val == 99)
              *(Uint32*)0x6000001 = val; /* cause program error */
      }
  }
  
  /*  end of file */
! 
\ No newline at end of file
--- 379,386 ----
          if(val == 99)
              *(Uint32*)0x6000001 = val; /* cause program error */
      }
+     return 0;
  }
  
  /*  end of file */
! 
diff -crB --binary sbl6/segasmp/dma/smpdma0/smpdma0.c sbl6_patch/segasmp/dma/smpdma0/smpdma0.c
*** sbl6/segasmp/dma/smpdma0/smpdma0.c	1996-02-08 05:28:08.000000000 -0500
--- sbl6_patch/segasmp/dma/smpdma0/smpdma0.c	2021-12-18 11:46:30.000000000 -0500
***************
*** 16,25 ****
  void SDMA_CpuAllStart(void);
  void SDMA_CpuCst(Uint32 , Uint32 ,void *, void *, Uint32);
  Uint32 SDMA_CpuResult(Uint32);
! Uint32 hikaku(void *, void *, Uint32, Uint32, Sint8 *); /*  結果確認関数    */
  void rev(void *, void *, Uint32, Uint32);   /*  転送先データ破壊関数        */
  
! void main(void)
  {
      void *src, *dst;
      Uint32 cnt;
--- 16,25 ----
  void SDMA_CpuAllStart(void);
  void SDMA_CpuCst(Uint32 , Uint32 ,void *, void *, Uint32);
  Uint32 SDMA_CpuResult(Uint32);
! Uint32 hikaku(void *, void *, Uint32, Uint32, char *); /*  結果確認関数    */
  void rev(void *, void *, Uint32, Uint32);   /*  転送先データ破壊関数        */
  
! int main(void)
  {
      void *src, *dst;
      Uint32 cnt;
***************
*** 55,60 ****
--- 55,62 ----
      hikaku((void *)0x00000, (void *)0x6050000, 0x400, 1, "BOOT to WORK");
  
      for(;;);
+     
+     return 0;
  }
  /****************************************************************************/
  /*  全チャネルDMA開始                                                       */
***************
*** 140,146 ****
  /****************************************************************************/
  /*  結果比較関数                                                            */
  /****************************************************************************/
! Uint32 hikaku(void *src, void *dst, Uint32 cnt, Uint32 size, Sint8 *msg)
  {
  #if	0
  	/*
--- 142,148 ----
  /****************************************************************************/
  /*  結果比較関数                                                            */
  /****************************************************************************/
! Uint32 hikaku(void *src, void *dst, Uint32 cnt, Uint32 size, char *msg)
  {
  #if	0
  	/*
***************
*** 162,168 ****
      sprintf(pbuf, "[[ \'%s\' %08X >> %08X : %08X Count, %01X Byte ",
       msg, src, dst, cnt, size);
  #else
!     sprintf(pbuf, "[[ \'%s\' %08lX >> %08lX : %08lX Count, %01lX Byte ",
       msg, ( Uint32 )src, ( Uint32 )dst, cnt, size);
  #endif
      pbuf += strlen(pbuf);
--- 164,170 ----
      sprintf(pbuf, "[[ \'%s\' %08X >> %08X : %08X Count, %01X Byte ",
       msg, src, dst, cnt, size);
  #else
!     sprintf((const char *)pbuf, "[[ \'%s\' %08lX >> %08lX : %08lX Count, %01lX Byte ",
       msg, ( Uint32 )src, ( Uint32 )dst, cnt, size);
  #endif
      pbuf += strlen(pbuf);
***************
*** 308,311 ****
  /****************************************************************************/
  /*  End of File                                                             */
  /****************************************************************************/
! 
\ No newline at end of file
--- 310,313 ----
  /****************************************************************************/
  /*  End of File                                                             */
  /****************************************************************************/
! 
diff -crB --binary sbl6/segasmp/dma/smpdma1/smpdma1.c sbl6_patch/segasmp/dma/smpdma1/smpdma1.c
*** sbl6/segasmp/dma/smpdma1/smpdma1.c	1996-02-08 05:28:12.000000000 -0500
--- sbl6_patch/segasmp/dma/smpdma1/smpdma1.c	2022-01-17 19:55:44.000000000 -0500
***************
*** 16,22 ****
  Uint32 hikaku(void *, void *, Uint32, Uint32, Sint8 *); /*  結果確認関数    */
  void rev(void *, void *, Uint32, Uint32);   /*  転送先データ破壊関数        */
  
! void main(void)
  {
      void *src, *dst;
      Uint32 cnt;
--- 16,22 ----
  Uint32 hikaku(void *, void *, Uint32, Uint32, Sint8 *); /*  結果確認関数    */
  void rev(void *, void *, Uint32, Uint32);   /*  転送先データ破壊関数        */
  
! int main(void)
  {
      void *src, *dst;
      Uint32 cnt;
***************
*** 43,48 ****
--- 43,50 ----
      hikaku(src, dst, cnt, 1, "BOOT to WORK");
  
      for(;;) ;
+     
+     return 0;
  }
  /****************************************************************************/
  /*  結果比較関数                                                            */
***************
*** 209,212 ****
  /****************************************************************************/
  /*  End of File                                                             */
  /****************************************************************************/
! 
\ No newline at end of file
--- 211,214 ----
  /****************************************************************************/
  /*  End of File                                                             */
  /****************************************************************************/
! 
diff -crB --binary sbl6/segasmp/dma/smpdma10/smpdma10.c sbl6_patch/segasmp/dma/smpdma10/smpdma10.c
*** sbl6/segasmp/dma/smpdma10/smpdma10.c	1996-02-08 05:28:14.000000000 -0500
--- sbl6_patch/segasmp/dma/smpdma10/smpdma10.c	2022-01-17 19:55:10.000000000 -0500
***************
*** 18,24 ****
  Uint32 SDMA_ScuResult(Uint32);
  Uint32 hikaku(void *, void *, Uint32, Uint32, Sint8 *); /*  結果確認関数    */
  
! void main(void)
  {
      void *src, *dst;
      Uint32 cnt;
--- 18,24 ----
  Uint32 SDMA_ScuResult(Uint32);
  Uint32 hikaku(void *, void *, Uint32, Uint32, Sint8 *); /*  結果確認関数    */
  
! int main(void)
  {
      void *src, *dst;
      Uint32 cnt;
***************
*** 58,63 ****
--- 58,65 ----
      hikaku((void *)0x06050000, (void *)0x25c00000, 0x0600, 1, "ADR to ADR");
  
      for(;;);
+     
+     return 0;
  }
  /****************************************************************************/
  /*  ステータス取得(チャネル指定)                                            */
***************
*** 227,230 ****
  /****************************************************************************/
  /*  End of File                                                             */
  /****************************************************************************/
! 
\ No newline at end of file
--- 229,232 ----
  /****************************************************************************/
  /*  End of File                                                             */
  /****************************************************************************/
! 
diff -crB --binary sbl6/segasmp/dma/smpdma12/smpdma12.c sbl6_patch/segasmp/dma/smpdma12/smpdma12.c
*** sbl6/segasmp/dma/smpdma12/smpdma12.c	1996-02-08 05:28:18.000000000 -0500
--- sbl6_patch/segasmp/dma/smpdma12/smpdma12.c	2022-01-17 19:54:56.000000000 -0500
***************
*** 16,22 ****
  Uint32 hikaku(void *, void *, Uint32, Uint32, Sint8 *); /*  結果確認関数    */
  void rev(void *, void *, Uint32, Uint32);   /*  転送先データ破壊関数        */
  
! void main(void)
  {
      void *src, *dst;
      Uint32 cnt;
--- 16,22 ----
  Uint32 hikaku(void *, void *, Uint32, Uint32, Sint8 *); /*  結果確認関数    */
  void rev(void *, void *, Uint32, Uint32);   /*  転送先データ破壊関数        */
  
! int main(void)
  {
      void *src, *dst;
      Uint32 cnt;
***************
*** 34,39 ****
--- 34,41 ----
      hikaku(src, dst, cnt, 1, "WORK to VDP1");
  
      for(;;) ;
+     
+     return 0;
  }
  /****************************************************************************/
  /*  結果比較関数                                                            */
***************
*** 200,203 ****
  /****************************************************************************/
  /*  End of File                                                             */
  /****************************************************************************/
! 
\ No newline at end of file
--- 202,205 ----
  /****************************************************************************/
  /*  End of File                                                             */
  /****************************************************************************/
! 
diff -crB --binary sbl6/segasmp/dma/smpdma2/smpdma2.c sbl6_patch/segasmp/dma/smpdma2/smpdma2.c
*** sbl6/segasmp/dma/smpdma2/smpdma2.c	1996-02-08 05:28:22.000000000 -0500
--- sbl6_patch/segasmp/dma/smpdma2/smpdma2.c	2022-01-17 19:55:28.000000000 -0500
***************
*** 15,21 ****
  Uint32 hikaku(void *, void *, Uint32, Uint32, Sint8 *); /*  結果確認関数    */
  void rev(void *, void *, Uint32, Uint32);   /*  転送先データ破壊関数        */
  
! void main(void)
  {
      void *src, *dst;
      Uint32 cnt;
--- 15,21 ----
  Uint32 hikaku(void *, void *, Uint32, Uint32, Sint8 *); /*  結果確認関数    */
  void rev(void *, void *, Uint32, Uint32);   /*  転送先データ破壊関数        */
  
! int main(void)
  {
      void *src, *dst;
      Uint32 cnt;
***************
*** 115,120 ****
--- 115,122 ----
      hikaku(src, dst, cnt, 1, "BOOT to all VDP2");
  
      for(;;) ;
+     
+     return 0;
  }
  /****************************************************************************/
  /*  結果比較関数                                                            */
***************
*** 281,284 ****
  /****************************************************************************/
  /*  End of File                                                             */
  /****************************************************************************/
! 
\ No newline at end of file
--- 283,286 ----
  /****************************************************************************/
  /*  End of File                                                             */
  /****************************************************************************/
! 
diff -crB --binary sbl6/segasmp/dual/sega_spr.h sbl6_patch/segasmp/dual/sega_spr.h
*** sbl6/segasmp/dual/sega_spr.h	1996-02-08 05:28:24.000000000 -0500
--- sbl6_patch/segasmp/dual/sega_spr.h	2022-09-24 21:24:52.000000000 -0400
***************
*** 1,22 ****
  /*----------------------------------------------------------------------------
!  *  sega_spr.h -- SPR ライブラリ インクルードファイル
   *  Copyright(c) 1994 SEGA
   *  Written by H.E on 1994-02-15 Ver.0.80
   *  Updated by H.E on 1994-02-15 Ver.0.80
   *
!  *  スプライト表示用インクルードファイルで使用スプライト表示ライブラリの種別に
!  *  より以下のように定義します。
   *
!  *  （１）スプライト表示基本処理のみの場合
   *
   *        #include "sega_spr.h"
   *
!  *  （２）スプライト表示拡張処理の場合
   *
   *        #define  _SPR2_
   *        #include "sega_spr.h"
   *
!  *  （３）スプライト３Ｄ表示処理の場合
   *
   *        #define  _SPR3_
   *        #include "sega_spr.h"
--- 1,22 ----
  /*----------------------------------------------------------------------------
!  *  sega_spr.h -- SPR ｿｽｿｽｿｽCｿｽuｿｽｿｽｿｽｿｽ ｿｽCｿｽｿｽｿｽNｿｽｿｽｿｽ[ｿｽhｿｽtｿｽ@ｿｽCｿｽｿｽ
   *  Copyright(c) 1994 SEGA
   *  Written by H.E on 1994-02-15 Ver.0.80
   *  Updated by H.E on 1994-02-15 Ver.0.80
   *
!  *  ｿｽXｿｽvｿｽｿｽｿｽCｿｽgｿｽ\ｿｽｿｽｿｽpｿｽCｿｽｿｽｿｽNｿｽｿｽｿｽ[ｿｽhｿｽtｿｽ@ｿｽCｿｽｿｽｿｽﾅ使ｿｽpｿｽXｿｽvｿｽｿｽｿｽCｿｽgｿｽ\ｿｽｿｽｿｽｿｽｿｽCｿｽuｿｽｿｽｿｽｿｽｿｽﾌ趣ｿｽｿｽﾊゑｿｽ
!  *  ｿｽｿｽｿｽｿｽｿｽﾈ会ｿｽｿｽﾌようｿｽﾉ抵ｿｽｿｽ`ｿｽｿｽｿｽﾜゑｿｽｿｽB
   *
!  *  ｿｽiｿｽPｿｽjｿｽXｿｽvｿｽｿｽｿｽCｿｽgｿｽ\ｿｽｿｽｿｽｿｽｿｽ{ｿｽｿｽｿｽｿｽｿｽﾌみの場合
   *
   *        #include "sega_spr.h"
   *
!  *  ｿｽiｿｽQｿｽjｿｽXｿｽvｿｽｿｽｿｽCｿｽgｿｽ\ｿｽｿｽｿｽgｿｽｿｽｿｽｿｽｿｽｿｽｿｽﾌ場合
   *
   *        #define  _SPR2_
   *        #include "sega_spr.h"
   *
!  *  ｿｽiｿｽRｿｽjｿｽXｿｽvｿｽｿｽｿｽCｿｽgｿｽRｿｽcｿｽ\ｿｽｿｽｿｽｿｽｿｽｿｽｿｽﾌ場合
   *
   *        #define  _SPR3_
   *        #include "sega_spr.h"
***************
*** 28,33 ****
--- 28,34 ----
  #ifndef SEGA_SPR_H
  #define SEGA_SPR_H
  
+ 
  /*-----------------------------------
   * Select 3D Execute Machine
   *---------------------------------*/
***************
*** 70,75 ****
--- 71,84 ----
  typedef long                  Long;
  typedef float                 Float;
  typedef double                Double;
+ typedef unsigned    char    Uint8;      /* ｿｽｿｽｿｽｿｽｿｽﾈゑｿｽｿｽPｿｽoｿｽCｿｽgｿｽｿｽｿｽｿｽ */
+ typedef signed      char    Sint8;      /* ｿｽｿｽｿｽｿｽｿｽﾂゑｿｽｿｽPｿｽoｿｽCｿｽgｿｽｿｽｿｽｿｽ */
+ typedef unsigned    short   Uint16;     /* ｿｽｿｽｿｽｿｽｿｽﾈゑｿｽｿｽQｿｽoｿｽCｿｽgｿｽｿｽｿｽｿｽ */
+ typedef signed      short   Sint16;     /* ｿｽｿｽｿｽｿｽｿｽﾂゑｿｽｿｽQｿｽoｿｽCｿｽgｿｽｿｽｿｽｿｽ */
+ typedef unsigned    long    Uint32;     /* ｿｽｿｽｿｽｿｽｿｽﾈゑｿｽｿｽSｿｽoｿｽCｿｽgｿｽｿｽｿｽｿｽ */
+ typedef signed      long    Sint32;     /* ｿｽｿｽｿｽｿｽｿｽﾂゑｿｽｿｽSｿｽoｿｽCｿｽgｿｽｿｽｿｽｿｽ */
+ typedef float               Float32;    /* ｿｽSｿｽoｿｽCｿｽgｿｽｿｽｿｽｿｽ */
+ typedef double              Float64;    /* ｿｽWｿｽoｿｽCｿｽgｿｽｿｽｿｽｿｽ */
  typedef Sint32                Fixed32;    /* Fixed-point representation         */
  					  /* Radix point is between bit 15 & 16 */
  
***************
*** 93,103 ****
  #ifndef FALSE
  #define FALSE                 0
  #endif
! */
  #ifndef TRUE
  #define TRUE                  1
  #endif
! 
  #ifndef NIL
  #define NIL                   0
  #endif
--- 102,112 ----
  #ifndef FALSE
  #define FALSE                 0
  #endif
! 
  #ifndef TRUE
  #define TRUE                  1
  #endif
! */
  #ifndef NIL
  #define NIL                   0
  #endif
***************
*** 109,122 ****
  #ifndef Void
  #define Void                  void
  #endif
! 
  #ifndef OK
  #define OK                    0
  #endif
! 
! #ifndef NG
! #define NG                    -1
! #endif
  
  /*
   * MACROS DECLARATIONS
--- 118,131 ----
  #ifndef Void
  #define Void                  void
  #endif
! /*
  #ifndef OK
  #define OK                    0
  #endif
! */
! // #ifndef NG
! // #define NG                    -1
! // #endif
  
  /*
   * MACROS DECLARATIONS
***************
*** 392,398 ****
  PROTOTYPE(Void  , SPR_2Line, (Uint16, Uint16, GlbXYint *, Uint16));
  PROTOTYPE(Void  , SPR_2PolyLine, (Uint16, Uint16, GlbXYint *, Uint16));
  PROTOTYPE(Void  , SPR_2Polygon, (Uint16, Uint16, GlbXYint *, Uint16));
! PROTOTYPE(Void  , SPR_2NormSpr, (Uint16, Uint16, Uint16, 
  				       Uint16, GlbXYint *, Uint16));
  PROTOTYPE(Void  , SPR_2ScaleSpr, (Uint16, Uint16, Uint16,
  					Uint16, GlbXYint *xy, Uint16));
--- 401,407 ----
  PROTOTYPE(Void  , SPR_2Line, (Uint16, Uint16, GlbXYint *, Uint16));
  PROTOTYPE(Void  , SPR_2PolyLine, (Uint16, Uint16, GlbXYint *, Uint16));
  PROTOTYPE(Void  , SPR_2Polygon, (Uint16, Uint16, GlbXYint *, Uint16));
! PROTOTYPE(Void  , SPR_2NormSpr, (Uint16, Uint16, Uint16,
  				       Uint16, GlbXYint *, Uint16));
  PROTOTYPE(Void  , SPR_2ScaleSpr, (Uint16, Uint16, Uint16,
  					Uint16, GlbXYint *xy, Uint16));
***************
*** 422,480 ****
   * STRUCTURE DECLARATIONS
   */
  struct GlbCluster {
!     GlbObject3D	*object;        /* ３Ｄオブジェクト                          */
!     GlbCluster	*next;       	/* 次クラスタ                                */
!     GlbCluster	*child;      	/* 子クラスタ                                */
!     Uint16	angleSeq;       /* 回転順序                                  */
!     GlbXYZ	angle;	        /* 親クラスタの座標系における回転            */
!     GlbXYZ	point;	        /* 親クラスタの座標系における原点の座標      */
!     GlbXYZ	worldPoint;     /* ワールド座標系における原点の座標          */
  };
  
  struct GlbObject3D {
!     Uint16      dispFlag;       /* 表示フラグ                                */
!     Uint16      vertCount;      /* 頂点数                                    */
!     Uint16      surfaceCount;   /* 面数                                      */
!     GlbXYZ      *vertPoint;     /* 頂点座標テーブル                          */
!     GlbXYZ      *vertNormal;    /* 頂点の法線ベクトルテーブル                */
!     GlbSurface  *surface;       /* 面定義テーブル                            */
!     GlbXYZ      *surfaceNormal; /* 面の法線ベクトルテーブル                  */
!     Uint16      **shdIdxTbl;    /* シェーディングインデックステーブル        */
!     GlbObject3D *next;          /* 次３Ｄオブジェクト                        */
  };
  
  struct GlbSurface {
!     Uint16     vertNo[4];       /* 面を構成する頂点番号                      */
!     Uint16     drawMode;        /* 描画モード                                */
!     Uint16     color;           /* カラーデータ                              */
  };
  
  struct GlbTexture {
!     Uint16       charNo;        /* 面を構成する頂点番号                      */
!     Uint16       colorMode;     /* カラーモード                              */
!     Uint16       width;         /* キャラクタの幅                            */
!     Uint16       height;        /* キャラクタの高さ                          */
!     Uint8        *charData;     /* キャラクタデータのポインタ                */
!     GlbLookupTbl *lookupTbl;    /* ルックアップテーブルのポインタ            */
  };
  
  struct GlbCmdChain {
!     Fixed32     z;              /* Ｚソート代表値                            */
!     GlbCmdChain *next;          /* 次のコマンドチェインエントリポインタ      */
!     Uint16      cmdNo;          /* コマンド番号                              */
  };
  
  struct Glb3WorkArea {
!     Uint16      drawPolMax;     /* 描画ポリゴン最大数                        */
!     Uint16      objSurfMax;     /* オブジェクト内最大面数                    */
!     Uint16      objVertMax;     /* オブジェクト内最大頂点数                  */
!     Uint16      sortBlkMax;     /* ソートブロック最大エントリ数              */
!     Uint8       *surfBright;    /* 面輝度テーブル                            */
!     Uint8       *vertBright;    /* 頂点輝度テーブル                          */
!     GlbXYZ      *coord3D;       /* ３Ｄ座標変換後テーブル                    */
!     GlbXYint    *coord2D;       /* ２Ｄ透視変換後テーブル                    */
!     GlbCmdChain *cmdChain;      /* 描画ポリゴンコマンドチェインテーブル      */
!     GlbCmdChain **zSortBlk;     /* Ｚソートブロックエリア                    */
  };
  
  
--- 431,489 ----
   * STRUCTURE DECLARATIONS
   */
  struct GlbCluster {
!     GlbObject3D	*object;        /* ｿｽRｿｽcｿｽIｿｽuｿｽWｿｽFｿｽNｿｽg                          */
!     GlbCluster	*next;       	/* ｿｽｿｽｿｽNｿｽｿｽｿｽXｿｽ^                                */
!     GlbCluster	*child;      	/* ｿｽqｿｽNｿｽｿｽｿｽXｿｽ^                                */
!     Uint16	angleSeq;       /* ｿｽｿｽｿｽ]ｿｽｿｽｿｽｿｽ                                  */
!     GlbXYZ	angle;	        /* ｿｽeｿｽNｿｽｿｽｿｽXｿｽ^ｿｽﾌ搾ｿｽｿｽWｿｽnｿｽﾉゑｿｽｿｽｿｽｿｽｿｽｿｽｿｽｿｽ]            */
!     GlbXYZ	point;	        /* ｿｽeｿｽNｿｽｿｽｿｽXｿｽ^ｿｽﾌ搾ｿｽｿｽWｿｽnｿｽﾉゑｿｽｿｽｿｽｿｽ骭ｴｿｽ_ｿｽﾌ搾ｿｽｿｽW      */
!     GlbXYZ	worldPoint;     /* ｿｽｿｽｿｽ[ｿｽｿｽｿｽhｿｽｿｽｿｽWｿｽnｿｽﾉゑｿｽｿｽｿｽｿｽ骭ｴｿｽ_ｿｽﾌ搾ｿｽｿｽW          */
  };
  
  struct GlbObject3D {
!     Uint16      dispFlag;       /* ｿｽ\ｿｽｿｽｿｽtｿｽｿｽｿｽO                                */
!     Uint16      vertCount;      /* ｿｽｿｽｿｽ_ｿｽｿｽ                                    */
!     Uint16      surfaceCount;   /* ｿｽﾊ撰ｿｽ                                      */
!     GlbXYZ      *vertPoint;     /* ｿｽｿｽｿｽ_ｿｽｿｽｿｽWｿｽeｿｽ[ｿｽuｿｽｿｽ                          */
!     GlbXYZ      *vertNormal;    /* ｿｽｿｽｿｽ_ｿｽﾌ法ｿｽｿｽｿｽxｿｽNｿｽgｿｽｿｽｿｽeｿｽ[ｿｽuｿｽｿｽ                */
!     GlbSurface  *surface;       /* ｿｽﾊ抵ｿｽｿｽ`ｿｽeｿｽ[ｿｽuｿｽｿｽ                            */
!     GlbXYZ      *surfaceNormal; /* ｿｽﾊの法ｿｽｿｽｿｽxｿｽNｿｽgｿｽｿｽｿｽeｿｽ[ｿｽuｿｽｿｽ                  */
!     Uint16      **shdIdxTbl;    /* ｿｽVｿｽFｿｽ[ｿｽfｿｽBｿｽｿｽｿｽOｿｽCｿｽｿｽｿｽfｿｽbｿｽNｿｽXｿｽeｿｽ[ｿｽuｿｽｿｽ        */
!     GlbObject3D *next;          /* ｿｽｿｽｿｽRｿｽcｿｽIｿｽuｿｽWｿｽFｿｽNｿｽg                        */
  };
  
  struct GlbSurface {
!     Uint16     vertNo[4];       /* ｿｽﾊゑｿｽｿｽ\ｿｽｿｽｿｽｿｽｿｽ髓ｸｿｽ_ｿｽﾔ搾ｿｽ                      */
!     Uint16     drawMode;        /* ｿｽ`ｿｽ諠ゑｿｽ[ｿｽh                                */
!     Uint16     color;           /* ｿｽJｿｽｿｽｿｽ[ｿｽfｿｽ[ｿｽ^                              */
  };
  
  struct GlbTexture {
!     Uint16       charNo;        /* ｿｽﾊゑｿｽｿｽ\ｿｽｿｽｿｽｿｽｿｽ髓ｸｿｽ_ｿｽﾔ搾ｿｽ                      */
!     Uint16       colorMode;     /* ｿｽJｿｽｿｽｿｽ[ｿｽｿｽｿｽ[ｿｽh                              */
!     Uint16       width;         /* ｿｽLｿｽｿｽｿｽｿｽｿｽNｿｽ^ｿｽﾌ包ｿｽ                            */
!     Uint16       height;        /* ｿｽLｿｽｿｽｿｽｿｽｿｽNｿｽ^ｿｽﾌ搾ｿｽｿｽｿｽ                          */
!     Uint8        *charData;     /* ｿｽLｿｽｿｽｿｽｿｽｿｽNｿｽ^ｿｽfｿｽ[ｿｽ^ｿｽﾌポｿｽCｿｽｿｽｿｽ^                */
!     GlbLookupTbl *lookupTbl;    /* ｿｽｿｽｿｽbｿｽNｿｽAｿｽbｿｽvｿｽeｿｽ[ｿｽuｿｽｿｽｿｽﾌポｿｽCｿｽｿｽｿｽ^            */
  };
  
  struct GlbCmdChain {
!     Fixed32     z;              /* ｿｽyｿｽ\ｿｽ[ｿｽgｿｽｿｽｿｽ\ｿｽl                            */
!     GlbCmdChain *next;          /* ｿｽｿｽｿｽﾌコｿｽ}ｿｽｿｽｿｽhｿｽ`ｿｽFｿｽCｿｽｿｽｿｽGｿｽｿｽｿｽgｿｽｿｽｿｽ|ｿｽCｿｽｿｽｿｽ^      */
!     Uint16      cmdNo;          /* ｿｽRｿｽ}ｿｽｿｽｿｽhｿｽﾔ搾ｿｽ                              */
  };
  
  struct Glb3WorkArea {
!     Uint16      drawPolMax;     /* ｿｽ`ｿｽｿｽｿｽ|ｿｽｿｽｿｽSｿｽｿｽｿｽﾅ大数                        */
!     Uint16      objSurfMax;     /* ｿｽIｿｽuｿｽWｿｽFｿｽNｿｽgｿｽｿｽｿｽﾅ托ｿｽｿｽﾊ撰ｿｽ                    */
!     Uint16      objVertMax;     /* ｿｽIｿｽuｿｽWｿｽFｿｽNｿｽgｿｽｿｽｿｽﾅ大頂ｿｽ_ｿｽｿｽ                  */
!     Uint16      sortBlkMax;     /* ｿｽ\ｿｽ[ｿｽgｿｽuｿｽｿｽｿｽbｿｽNｿｽﾅ托ｿｽｿｽGｿｽｿｽｿｽgｿｽｿｽｿｽｿｽ              */
!     Uint8       *surfBright;    /* ｿｽﾊ輝ｿｽxｿｽeｿｽ[ｿｽuｿｽｿｽ                            */
!     Uint8       *vertBright;    /* ｿｽｿｽｿｽ_ｿｽPｿｽxｿｽeｿｽ[ｿｽuｿｽｿｽ                          */
!     GlbXYZ      *coord3D;       /* ｿｽRｿｽcｿｽｿｽｿｽWｿｽﾏ奇ｿｽｿｽｿｽｿｽeｿｽ[ｿｽuｿｽｿｽ                    */
!     GlbXYint    *coord2D;       /* ｿｽQｿｽcｿｽｿｽｿｽｿｽｿｽﾏ奇ｿｽｿｽｿｽｿｽeｿｽ[ｿｽuｿｽｿｽ                    */
!     GlbCmdChain *cmdChain;      /* ｿｽ`ｿｽｿｽｿｽ|ｿｽｿｽｿｽSｿｽｿｽｿｽRｿｽ}ｿｽｿｽｿｽhｿｽ`ｿｽFｿｽCｿｽｿｽｿｽeｿｽ[ｿｽuｿｽｿｽ      */
!     GlbCmdChain **zSortBlk;     /* ｿｽyｿｽ\ｿｽ[ｿｽgｿｽuｿｽｿｽｿｽbｿｽNｿｽGｿｽｿｽｿｽA                    */
  };
  
  
diff -crB --binary sbl6/segasmp/dual/slv_mtx3.h sbl6_patch/segasmp/dual/slv_mtx3.h
*** sbl6/segasmp/dual/slv_mtx3.h	1996-02-08 05:28:26.000000000 -0500
--- sbl6_patch/segasmp/dual/slv_mtx3.h	2022-09-24 21:43:30.000000000 -0400
***************
*** 1,15 ****
  /*----------------------------------------------------------------------------
!  *  spr_mtx3.h -- SPR ライブラリ MTX3 インクルードファイル
   *  Copyright(c) 1994 SEGA
   *  Written by K.M on 1993-12-14 Ver.0.80
   *  Updated by H.E on 1994-02-15 Ver.0.80
   *
!  *  このインクルードファイルはスプライト３Ｄ表示のマトリックス演算ルーチン
!  *  定義。
   *
   *----------------------------------------------------------------------------
   */
!  
  #define	PRODUCT(a, b)\
  (MUL_FIXED((a).x, (b).x) + MUL_FIXED((a).y, (b).y) + MUL_FIXED((a).z, (b).z))
  
--- 1,19 ----
  /*----------------------------------------------------------------------------
!  *  spr_mtx3.h -- SPR ｿｽｿｽｿｽCｿｽuｿｽｿｽｿｽｿｽ MTX3 ｿｽCｿｽｿｽｿｽNｿｽｿｽｿｽ[ｿｽhｿｽtｿｽ@ｿｽCｿｽｿｽ
   *  Copyright(c) 1994 SEGA
   *  Written by K.M on 1993-12-14 Ver.0.80
   *  Updated by H.E on 1994-02-15 Ver.0.80
   *
!  *  ｿｽｿｽｿｽﾌイｿｽｿｽｿｽNｿｽｿｽｿｽ[ｿｽhｿｽtｿｽ@ｿｽCｿｽｿｽｿｽﾍスｿｽvｿｽｿｽｿｽCｿｽgｿｽRｿｽcｿｽ\ｿｽｿｽｿｽﾌマｿｽgｿｽｿｽｿｽbｿｽNｿｽXｿｽｿｽｿｽZｿｽｿｽｿｽ[ｿｽ`ｿｽｿｽ
!  *  ｿｽｿｽｿｽ`ｿｽB
   *
   *----------------------------------------------------------------------------
   */
! 
! #include "sega_spr.h"
! 
! struct GlbXYZ;
! 
  #define	PRODUCT(a, b)\
  (MUL_FIXED((a).x, (b).x) + MUL_FIXED((a).y, (b).y) + MUL_FIXED((a).z, (b).z))
  
diff -crB --binary sbl6/segasmp/dual/slvsamp.c sbl6_patch/segasmp/dual/slvsamp.c
*** sbl6/segasmp/dual/slvsamp.c	1996-02-08 05:28:26.000000000 -0500
--- sbl6_patch/segasmp/dual/slvsamp.c	2022-09-24 10:01:18.000000000 -0400
***************
*** 4,10 ****
  
  #include "sega_xpt.h"
  #define _SPR2_
! #include "sega_spr.h"
  #include "spr_mtx3.h"
  #include "slv_mtx3.h"
  
--- 4,11 ----
  
  #include "sega_xpt.h"
  #define _SPR2_
! //#include "sega_spr.h"
! #include "sl_def.h"
  #include "spr_mtx3.h"
  #include "slv_mtx3.h"
  
***************
*** 353,359 ****
  	extern volatile void	*SlaveCommand;
  	#define	slave_command	*( volatile Uint32 * )(( Uint32 )&SlaveCommand + 0x20000000 )
  #endif
! void /* マスタ CPU のメイン関数(スレーブ CPU に関数 slave の実行を依頼する) */
    main(void)
  {
  #if	0
--- 354,360 ----
  	extern volatile void	*SlaveCommand;
  	#define	slave_command	*( volatile Uint32 * )(( Uint32 )&SlaveCommand + 0x20000000 )
  #endif
! int /* マスタ CPU のメイン関数(スレーブ CPU に関数 slave の実行を依頼する) */
    main(void)
  {
  #if	0
***************
*** 426,431 ****
--- 427,433 ----
  		*( Uint16 * )0x25d00002 = 0x0003;
  	}
  #endif
+ 	return 0;
  }
  
  void /* マスタ CPU が実行する関数 */
***************
*** 605,608 ****
      FWBank = 1 - FWBank; /* 1 -> 0; 0 -> 1 */
      BKBank = 1 - BKBank; /* 1 -> 0; 0 -> 1 */
  }
! 
\ No newline at end of file
--- 607,610 ----
      FWBank = 1 - FWBank; /* 1 -> 0; 0 -> 1 */
      BKBank = 1 - BKBank; /* 1 -> 0; 0 -> 1 */
  }
! 
diff -crB --binary sbl6/segasmp/dual/spr_xpt.c sbl6_patch/segasmp/dual/spr_xpt.c
*** sbl6/segasmp/dual/spr_xpt.c	1996-02-08 05:28:28.000000000 -0500
--- sbl6_patch/segasmp/dual/spr_xpt.c	2022-09-24 10:01:54.000000000 -0400
***************
*** 1,16 ****
  /*----------------------------------------------------------------------------
!  *  spr_xpt.c -- SPR ライブラリ XPT モジュール
   *  Copyright(c) 1994 SEGA
   *  Written by H.E on 1994-02-15 Ver.0.80
   *  Updated by H.E on 1994-02-15 Ver.0.80
   *
!  *  このライブラリはスプライト表示処理のマシンに依存するルーチンを含む。
   *
!  *  fxsin                   -  ＳＩＮの計算
!  *  fxcos                   -  ＣＯＳの計算
!  *  dmemcpy                 -  メモリコピー
   *
!  *  このライブラリを使用するには次のインクルードファイルを定義する必要がある。
   *
   *   #include "sega_xpt.h"
   *   #include "sega_spr.h"
--- 1,16 ----
  /*----------------------------------------------------------------------------
!  *  spr_xpt.c -- SPR ｿｽｿｽｿｽCｿｽuｿｽｿｽｿｽｿｽ XPT ｿｽｿｽｿｽWｿｽｿｽｿｽ[ｿｽｿｽ
   *  Copyright(c) 1994 SEGA
   *  Written by H.E on 1994-02-15 Ver.0.80
   *  Updated by H.E on 1994-02-15 Ver.0.80
   *
!  *  ｿｽｿｽｿｽﾌｿｽｿｽCｿｽuｿｽｿｽｿｽｿｽｿｽﾍスｿｽvｿｽｿｽｿｽCｿｽgｿｽ\ｿｽｿｽｿｽｿｽｿｽｿｽｿｽﾌマｿｽVｿｽｿｽｿｽﾉ依托ｿｽｿｽｿｽｿｽ驛具ｿｽ[ｿｽ`ｿｽｿｽｿｽｿｽｿｽﾜむ。
   *
!  *  fxsin                   -  ｿｽrｿｽhｿｽmｿｽﾌ計ｿｽZ
!  *  fxcos                   -  ｿｽbｿｽnｿｽrｿｽﾌ計ｿｽZ
!  *  dmemcpy                 -  ｿｽｿｽｿｽｿｽｿｽｿｽｿｽRｿｽsｿｽ[
   *
!  *  ｿｽｿｽｿｽﾌｿｽｿｽCｿｽuｿｽｿｽｿｽｿｽｿｽｿｽｿｽgｿｽpｿｽｿｽｿｽｿｽｿｽﾉは趣ｿｽｿｽﾌイｿｽｿｽｿｽNｿｽｿｽｿｽ[ｿｽhｿｽtｿｽ@ｿｽCｿｽｿｽｿｽｿｽｿｽｿｽｿｽ`ｿｽｿｽｿｽｿｽｿｽKｿｽvｿｽｿｽｿｽｿｽｿｽｿｽｿｽB
   *
   *   #include "sega_xpt.h"
   *   #include "sega_spr.h"
***************
*** 19,27 ****
   */
  
  #include "sega_xpt.h"
! #include "sega_spr.h"
  
  #include	<machine.h>
  
  extern Fixed32 fsin(Fixed32 degree);
  extern Fixed32 fcos(Fixed32 degree);
--- 19,29 ----
   */
  
  #include "sega_xpt.h"
! //#include "sega_spr.h"
! #include "sl_def.h"
  
  #include	<machine.h>
+ #include  <string.h>
  
  extern Fixed32 fsin(Fixed32 degree);
  extern Fixed32 fcos(Fixed32 degree);
***************
*** 77,82 ****
  }
  
  /*  end of file */
- 
- 
- 
--- 79,81 ----
diff -crB --binary sbl6/segasmp/game/act.c sbl6_patch/segasmp/game/act.c
*** sbl6/segasmp/game/act.c	1996-02-08 05:28:38.000000000 -0500
--- sbl6_patch/segasmp/game/act.c	2022-09-24 09:08:36.000000000 -0400
***************
*** 1,365 ****
  /*----------------------------------------------------------------------*/
  /*	ＳＢＬ６サンプルゲームだよーん										*/
  /*----------------------------------------------------------------------*/
! 
! #include	"act.h"
! #include	"sega_scl.h"
! #include	"sega_dbg.h"
! #include	"sample.h"
! #include	"game.h"
! 
! 
! Uint16	endtimer=0,endflg=0;
! 
! extern	trigger_t	pltrigger[];
! extern	Uint16	fadetimer;
! 
! /*FIGHTER	*p1,*p2;*/
! FIGHTER	f[2];
! BULLET	b[2][_BULLETS];
! ONEPLANE	p[6];
! FIGHTER	*pt[] = { &f[1],&f[0] };
! PDATA	PDcube[2];
! PDATA	*PDlist[] = { &PD_CUBE1 , &PD_CUBE2 };
! PDATA	* const _PDplane[] = {
! 			&PD_BREAK1,
! 			&PD_BREAK2,
! 			&PD_BREAK3,
! 			&PD_BREAK4,
! 			&PD_BREAK5,
! 			&PD_BREAK6
! 		};
! 
! const short	spdtbl[6][XYZ]	= {
! 				{  0 , -2 ,  1 },
! 				{ -1 ,  0 ,  0 },
! 				{  0 , -2 , -1 },
! 				{  1 ,  0 ,  0 },
! 				{  0 , -1 ,  0 },
! 				{  0 ,  1 ,  0 }
! 			};
! const ANGLE	rottbl[6][XYZ]	={
! 				{DEGtoANG(-10.0 ),DEGtoANG(-10.0 ),DEGtoANG(  0.0 )},
! 				{DEGtoANG(  0.0 ),DEGtoANG( 10.0 ),DEGtoANG(-10.0 )},
! 				{DEGtoANG( 10.0 ),DEGtoANG( 10.0 ),DEGtoANG(  0.0 )},
! 				{DEGtoANG(  0.0 ),DEGtoANG( 10.0 ),DEGtoANG( 10.0 )},
! 				{DEGtoANG( 10.0 ),DEGtoANG(  0.0 ),DEGtoANG( 10.0 )},
! 				{DEGtoANG(-10.0 ),DEGtoANG(  0.0 ),DEGtoANG(-10.0 )}
! 			};
! 
! unsigned short	flash_color[] = {	/* Flashの色	*/
! 			C_RGB(25,28,30),
! 			C_RGB(25,25,30),
! 			C_RGB(25,28,30),
! 			C_RGB(25,25,30),
! 			C_RGB(30,30,25),
! 			C_RGB(30,30,25)
! 			};
! unsigned short	org_color[] = {	/* 元の色	*/
! 			C_RGB( 6,16,25),
! 			C_RGB( 6, 6,25),
! 			C_RGB( 6,16,25),
! 			C_RGB( 6, 6,25),
! 			C_RGB(20,20,10),
! 			C_RGB(20,20,10)
! 			};
! 
! 
! #define	TRG_FIRE	(TRG_A|TRG_B)
! 
! #define	resetplayer( sts )	\
! 	do{						\
! 		sts->shotwait = 0;	\
! 		sts->collision = 0;	\
! 		sts->hitpoint = 3;	\
! 		endtimer = 0;		\
! 		endflg = 0;			\
! 	}while(0)
! 
! 
! 
! void	player(	FIGHTER	*sts ){
! 	int	i,j;
! 	trigger_t	myswitch = pltrigger[sts->id];
! 
! 	if(( myswitch & TRG_C) != 0 ){
! 		resetplayer( sts );
! 	}
! 
! 	if( sts->hitpoint != 0 ){					/* 生きている */
! 		if( sts->shotwait == 0 ){				/* 攻撃 */
! 			if( ( myswitch & TRG_FIRE ) != 0 ){
! 				for( i = 0 ; i < _BULLETS ; i++ ){
! 					if( sts->myb[i]->busy == 0 ){
! 						FIXED	speed = _BULLETSPEED;
! 						ANGLE	rotate = _BULLETROT;
! 						for( j = X ; j < XYZ ; j++){
! 							sts->myb[i]->pos[j] = sts->pos[j];
! 						}
! 						sts->myb[i]->busy = 1;
! 						sts->myb[i]->target = pt[sts->id];
! 						if( sts->pos[X] > 0 ){
! 							speed *= -1;
! 							rotate *= -1;
! 						}
! 						sts->myb[i]->spd[X] = speed;
! 						sts->myb[i]->rot[Z] = rotate;
! 						sts->shotwait = _SHOTINTERVAL;
! 						break;
! 					}
! 				}
! 			}
! 		}
! 		else{
! 			if( --sts->shotwait < 0 )
! 				sts->shotwait = 0;
! 		}
! 
! 		if( sts->collision == 0 ){				/* 被弾 */
! 			if( sts->hit != 0){
! 				sts->collision = _NODAMAGE;
! 				if( --sts->hitpoint == 0 )
! 					break_init( sts->ang,sts->pos );
! 			}
! 		}
! 		else{	/*無敵*/
! 			if( --sts->collision < 0 )
! 				sts->collision = 0;
! 			else{
! 				unsigned short	*pCOLOR;
! 				if( sts->collision & 0x01 )
! 					pCOLOR = flash_color;
! 				else
! 					pCOLOR = org_color;
! 				for( i = 0 ; i < 6 ; i++ )
! 					sts->pd->attbl[i].colno = pCOLOR[i];
! 			}
! 		}
! 		sts->hit = 0;
! 
  		slPushMatrix();							/* 表示 */
! 		spr_move( myswitch,sts->pos,sts->ang);
  		set_poly(sts->ang , sts->pos);
  		slPutPolygon( sts->pd );
  		slPopMatrix();
! 
! 	}
! 	else{	/* 死んでる */
! 		spr_break();	/* 爆発 */
! 	}
! }
! 
! 
! 
! void _obje1_act(void){
! 	player( &f[0] );
! }
! 
! void _obje2_act(void){
! 	player( &f[1] );
! }
! 
! 
! void	bullet( BULLET	*sts ){
! 	if( sts->busy != 0 ){
! 		FIXED	distance;
! 		if( ( distance = sts->pos[X] ) < 0 )
! 			distance *= -1;
! 
! 		if( toFIXED( 280.0 ) > distance ){
! 			sts->pos[X] += sts->spd[X];
! 			sts->ang[Z] += sts->rot[Z];
! 
  			slPushMatrix();
  			set_poly( sts->ang, sts->pos );
  			slPutPolygon( sts->pd );
  			slPopMatrix();
! 		}
! 		else{
! 			sts->busy = 0;
! 			return;
! 		}
! 		if( sts->target->hitpoint != 0 ){
! 			if( spr_col( sts->pos , sts->target->pos ) ){
! 				sts->target->hit++;
! 				/*	sts->busy = 0;	*/
! 			}
! 		}
! 	}
! }
! 
! 
! void _shot1_1_act(void){
! 	int	i;
! 	for( i = 0 ; i < _BULLETS ; i++)
! 		bullet( &b[0][i] );
! }
! void _shot1_2_act(void){
! 	;
! }
! void _shot2_1_act(void){
! 	int	i;
! 	for( i = 0 ; i < _BULLETS ; i++)
! 		bullet( &b[1][i] );
! }
! void _shot2_2_act(void){
! 	;
! }
! 
! void	rot_player( int	idnum ){
! 	/* 自転	*/
! 	f[idnum].ang[Y] += DEGtoANG( 12.0 );
! 	f[idnum].ang[Z] += DEGtoANG(  2.0 );
  	slPushMatrix();
  	set_poly( f[idnum].ang , f[idnum].pos );
  	slPutPolygon( f[idnum].pd );
  	slPopMatrix();
! }
! 
! void _obje1_demo(void){
! 	rot_player( 0 );
! }
! 
! void _obje2_demo(void){
! 	rot_player( 1 );
! }
! 
! 
! 
! void	init_objects( void ){
! 	int	i,j;
! 	endtimer = 0;
! 	endflg = 0;
! 
  	/* 自機オブジェの初期ポジション	*/
  	f[0].ang[X] = f[1].ang[X] = DEGtoANG( 0.0 );
  	f[0].ang[Y] = f[1].ang[Y] = DEGtoANG( 0.0 );
  	f[0].ang[Z] = f[1].ang[Z] = DEGtoANG( 0.0 );
! 
  	f[0].id = 0;
  	f[1].id = 1;
! 
! 	f[0].shotwait  = f[1].shotwait = 0;
! 	f[0].collision = f[1].collision = 0;
! 	f[0].hitpoint  = f[1].hitpoint = 3;
! 
  	f[0].pos[X] = toFIXED(-130.0 );
  	f[0].pos[Y] = toFIXED(   0.0 );
  	f[0].pos[Z] = toFIXED( 240.0 );
! 
  	f[1].pos[X] = toFIXED( 130.0);
  	f[1].pos[Y] = toFIXED(   0.0);
  	f[1].pos[Z] = toFIXED( 240.0);
! 
! 	for( i = 0 ; i < 2 ; i++ ){
! 		unsigned char	*src,*dst;
! 		src = ( unsigned char * )PDlist[i];
! 		dst = ( unsigned char * )&PDcube[i];
! 		f[i].pd = &PDcube[i];
! 		for( j = 0 ; j < ( int )sizeof( PDATA ) ; j++ )
! 			*dst++ = *src++;
! 		for( j = 0 ; j < _BULLETS ; j++ )
! 			f[i].myb[j] = &b[i][j];
! 	}
! 
! 
! 	/* ショット弾の初期ポジション	*/
! 	for( i = 0 ; i < 2 ; i++ ){
! 		for( j = 0 ; j < _BULLETS ; j++ ){
  			b[i][j].ang[X] = b[i][j].ang[Y] = b[i][j].ang[Z] = DEGtoANG( 0.0 );
  			b[i][j].pos[X] = b[i][j].pos[Y] = b[i][j].pos[Z] = toFIXED( 0.0 );
  			b[i][j].busy = 0;
  			b[i][j].pd = &PD_PLANE1;
! 			b[i][j].id = ( i << 12 ) + ( j << 8 ) + i*_BULLETS + j;
! 		}
! 	}
! 
! 	/* 飛び散るポリゴンの初期ポジション	*/
! 	for( i = 0 ; i < 6 ; i++ ){
! 		p[i].ang[X] = p[i].ang[Y] = p[i].ang[Z] = DEGtoANG( 0.0);
! 		p[i].pos[X] = p[i].pos[Y] = p[i].pos[Z] = toFIXED( 0.0);
! 		p[i].pd = _PDplane[i];
! 		for( j = X ; j < XYZ ; j++ ){
! 			p[i].spd[j] = spdtbl[i][j];
! 			p[i].rot[j] = rottbl[i][j];
! 		}
! 	}
! }
! 
! 
! 
! /* 破壊後の初期化	*/
  void break_init(ANGLE ang[XYZ],FIXED pos[XYZ]){
! 	int	i,j;
! 	for( i = 0 ; i < 6 ; i++ ){
! 		for( j = X ; j < XYZ ; j++ ){
! 			p[i].ang[j] = ang[j];
! 			p[i].pos[j] = pos[j];
! 		}
! 	}
! }
! 
! /* ポリゴンが飛び散る	*/
! void spr_break(void){
! 	static Uint16 c1,c2,c3,c4,c5;
! 	FIXED	x = toFIXED( fadetimer )/6;
! 	int	i,j;
! 	for( i = 0 ; i < 6 ; i++ ){
! 		for( j = X ; j < XYZ ; j ++ ){
! 			switch( abs( p[i].spd[j] ) ){
! 				case 0:
! 					break;
! 				case 1:
! 					p[i].pos[j] +=  x *  p[i].spd[j];
! 					break;
! 				case 2:
! 					p[i].pos[j] +=  p[i].spd[j];
! 					break;
! 				default:
! 					break;
! 			}
! 			p[i].ang[j] += p[i].rot[j];
! 
! 		}
  	 	slPushMatrix();
  		set_poly( p[i].ang,p[i].pos );
  		slPutPolygon( p[i].pd );
  		slPopMatrix();
! 	}
! 
! 	if( ++endtimer == 90 )
! 		endflg=1;					/* ゲーム終了	*/
! 
! 	if(fadetimer >0)
! 		fadetimer--;
! 
! 	c1 =  6 * fadetimer/60;
! 	c2 = 25 * fadetimer/60;
! 	c3 = 16 * fadetimer/60;
! 	c4 = 10 * fadetimer/60;
! 	c5 = 20 * fadetimer/60;
! 	attribute_BREAK[0].colno=C_RGB(c1,c1,c2);
! 	attribute_BREAK[1].colno=C_RGB(c1,c3,c2);
! 	attribute_BREAK[2].colno=C_RGB(c5,c5,c4);
! }
! 
! void	_pause_act( void ){
! 	int	i,j;
! 	for( i = 0 ; i < 2 ; i++){
  		slPushMatrix();							/* 表示 */
  		set_poly( f[i].ang , f[i].pos );
  		slPutPolygon( f[i].pd );
  		slPopMatrix();
! 	}
! 	for( i = 0 ; i < 2 ; i++){
! 		for( j = 0 ; j < _BULLETS ; j++ ){
! 			if( b[i][j].busy != 0 ){
  				slPushMatrix();							/* 表示 */
  				set_poly( b[i][j].ang , b[i][j].pos );
  				slPutPolygon( &PD_PLANE1 );
! 				slPopMatrix();
  			}
! 		}
! 	}
! }
! 
\ No newline at end of file
--- 1,366 ----
  /*----------------------------------------------------------------------*/
  /*	ＳＢＬ６サンプルゲームだよーん										*/
  /*----------------------------------------------------------------------*/
! 
! #include	"act.h"
! #include	"sega_scl.h"
! #include	"sega_dbg.h"
! #include	"sample.h"
! #include	"game.h"
! 
! #include 	<stdlib.h>
! 
! Uint16	endtimer=0,endflg=0;
! 
! extern	trigger_t	pltrigger[];
! extern	Uint16	fadetimer;
! 
! /*FIGHTER	*p1,*p2;*/
! FIGHTER	f[2];
! BULLET	b[2][_BULLETS];
! ONEPLANE	p[6];
! FIGHTER	*pt[] = { &f[1],&f[0] };
! PDATA	PDcube[2];
! PDATA	*PDlist[] = { &PD_CUBE1 , &PD_CUBE2 };
! PDATA	* const _PDplane[] = {
! 			&PD_BREAK1,
! 			&PD_BREAK2,
! 			&PD_BREAK3,
! 			&PD_BREAK4,
! 			&PD_BREAK5,
! 			&PD_BREAK6
! 		};
! 
! const short	spdtbl[6][XYZ]	= {
! 				{  0 , -2 ,  1 },
! 				{ -1 ,  0 ,  0 },
! 				{  0 , -2 , -1 },
! 				{  1 ,  0 ,  0 },
! 				{  0 , -1 ,  0 },
! 				{  0 ,  1 ,  0 }
! 			};
! const ANGLE	rottbl[6][XYZ]	={
! 				{DEGtoANG(-10.0 ),DEGtoANG(-10.0 ),DEGtoANG(  0.0 )},
! 				{DEGtoANG(  0.0 ),DEGtoANG( 10.0 ),DEGtoANG(-10.0 )},
! 				{DEGtoANG( 10.0 ),DEGtoANG( 10.0 ),DEGtoANG(  0.0 )},
! 				{DEGtoANG(  0.0 ),DEGtoANG( 10.0 ),DEGtoANG( 10.0 )},
! 				{DEGtoANG( 10.0 ),DEGtoANG(  0.0 ),DEGtoANG( 10.0 )},
! 				{DEGtoANG(-10.0 ),DEGtoANG(  0.0 ),DEGtoANG(-10.0 )}
! 			};
! 
! unsigned short	flash_color[] = {	/* Flashの色	*/
! 			C_RGB(25,28,30),
! 			C_RGB(25,25,30),
! 			C_RGB(25,28,30),
! 			C_RGB(25,25,30),
! 			C_RGB(30,30,25),
! 			C_RGB(30,30,25)
! 			};
! unsigned short	org_color[] = {	/* 元の色	*/
! 			C_RGB( 6,16,25),
! 			C_RGB( 6, 6,25),
! 			C_RGB( 6,16,25),
! 			C_RGB( 6, 6,25),
! 			C_RGB(20,20,10),
! 			C_RGB(20,20,10)
! 			};
! 
! 
! #define	TRG_FIRE	(TRG_A|TRG_B)
! 
! #define	resetplayer( sts )	\
! 	do{						\
! 		sts->shotwait = 0;	\
! 		sts->collision = 0;	\
! 		sts->hitpoint = 3;	\
! 		endtimer = 0;		\
! 		endflg = 0;			\
! 	}while(0)
! 
! 
! 
! void	player(	FIGHTER	*sts ){
! 	int	i,j;
! 	trigger_t	myswitch = pltrigger[sts->id];
! 
! 	if(( myswitch & TRG_C) != 0 ){
! 		resetplayer( sts );
! 	}
! 
! 	if( sts->hitpoint != 0 ){					/* 生きている */
! 		if( sts->shotwait == 0 ){				/* 攻撃 */
! 			if( ( myswitch & TRG_FIRE ) != 0 ){
! 				for( i = 0 ; i < _BULLETS ; i++ ){
! 					if( sts->myb[i]->busy == 0 ){
! 						FIXED	speed = _BULLETSPEED;
! 						ANGLE	rotate = _BULLETROT;
! 						for( j = X ; j < XYZ ; j++){
! 							sts->myb[i]->pos[j] = sts->pos[j];
! 						}
! 						sts->myb[i]->busy = 1;
! 						sts->myb[i]->target = pt[sts->id];
! 						if( sts->pos[X] > 0 ){
! 							speed *= -1;
! 							rotate *= -1;
! 						}
! 						sts->myb[i]->spd[X] = speed;
! 						sts->myb[i]->rot[Z] = rotate;
! 						sts->shotwait = _SHOTINTERVAL;
! 						break;
! 					}
! 				}
! 			}
! 		}
! 		else{
! 			if( --sts->shotwait < 0 )
! 				sts->shotwait = 0;
! 		}
! 
! 		if( sts->collision == 0 ){				/* 被弾 */
! 			if( sts->hit != 0){
! 				sts->collision = _NODAMAGE;
! 				if( --sts->hitpoint == 0 )
! 					break_init( sts->ang,sts->pos );
! 			}
! 		}
! 		else{	/*無敵*/
! 			if( --sts->collision < 0 )
! 				sts->collision = 0;
! 			else{
! 				unsigned short	*pCOLOR;
! 				if( sts->collision & 0x01 )
! 					pCOLOR = flash_color;
! 				else
! 					pCOLOR = org_color;
! 				for( i = 0 ; i < 6 ; i++ )
! 					sts->pd->attbl[i].colno = pCOLOR[i];
! 			}
! 		}
! 		sts->hit = 0;
! 
  		slPushMatrix();							/* 表示 */
! 		spr_move( myswitch,sts->pos,sts->ang);
  		set_poly(sts->ang , sts->pos);
  		slPutPolygon( sts->pd );
  		slPopMatrix();
! 
! 	}
! 	else{	/* 死んでる */
! 		spr_break();	/* 爆発 */
! 	}
! }
! 
! 
! 
! void _obje1_act(void){
! 	player( &f[0] );
! }
! 
! void _obje2_act(void){
! 	player( &f[1] );
! }
! 
! 
! void	bullet( BULLET	*sts ){
! 	if( sts->busy != 0 ){
! 		FIXED	distance;
! 		if( ( distance = sts->pos[X] ) < 0 )
! 			distance *= -1;
! 
! 		if( toFIXED( 280.0 ) > distance ){
! 			sts->pos[X] += sts->spd[X];
! 			sts->ang[Z] += sts->rot[Z];
! 
  			slPushMatrix();
  			set_poly( sts->ang, sts->pos );
  			slPutPolygon( sts->pd );
  			slPopMatrix();
! 		}
! 		else{
! 			sts->busy = 0;
! 			return;
! 		}
! 		if( sts->target->hitpoint != 0 ){
! 			if( spr_col( sts->pos , sts->target->pos ) ){
! 				sts->target->hit++;
! 				/*	sts->busy = 0;	*/
! 			}
! 		}
! 	}
! }
! 
! 
! void _shot1_1_act(void){
! 	int	i;
! 	for( i = 0 ; i < _BULLETS ; i++)
! 		bullet( &b[0][i] );
! }
! void _shot1_2_act(void){
! 	;
! }
! void _shot2_1_act(void){
! 	int	i;
! 	for( i = 0 ; i < _BULLETS ; i++)
! 		bullet( &b[1][i] );
! }
! void _shot2_2_act(void){
! 	;
! }
! 
! void	rot_player( int	idnum ){
! 	/* 自転	*/
! 	f[idnum].ang[Y] += DEGtoANG( 12.0 );
! 	f[idnum].ang[Z] += DEGtoANG(  2.0 );
  	slPushMatrix();
  	set_poly( f[idnum].ang , f[idnum].pos );
  	slPutPolygon( f[idnum].pd );
  	slPopMatrix();
! }
! 
! void _obje1_demo(void){
! 	rot_player( 0 );
! }
! 
! void _obje2_demo(void){
! 	rot_player( 1 );
! }
! 
! 
! 
! void	init_objects( void ){
! 	int	i,j;
! 	endtimer = 0;
! 	endflg = 0;
! 
  	/* 自機オブジェの初期ポジション	*/
  	f[0].ang[X] = f[1].ang[X] = DEGtoANG( 0.0 );
  	f[0].ang[Y] = f[1].ang[Y] = DEGtoANG( 0.0 );
  	f[0].ang[Z] = f[1].ang[Z] = DEGtoANG( 0.0 );
! 
  	f[0].id = 0;
  	f[1].id = 1;
! 
! 	f[0].shotwait  = f[1].shotwait = 0;
! 	f[0].collision = f[1].collision = 0;
! 	f[0].hitpoint  = f[1].hitpoint = 3;
! 
  	f[0].pos[X] = toFIXED(-130.0 );
  	f[0].pos[Y] = toFIXED(   0.0 );
  	f[0].pos[Z] = toFIXED( 240.0 );
! 
  	f[1].pos[X] = toFIXED( 130.0);
  	f[1].pos[Y] = toFIXED(   0.0);
  	f[1].pos[Z] = toFIXED( 240.0);
! 
! 	for( i = 0 ; i < 2 ; i++ ){
! 		unsigned char	*src,*dst;
! 		src = ( unsigned char * )PDlist[i];
! 		dst = ( unsigned char * )&PDcube[i];
! 		f[i].pd = &PDcube[i];
! 		for( j = 0 ; j < ( int )sizeof( PDATA ) ; j++ )
! 			*dst++ = *src++;
! 		for( j = 0 ; j < _BULLETS ; j++ )
! 			f[i].myb[j] = &b[i][j];
! 	}
! 
! 
! 	/* ショット弾の初期ポジション	*/
! 	for( i = 0 ; i < 2 ; i++ ){
! 		for( j = 0 ; j < _BULLETS ; j++ ){
  			b[i][j].ang[X] = b[i][j].ang[Y] = b[i][j].ang[Z] = DEGtoANG( 0.0 );
  			b[i][j].pos[X] = b[i][j].pos[Y] = b[i][j].pos[Z] = toFIXED( 0.0 );
  			b[i][j].busy = 0;
  			b[i][j].pd = &PD_PLANE1;
! 			b[i][j].id = ( i << 12 ) + ( j << 8 ) + i*_BULLETS + j;
! 		}
! 	}
! 
! 	/* 飛び散るポリゴンの初期ポジション	*/
! 	for( i = 0 ; i < 6 ; i++ ){
! 		p[i].ang[X] = p[i].ang[Y] = p[i].ang[Z] = DEGtoANG( 0.0);
! 		p[i].pos[X] = p[i].pos[Y] = p[i].pos[Z] = toFIXED( 0.0);
! 		p[i].pd = _PDplane[i];
! 		for( j = X ; j < XYZ ; j++ ){
! 			p[i].spd[j] = spdtbl[i][j];
! 			p[i].rot[j] = rottbl[i][j];
! 		}
! 	}
! }
! 
! 
! 
! /* 破壊後の初期化	*/
  void break_init(ANGLE ang[XYZ],FIXED pos[XYZ]){
! 	int	i,j;
! 	for( i = 0 ; i < 6 ; i++ ){
! 		for( j = X ; j < XYZ ; j++ ){
! 			p[i].ang[j] = ang[j];
! 			p[i].pos[j] = pos[j];
! 		}
! 	}
! }
! 
! /* ポリゴンが飛び散る	*/
! void spr_break(void){
! 	static Uint16 c1,c2,c3,c4,c5;
! 	FIXED	x = toFIXED( fadetimer )/6;
! 	int	i,j;
! 	for( i = 0 ; i < 6 ; i++ ){
! 		for( j = X ; j < XYZ ; j ++ ){
! 			switch( abs( p[i].spd[j] ) ){
! 				case 0:
! 					break;
! 				case 1:
! 					p[i].pos[j] +=  x *  p[i].spd[j];
! 					break;
! 				case 2:
! 					p[i].pos[j] +=  p[i].spd[j];
! 					break;
! 				default:
! 					break;
! 			}
! 			p[i].ang[j] += p[i].rot[j];
! 
! 		}
  	 	slPushMatrix();
  		set_poly( p[i].ang,p[i].pos );
  		slPutPolygon( p[i].pd );
  		slPopMatrix();
! 	}
! 
! 	if( ++endtimer == 90 )
! 		endflg=1;					/* ゲーム終了	*/
! 
! 	if(fadetimer >0)
! 		fadetimer--;
! 
! 	c1 =  6 * fadetimer/60;
! 	c2 = 25 * fadetimer/60;
! 	c3 = 16 * fadetimer/60;
! 	c4 = 10 * fadetimer/60;
! 	c5 = 20 * fadetimer/60;
! 	attribute_BREAK[0].colno=C_RGB(c1,c1,c2);
! 	attribute_BREAK[1].colno=C_RGB(c1,c3,c2);
! 	attribute_BREAK[2].colno=C_RGB(c5,c5,c4);
! }
! 
! void	_pause_act( void ){
! 	int	i,j;
! 	for( i = 0 ; i < 2 ; i++){
  		slPushMatrix();							/* 表示 */
  		set_poly( f[i].ang , f[i].pos );
  		slPutPolygon( f[i].pd );
  		slPopMatrix();
! 	}
! 	for( i = 0 ; i < 2 ; i++){
! 		for( j = 0 ; j < _BULLETS ; j++ ){
! 			if( b[i][j].busy != 0 ){
  				slPushMatrix();							/* 表示 */
  				set_poly( b[i][j].ang , b[i][j].pos );
  				slPutPolygon( &PD_PLANE1 );
! 				slPopMatrix();
  			}
! 		}
! 	}
! }
! 
diff -crB --binary sbl6/segasmp/mem/smpmem0/smpmem0.c sbl6_patch/segasmp/mem/smpmem0/smpmem0.c
*** sbl6/segasmp/mem/smpmem0/smpmem0.c	1996-02-08 05:30:02.000000000 -0500
--- sbl6_patch/segasmp/mem/smpmem0/smpmem0.c	2022-01-06 18:30:14.000000000 -0500
***************
*** 79,85 ****
  #define	SZ_HEAP	0x10000
  static unsigned long	__heap[SZ_HEAP];
  
! void main(void)
  {
  
      /** BEGIN ****************************************************************/
--- 79,85 ----
  #define	SZ_HEAP	0x10000
  static unsigned long	__heap[SZ_HEAP];
  
! int main(void)
  {
  
      /** BEGIN ****************************************************************/
***************
*** 114,118 ****
  
      MEM_Free(malloc_2);
      MEM_Free(malloc_3);
  }
! 
\ No newline at end of file
--- 114,120 ----
  
      MEM_Free(malloc_2);
      MEM_Free(malloc_3);
+     
+     return 0;
  }
! 
diff -crB --binary sbl6/segasmp/mem/smpmem1/smpmem1.c sbl6_patch/segasmp/mem/smpmem1/smpmem1.c
*** sbl6/segasmp/mem/smpmem1/smpmem1.c	1996-02-08 05:30:04.000000000 -0500
--- sbl6_patch/segasmp/mem/smpmem1/smpmem1.c	2022-01-06 18:30:32.000000000 -0500
***************
*** 80,86 ****
  static unsigned char	__heap[SZ_HEAP];
  char	sega[] = "SEGA";
  
! void main(void){
  	Uint32	biggest,ui;
  	void	*ptr,*tmp;
  	int	i,maxcell[32];
--- 80,86 ----
  static unsigned char	__heap[SZ_HEAP];
  char	sega[] = "SEGA";
  
! int main(void){
  	Uint32	biggest,ui;
  	void	*ptr,*tmp;
  	int	i,maxcell[32];
***************
*** 150,154 ****
  	/* ここまでくれば終了 */
  	for(;;)
  		;
  }
! 
\ No newline at end of file
--- 150,156 ----
  	/* ここまでくれば終了 */
  	for(;;)
  		;
+ 	
+ 	return 0;
  }
! 
diff -crB --binary sbl6/segasmp/pcm/smppcm13/smppcm13.c sbl6_patch/segasmp/pcm/smppcm13/smppcm13.c
*** sbl6/segasmp/pcm/smppcm13/smppcm13.c	1996-02-08 05:30:12.000000000 -0500
--- sbl6_patch/segasmp/pcm/smppcm13/smppcm13.c	2022-01-22 12:33:56.000000000 -0500
***************
*** 314,320 ****
  	}
  }
  
! void main(void)
  {
  	/* Ｖブランクの設定 */
  	vblInit();
--- 314,320 ----
  	}
  }
  
! int main(void)
  {
  	/* Ｖブランクの設定 */
  	vblInit();
***************
*** 329,335 ****
  	PCM_Init();
  
  	/* ＡＤＰＣＭ使用宣言 (ADPCM伸張ﾗｲﾌﾞﾗﾘがﾘﾝｸされます) */
! 	PCM_DeclareUseAdpcm();
  
  	/* ＰＣＭライブラリのエラーハンドルの設定 */
  	PCM_SetErrFunc(errPcmFunc, NULL);
--- 329,335 ----
  	PCM_Init();
  
  	/* ＡＤＰＣＭ使用宣言 (ADPCM伸張ﾗｲﾌﾞﾗﾘがﾘﾝｸされます) */
! 	//PCM_DeclareUseAdpcm();
  
  	/* ＰＣＭライブラリのエラーハンドルの設定 */
  	PCM_SetErrFunc(errPcmFunc, NULL);
***************
*** 341,345 ****
  		smp_RestartPlay();
  #endif
  	}
  }
! 
\ No newline at end of file
--- 341,347 ----
  		smp_RestartPlay();
  #endif
  	}
+ 	
+ 	return 0;
  }
! 
diff -crB --binary sbl6/segasmp/pcm/smppcm2/smppcm2.c sbl6_patch/segasmp/pcm/smppcm2/smppcm2.c
*** sbl6/segasmp/pcm/smppcm2/smppcm2.c	1996-02-08 05:30:16.000000000 -0500
--- sbl6_patch/segasmp/pcm/smppcm2/smppcm2.c	2022-01-22 11:58:56.000000000 -0500
***************
*** 259,265 ****
  	STM_Close(fp);
  }
  
! void main(void)
  {
  	PcmHn 			pcm;
  	StmHn			stm;
--- 259,265 ----
  	STM_Close(fp);
  }
  
! int main(void)
  {
  	PcmHn 			pcm;
  	StmHn			stm;
***************
*** 279,285 ****
  	PCM_Init();
  
  	/* ＡＤＰＣＭ使用宣言 (ADPCM伸張ﾗｲﾌﾞﾗﾘがﾘﾝｸされます) */
! 	PCM_DeclareUseAdpcm();
  
  	/* ＰＣＭライブラリのエラーハンドルの設定 */
  	PCM_SetErrFunc(errPcmFunc, NULL);
--- 279,285 ----
  	PCM_Init();
  
  	/* ＡＤＰＣＭ使用宣言 (ADPCM伸張ﾗｲﾌﾞﾗﾘがﾘﾝｸされます) */
! 	//PCM_DeclareUseAdpcm();
  
  	/* ＰＣＭライブラリのエラーハンドルの設定 */
  	PCM_SetErrFunc(errPcmFunc, NULL);
***************
*** 293,299 ****
  		if (restart) {
  			/* ストリームオープン */
  			if ((stm = stmOpen(filename)) == NULL) {
! 				return;
  			}
  
  			/* 取り出し領域のリセット
--- 293,299 ----
  		if (restart) {
  			/* ストリームオープン */
  			if ((stm = stmOpen(filename)) == NULL) {
! 				return 1;
  			}
  
  			/* 取り出し領域のリセット
***************
*** 310,316 ****
  			PCM_PARA_PCM_SIZE(&para) = PCM_SIZE;
  			pcm = PCM_CreateStmHandle(&para, stm);
  			if (pcm == NULL) {
! 				return;
  			}
  
  			/* データの転送方式の設定（ＣＤブロック→リングバッファ） */
--- 310,316 ----
  			PCM_PARA_PCM_SIZE(&para) = PCM_SIZE;
  			pcm = PCM_CreateStmHandle(&para, stm);
  			if (pcm == NULL) {
! 				return 1;
  			}
  
  			/* データの転送方式の設定（ＣＤブロック→リングバッファ） */
***************
*** 340,344 ****
  			restart = 1;
  		}
  	}
  }
! 
\ No newline at end of file
--- 340,345 ----
  			restart = 1;
  		}
  	}
+ 	return 0;
  }
! 
diff -crB --binary sbl6/segasmp/pcm/smppcm3/smppcm3.c sbl6_patch/segasmp/pcm/smppcm3/smppcm3.c
*** sbl6/segasmp/pcm/smppcm3/smppcm3.c	1996-02-08 05:30:18.000000000 -0500
--- sbl6_patch/segasmp/pcm/smppcm3/smppcm3.c	2022-01-22 12:31:40.000000000 -0500
***************
*** 238,244 ****
  	PCM_Init();
  
  	/* ＡＤＰＣＭ使用宣言 (ADPCM伸張ﾗｲﾌﾞﾗﾘがﾘﾝｸされます) */
! 	PCM_DeclareUseAdpcm();
  
  	/* ＰＣＭライブラリのエラーハンドルの設定 */
  	PCM_SetErrFunc(errPcmFunc, NULL);
--- 238,244 ----
  	PCM_Init();
  
  	/* ＡＤＰＣＭ使用宣言 (ADPCM伸張ﾗｲﾌﾞﾗﾘがﾘﾝｸされます) */
! 	//PCM_DeclareUseAdpcm();
  
  	/* ＰＣＭライブラリのエラーハンドルの設定 */
  	PCM_SetErrFunc(errPcmFunc, NULL);
***************
*** 312,315 ****
  		}
  	}
  }
! 
\ No newline at end of file
--- 312,315 ----
  		}
  	}
  }
! 
diff -crB --binary sbl6/segasmp/pcm/smppcm4/smppcm4.c sbl6_patch/segasmp/pcm/smppcm4/smppcm4.c
*** sbl6/segasmp/pcm/smppcm4/smppcm4.c	1996-02-08 05:30:22.000000000 -0500
--- sbl6_patch/segasmp/pcm/smppcm4/smppcm4.c	2022-01-22 12:46:04.000000000 -0500
***************
*** 755,761 ****
  	PCM_Init();
  
  	/* ＡＤＰＣＭ使用宣言 (ADPCM伸張ﾗｲﾌﾞﾗﾘがﾘﾝｸされます) */
! 	PCM_DeclareUseAdpcm();
  
  	/* ＰＣＭライブラリのエラーハンドルの設定 */
  	PCM_SetErrFunc(errPcmFunc, NULL);
--- 755,761 ----
  	PCM_Init();
  
  	/* ＡＤＰＣＭ使用宣言 (ADPCM伸張ﾗｲﾌﾞﾗﾘがﾘﾝｸされます) */
! 	//PCM_DeclareUseAdpcm();
  
  	/* ＰＣＭライブラリのエラーハンドルの設定 */
  	PCM_SetErrFunc(errPcmFunc, NULL);
***************
*** 768,771 ****
  #endif
  	}
  }
! 
\ No newline at end of file
--- 768,771 ----
  #endif
  	}
  }
! 
diff -crB --binary sbl6/segasmp/pcm/smppcm5/smppcm5.c sbl6_patch/segasmp/pcm/smppcm5/smppcm5.c
*** sbl6/segasmp/pcm/smppcm5/smppcm5.c	1996-02-08 05:30:26.000000000 -0500
--- sbl6_patch/segasmp/pcm/smppcm5/smppcm5.c	2022-01-22 12:46:34.000000000 -0500
***************
*** 763,769 ****
  	PCM_Init();
  
  	/* ＡＤＰＣＭ使用宣言 (ADPCM伸張ﾗｲﾌﾞﾗﾘがﾘﾝｸされます) */
! 	PCM_DeclareUseAdpcm();
  
  	/* ＰＣＭライブラリのエラーハンドルの設定 */
  	PCM_SetErrFunc(errPcmFunc, NULL);
--- 763,769 ----
  	PCM_Init();
  
  	/* ＡＤＰＣＭ使用宣言 (ADPCM伸張ﾗｲﾌﾞﾗﾘがﾘﾝｸされます) */
! 	//PCM_DeclareUseAdpcm();
  
  	/* ＰＣＭライブラリのエラーハンドルの設定 */
  	PCM_SetErrFunc(errPcmFunc, NULL);
***************
*** 1086,1089 ****
  		}
  	}
  }
! 
\ No newline at end of file
--- 1086,1089 ----
  		}
  	}
  }
! 
diff -crB --binary sbl6/segasmp/per/smpper12/test.c sbl6_patch/segasmp/per/smpper12/test.c
*** sbl6/segasmp/per/smpper12/test.c	1996-02-08 05:30:44.000000000 -0500
--- sbl6_patch/segasmp/per/smpper12/test.c	2022-02-10 21:24:02.000000000 -0500
***************
*** 6,15 ****
  #include	<machine.h>
  #include	<sega_scl.h> 
  
! #include	"..\..\v_blank\v_blank.h"
! #include	"..\..\scl\graphic\cosmo2u.cha"
! #include	"..\..\scl\graphic\cosmo2u.col"
! #include	"..\..\scl\graphic\cosmo2u.map"
  
  /*********** 関数プロトタイプ *************/
  void scl_main(void);
--- 6,15 ----
  #include	<machine.h>
  #include	<sega_scl.h> 
  
! #include	"../../v_blank/v_blank.h"
! #include	"../../scl/graphic/cosmo2u.cha"
! #include	"../../scl/graphic/cosmo2u.col"
! #include	"../../scl/graphic/cosmo2u.map"
  
  /*********** 関数プロトタイプ *************/
  void scl_main(void);
***************
*** 86,89 ****
  	start.red = start.green = start.blue = 0;
  	end.red = end.green = end.blue = - 255;
  }
! 
\ No newline at end of file
--- 86,89 ----
  	start.red = start.green = start.blue = 0;
  	end.red = end.green = end.blue = - 255;
  }
! 
diff -crB --binary sbl6/segasmp/sblsgl/sblsgl00/sblsgl00.c sbl6_patch/segasmp/sblsgl/sblsgl00/sblsgl00.c
*** sbl6/segasmp/sblsgl/sblsgl00/sblsgl00.c	1996-02-08 05:31:22.000000000 -0500
--- sbl6_patch/segasmp/sblsgl/sblsgl00/sblsgl00.c	2021-12-24 16:40:22.000000000 -0500
***************
*** 7,22 ****
   *------------------------------------------------------------------------
   */
  #include    <sgl.h> 				/* use SGL  */
! extern PDATA PD_PLANE1;
  
  #include	<machine.h>
  #include	<sega_scl.h> 
  
! #include	"..\..\v_blank\v_blank.h"
  
! #include	"..\graphic\cosmo2u.cha"
! #include	"..\graphic\cosmo2u.col"
! #include	"..\graphic\cosmo2u.map"
  
  
  extern	void	Work_Set(void);
--- 7,23 ----
   *------------------------------------------------------------------------
   */
  #include    <sgl.h> 				/* use SGL  */
! extern PDATA PD_PLANE1;
  
  #include	<machine.h>
+ #include	<string.h>
  #include	<sega_scl.h> 
  
! #include	"../../v_blank/v_blank.h"
  
! #include	"../graphic/cosmo2u.cha"
! #include	"../graphic/cosmo2u.col"
! #include	"../graphic/cosmo2u.map"
  
  
  extern	void	Work_Set(void);
***************
*** 45,54 ****
  
  
  /* メインルーチン */
! void main()
  {
! 	static 	ANGLE	ang[XYZ];
! 	static 	FIXED	pos[XYZ];
  
  	SclConfig	scfg;
  	SclRgb		start,end;
--- 46,55 ----
  
  
  /* メインルーチン */
! int main(void)
  {
! 	static 	ANGLE	ang[XYZ];
! 	static 	FIXED	pos[XYZ];
  
  	SclConfig	scfg;
  	SclRgb		start,end;
***************
*** 156,161 ****
  			slSynch();
  	}
  
  }
  
! 
\ No newline at end of file
--- 157,163 ----
  			slSynch();
  	}
  
+    return 0;
  }
  
! 
diff -crB --binary sbl6/segasmp/sblsgl/sblsgl00/work.c sbl6_patch/segasmp/sblsgl/sblsgl00/work.c
*** sbl6/segasmp/sblsgl/sblsgl00/work.c	1996-02-08 05:31:22.000000000 -0500
--- sbl6_patch/segasmp/sblsgl/sblsgl00/work.c	2021-12-25 18:01:14.000000000 -0500
***************
*** 9,25 ****
  
  #include    <sgl.h>
  
! 	extern Uint32	MaxVertices ;
! 	extern Uint32	MaxPolygon ;
! 	extern void*	SortList ;	
! 	extern void*	TransList ;
! 	extern void*	Zbuffer ;	
! 	extern void*	SlSpriteBuf ;	
! 	extern void*	MsSpriteBuf ;	
! 	extern Uint32	SpriteBufSize ;
! 	extern void*	Pbuffer ;	
! 	extern void*	CLOfstBuf ;	
! 	extern void*	CommandBuf ;	
  
  /*
  #define		MAX_VERTICES	2440
--- 9,26 ----
  
  #include    <sgl.h>
  
! 	extern Uint32	MaxVertices ;
! 	Uint32	MaxPolygon ; // PATCH !
! 	//extern Uint32	MaxPolygon ;
! 	extern void*	SortList ;	
! 	extern void*	TransList ;
! 	extern void*	Zbuffer ;	
! 	//extern void*	SlSpriteBuf ;	
! 	//extern void*	MsSpriteBuf ;	
! 	extern Uint32	SpriteBufSize ;
! 	extern void*	Pbuffer ;	
! 	extern void*	CLOfstBuf ;	
! 	extern void*	CommandBuf ;	
  
  /*
  #define		MAX_VERTICES	2440
***************
*** 49,56 ****
  	SortList    = (void*)(SORTLIST) ;
  	TransList   = (void*)(TRANSLIST) ;
  	Zbuffer     = (void*)(ZBUFFER) ;
! 	SlSpriteBuf = (void*)(SLSPRBUF) ;
! 	MsSpriteBuf = (void*)(MSSPRBUF) ;
  	SpriteBufSize = (MAX_POLYGON+5)*36 ;
  	Pbuffer     = (void*)(PBUFFER) ;
  	CLOfstBuf   = (void*)(CLOFSTBUF) ;
--- 50,57 ----
  	SortList    = (void*)(SORTLIST) ;
  	TransList   = (void*)(TRANSLIST) ;
  	Zbuffer     = (void*)(ZBUFFER) ;
! 	//SlSpriteBuf = (void*)(SLSPRBUF) ;
! 	//MsSpriteBuf = (void*)(MSSPRBUF) ;
  	SpriteBufSize = (MAX_POLYGON+5)*36 ;
  	Pbuffer     = (void*)(PBUFFER) ;
  	CLOfstBuf   = (void*)(CLOFSTBUF) ;
***************
*** 71,74 ****
  */
  
  }
! 
\ No newline at end of file
--- 72,75 ----
  */
  
  }
! 
diff -crB --binary sbl6/segasmp/sblsgl/sblsgl01/sblsgl01.c sbl6_patch/segasmp/sblsgl/sblsgl01/sblsgl01.c
*** sbl6/segasmp/sblsgl/sblsgl01/sblsgl01.c	1996-02-08 05:31:26.000000000 -0500
--- sbl6_patch/segasmp/sblsgl/sblsgl01/sblsgl01.c	2022-02-08 18:24:22.000000000 -0500
***************
*** 7,22 ****
   *------------------------------------------------------------------------
   */
  #include    <sgl.h> 				/* use SGL  */
! extern PDATA PD_PLANE1, PD_PLANE2, PD_PLANE3;
  
  #include	<machine.h>
  #include	<sega_scl.h> 
  
! #include	"..\..\v_blank\v_blank.h"
  
! #include	"..\graphic\cosmo2u.cha"
! #include	"..\graphic\cosmo2u.col"
! #include	"..\graphic\cosmo2u.map"
  
  /*----------------------------
  SCROLL NBG0 Cycle Table
--- 7,22 ----
   *------------------------------------------------------------------------
   */
  #include    <sgl.h> 				/* use SGL  */
! extern PDATA PD_PLANE1, PD_PLANE2, PD_PLANE3;
  
  #include	<machine.h>
  #include	<sega_scl.h> 
  
! #include	"../../v_blank/v_blank.h"
  
! #include	"../graphic/cosmo2u.cha"
! #include	"../graphic/cosmo2u.col"
! #include	"../graphic/cosmo2u.map"
  
  /*----------------------------
  SCROLL NBG0 Cycle Table
***************
*** 49,59 ****
  	Uint16  	BackCol,i,PadData1EW;
  	Uint8   	*VramWorkP;
  
! 	static ANGLE ang1[XYZ], ang2[XYZ], ang3[XYZ];
! 	static FIXED pos1[XYZ], pos2[XYZ], pos3[XYZ];
! 	static ANGLE tang, aang;
! 
! 	slInitSystem(TV_320x224,NULL,1);
  
  	/* Ｖブランクルーチンをユーザー登録する場合	*/
      SetVblank();
--- 49,59 ----
  	Uint16  	BackCol,i,PadData1EW;
  	Uint8   	*VramWorkP;
  
! 	static ANGLE ang1[XYZ], ang2[XYZ], ang3[XYZ];
! 	static FIXED pos1[XYZ], pos2[XYZ], pos3[XYZ];
! 	static ANGLE tang, aang;
! 
! 	slInitSystem(TV_320x224,NULL,1);
  
  	/* Ｖブランクルーチンをユーザー登録する場合	*/
      SetVblank();
***************
*** 112,135 ****
  	start.red = start.green = start.blue = 0;
  	end.red = end.green = end.blue = - 255;
  
! 	ang1[X] = ang1[Y] = ang1[Z] = DEGtoANG(0.0);
! 	ang2[X] = ang2[Y] = ang2[Z] = DEGtoANG(0.0);
! 	ang3[X] = ang3[Y] = ang3[Z] = DEGtoANG(0.0);
! 	pos1[X] = toFIXED(  0.0);
! 	pos1[Y] = toFIXED( 40.0);
! 	pos1[Z] = toFIXED(170.0);
! 	pos2[X] = toFIXED(  0.0);
! 	pos2[Y] = toFIXED(-40.0);
! 	pos2[Z] = toFIXED(  0.0);
! 	pos3[X] = toFIXED(  0.0);
! 	pos3[Y] = toFIXED(-40.0);
! 	pos3[Z] = toFIXED(  0.0);
! 	tang = DEGtoANG(0.0);
! 	aang = DEGtoANG(2.0);
! 
  
  	/******** メインループ ********/
! 	while(-1) {
  		PadData1EW = PadData1E;
  		PadData1E = 0;
  		if(PadData1EW & PAD_U){
--- 112,135 ----
  	start.red = start.green = start.blue = 0;
  	end.red = end.green = end.blue = - 255;
  
! 	ang1[X] = ang1[Y] = ang1[Z] = DEGtoANG(0.0);
! 	ang2[X] = ang2[Y] = ang2[Z] = DEGtoANG(0.0);
! 	ang3[X] = ang3[Y] = ang3[Z] = DEGtoANG(0.0);
! 	pos1[X] = toFIXED(  0.0);
! 	pos1[Y] = toFIXED( 40.0);
! 	pos1[Z] = toFIXED(170.0);
! 	pos2[X] = toFIXED(  0.0);
! 	pos2[Y] = toFIXED(-40.0);
! 	pos2[Z] = toFIXED(  0.0);
! 	pos3[X] = toFIXED(  0.0);
! 	pos3[Y] = toFIXED(-40.0);
! 	pos3[Z] = toFIXED(  0.0);
! 	tang = DEGtoANG(0.0);
! 	aang = DEGtoANG(2.0);
! 
  
  	/******** メインループ ********/
! 	while(-1) {
  		PadData1EW = PadData1E;
  		PadData1E = 0;
  		if(PadData1EW & PAD_U){
***************
*** 150,190 ****
  		if((PadData1 & PAD_B)) 	SCL_SetMosaic(SCL_NBG0,14,14);
  		if((PadData1 & PAD_C)) 	SCL_SetMosaic(SCL_NBG0,16,16);
  
! 		slUnitMatrix(CURRENT);
! 		ang1[Z] = ang2[Z] = tang;
! 		tang += aang;
! 		if(tang < DEGtoANG(-90.0)) {
! 			aang = DEGtoANG(2.0);
! 		} else if(tang > DEGtoANG(90.0)) {
! 			aang = -DEGtoANG(2.0);
! 		}
! 
! 		slPushMatrix();
! 		{
! 			set_poly(ang1, pos1);
! 			slPutPolygon(&PD_PLANE1);
! 
! 			slPushMatrix();
! 			{
! 				set_poly(ang2, pos2);
! 				slPutPolygon(&PD_PLANE2);
! 
! 				slPushMatrix();
! 				{
! 					set_poly(ang3, pos3);
! 					ang3[Y] += DEGtoANG(5.0);
! 					slPutPolygon(&PD_PLANE3);
! 				}
! 				slPopMatrix();
! 			}	
! 			slPopMatrix();
! 		}
! 		slPopMatrix();
! 
! 		slSynch();
! 	}
! }
  
  
  
! 
\ No newline at end of file
--- 150,190 ----
  		if((PadData1 & PAD_B)) 	SCL_SetMosaic(SCL_NBG0,14,14);
  		if((PadData1 & PAD_C)) 	SCL_SetMosaic(SCL_NBG0,16,16);
  
! 		slUnitMatrix(CURRENT);
! 		ang1[Z] = ang2[Z] = tang;
! 		tang += aang;
! 		if(tang < DEGtoANG(-90.0)) {
! 			aang = DEGtoANG(2.0);
! 		} else if(tang > DEGtoANG(90.0)) {
! 			aang = -DEGtoANG(2.0);
! 		}
! 
! 		slPushMatrix();
! 		{
! 			set_poly(ang1, pos1);
! 			slPutPolygon(&PD_PLANE1);
! 
! 			slPushMatrix();
! 			{
! 				set_poly(ang2, pos2);
! 				slPutPolygon(&PD_PLANE2);
! 
! 				slPushMatrix();
! 				{
! 					set_poly(ang3, pos3);
! 					ang3[Y] += DEGtoANG(5.0);
! 					slPutPolygon(&PD_PLANE3);
! 				}
! 				slPopMatrix();
! 			}	
! 			slPopMatrix();
! 		}
! 		slPopMatrix();
! 
! 		slSynch();
! 	}
! }
  
  
  
! 
diff -crB --binary sbl6/segasmp/scl/smpscl1/smpscl1.c sbl6_patch/segasmp/scl/smpscl1/smpscl1.c
*** sbl6/segasmp/scl/smpscl1/smpscl1.c	1996-02-08 05:31:50.000000000 -0500
--- sbl6_patch/segasmp/scl/smpscl1/smpscl1.c	2022-02-09 08:59:44.000000000 -0500
***************
*** 19,29 ****
  #include	<machine.h>
  #include	<sega_scl.h> 
  
! #include	"..\..\v_blank\v_blank.h"
  
! #include	"..\graphic\cosmo2u.cha"
! #include	"..\graphic\cosmo2u.col"
! #include	"..\graphic\cosmo2u.map"
  
  /*----------------------------
  SCROLL NBG0 Cycle Table
--- 19,29 ----
  #include	<machine.h>
  #include	<sega_scl.h> 
  
! #include	"../../v_blank/v_blank.h"
  
! #include	"../graphic/cosmo2u.cha"
! #include	"../graphic/cosmo2u.col"
! #include	"../graphic/cosmo2u.map"
  
  /*----------------------------
  SCROLL NBG0 Cycle Table
***************
*** 152,155 ****
  		SCL_DisplayFrame();
  	}
  }
! 
\ No newline at end of file
--- 152,155 ----
  		SCL_DisplayFrame();
  	}
  }
! 
diff -crB --binary sbl6/segasmp/scl/smpscl3/scldata.c sbl6_patch/segasmp/scl/smpscl3/scldata.c
*** sbl6/segasmp/scl/smpscl3/scldata.c	1996-02-08 05:31:52.000000000 -0500
--- sbl6_patch/segasmp/scl/smpscl3/scldata.c	2022-02-09 09:08:36.000000000 -0500
***************
*** 4,15 ****
  #include	<sega_mth.h>
  #include	<sega_scl.h>
  
! #include	"..\graphic\grandu.cha"
! #include	"..\graphic\grandu.col"
! #include	"..\graphic\grandu.map"
! #include	"..\graphic\skyu.cha"
! #include	"..\graphic\skyu.col"
! #include	"..\graphic\skyu.map"
  
  
  void WordCopyforVRAM(void *dest,void *src,Uint32 tcnt);
--- 4,15 ----
  #include	<sega_mth.h>
  #include	<sega_scl.h>
  
! #include	"../graphic/grandu.cha"
! #include	"../graphic/grandu.col"
! #include	"../graphic/grandu.map"
! #include	"../graphic/skyu.cha"
! #include	"../graphic/skyu.col"
! #include	"../graphic/skyu.map"
  
  
  void WordCopyforVRAM(void *dest,void *src,Uint32 tcnt);
***************
*** 172,175 ****
      }
  }
  
! 
\ No newline at end of file
--- 172,175 ----
      }
  }
  
! 
diff -crB --binary sbl6/segasmp/scl/smpscl5/smpscl5.c sbl6_patch/segasmp/scl/smpscl5/smpscl5.c
*** sbl6/segasmp/scl/smpscl5/smpscl5.c	1996-02-08 05:31:56.000000000 -0500
--- sbl6_patch/segasmp/scl/smpscl5/smpscl5.c	2022-02-09 09:12:04.000000000 -0500
***************
*** 19,25 ****
  #include	<machine.h>
  #include	<sega_scl.h> 
  
! #include	"..\..\v_blank\v_blank.h"
  
  	Uint16		PadData1EW,PadData2EW;
  	SclConfig	Rbg0Scfg,Rbg1Scfg;
--- 19,25 ----
  #include	<machine.h>
  #include	<sega_scl.h> 
  
! #include	"../../v_blank/v_blank.h"
  
  	Uint16		PadData1EW,PadData2EW;
  	SclConfig	Rbg0Scfg,Rbg1Scfg;
***************
*** 387,390 ****
  	/* 文字の本体 */
  	Print256(vram,str,x,y,col,300);
  }
! 
\ No newline at end of file
--- 387,390 ----
  	/* 文字の本体 */
  	Print256(vram,str,x,y,col,300);
  }
! 
diff -crB --binary sbl6/segasmp/spr/smpspr2/smpspr20.c sbl6_patch/segasmp/spr/smpspr2/smpspr20.c
*** sbl6/segasmp/spr/smpspr2/smpspr20.c	1996-02-08 05:33:26.000000000 -0500
--- sbl6_patch/segasmp/spr/smpspr2/smpspr20.c	2022-01-17 20:35:02.000000000 -0500
***************
*** 20,29 ****
  
  #include	<stdio.h>
  #include	<stdlib.h>
  
  #define		_SPR2_
  #include        "sega_spr.h"
! #include        "sega_dbg.h"
  #include        "sega_per.h"
  
  #include	<machine.h>
--- 20,30 ----
  
  #include	<stdio.h>
  #include	<stdlib.h>
+ #include	<string.h>
  
  #define		_SPR2_
  #include        "sega_spr.h"
! //#include        "sega_dbg.h"
  #include        "sega_per.h"
  
  #include	<machine.h>
***************
*** 862,871 ****
  };
  
  
! void main()
  {
      Uint8  *VRAM;
      Uint16 *colAddr;
      int    asw;
      
      set_imask(0);
--- 863,874 ----
  };
  
  
! int main(void)
  {
      Uint8  *VRAM;
+ #if 0
      Uint16 *colAddr;
+ #endif
      int    asw;
      
      set_imask(0);
***************
*** 887,893 ****
  
      SCL_DisplayFrame();
      SCL_DisplayFrame();
!     colAddr = (Uint16*)SCL_AllocColRam(SCL_SPR,32,OFF);
      SCL_SetColRam(SCL_SPR,0,32,colorData);
  
      SCL_SetDisplayMode(SCL_NON_INTER,SCL_240LINE,SCL_NORMAL_A);
--- 890,896 ----
  
      SCL_DisplayFrame();
      SCL_DisplayFrame();
!     /*colAddr = */(Uint16*)SCL_AllocColRam(SCL_SPR,32,OFF);
      SCL_SetColRam(SCL_SPR,0,32,colorData);
  
      SCL_SetDisplayMode(SCL_NON_INTER,SCL_240LINE,SCL_NORMAL_A);
***************
*** 984,990 ****
          }
          SCL_DisplayFrame();
      }
  }
  
  /*  end of file */
! 
\ No newline at end of file
--- 987,995 ----
          }
          SCL_DisplayFrame();
      }
+ 
+     return 0;
  }
  
  /*  end of file */
! 
diff -crB --binary sbl6/segasmp/spr/smpspr7/smpspr70.c sbl6_patch/segasmp/spr/smpspr7/smpspr70.c
*** sbl6/segasmp/spr/smpspr7/smpspr70.c	1996-02-08 05:33:30.000000000 -0500
--- sbl6_patch/segasmp/spr/smpspr7/smpspr70.c	2022-01-19 20:00:04.000000000 -0500
***************
*** 93,104 ****
  static void initCluster(SprCluster *cluster);
  static void moveCluster(SprCluster *cluster);
  
! void main()		/* 95-7-26  +"void"  */
  {
  /* int     i, n;	95-7-26 unuse */
  XyInt	xy;
  MthXyz  mAngle, mPoint;
! Uint16 *colAddr;
  
  #if(SYSTEM_CLOCK == 28)
          SYS_CHGSYSCK(1);              /* システムクロックを２８Ｍに切替え  */
--- 93,104 ----
  static void initCluster(SprCluster *cluster);
  static void moveCluster(SprCluster *cluster);
  
! int main(void)		/* 95-7-26  +"void"  */
  {
  /* int     i, n;	95-7-26 unuse */
  XyInt	xy;
  MthXyz  mAngle, mPoint;
! //Uint16 *colAddr;
  
  #if(SYSTEM_CLOCK == 28)
          SYS_CHGSYSCK(1);              /* システムクロックを２８Ｍに切替え  */
***************
*** 127,133 ****
          SCL_DisplayFrame();
          SCL_DisplayFrame();
  
!         colAddr = (Uint16*)SCL_AllocColRam(SCL_SPR,48,OFF);
          SCL_SetColRam(SCL_SPR,0,48,colorData);
  
  	SPR_3Initial(&work3D);		/* ３Ｄスプライト表示初期化 */
--- 127,133 ----
          SCL_DisplayFrame();
          SCL_DisplayFrame();
  
!         /*colAddr = */(Uint16*)SCL_AllocColRam(SCL_SPR,48,OFF);
          SCL_SetColRam(SCL_SPR,0,48,colorData);
  
  	SPR_3Initial(&work3D);		/* ３Ｄスプライト表示初期化 */
***************
*** 203,208 ****
--- 203,209 ----
  	    SCL_DisplayFrame();    /* Ｖ−ＢＬＡＮＫ割り込みを待ち、       */
  				     /* スプライト表示とスクロール動作を行う */
      }
+     return 0;
  }
  
  
***************
*** 354,357 ****
  }
  
  /*  end of file */
! 
\ No newline at end of file
--- 355,358 ----
  }
  
  /*  end of file */
! 
diff -crB --binary sbl6/segasmp/v_blank/set_vb.c sbl6_patch/segasmp/v_blank/set_vb.c
*** sbl6/segasmp/v_blank/set_vb.c	1996-02-08 05:34:02.000000000 -0500
--- sbl6_patch/segasmp/v_blank/set_vb.c	2021-04-21 19:17:26.000000000 -0400
***************
*** 1,27 ****
! /*----------------------------------------------------------------------------
!  *  Set_VB.c -- V-Blank割り込みルーチンの登録
!  *  Copyright(c) 1994 SEGA
!  *  Written by K.M on 1994-05-16 Ver.0.90
!  *  Updated by K.M on 1994-10-04 Ver.1.02
!  *----------------------------------------------------------------------------
!  */
! 
! #include	<sega_xpt.h>
! #include	<sega_int.h>
! #include	"per_x.h"
! 
! void	UsrVblankIn( void );
! void	UsrVblankOut( void );
! extern SysPort	*__port;
! 
! void	SetVblank( void ){
! 	
! 	__port = PER_OpenPort();
! 	
! 	/* V-Blank割り込みルーチンの登録 */
! 	INT_ChgMsk(INT_MSK_NULL,INT_MSK_VBLK_IN | INT_MSK_VBLK_OUT);
! 	INT_SetScuFunc(INT_SCU_VBLK_IN,UsrVblankIn);
! 	INT_SetScuFunc(INT_SCU_VBLK_OUT,UsrVblankOut);
! 	INT_ChgMsk(INT_MSK_VBLK_IN | INT_MSK_VBLK_OUT,INT_MSK_NULL);
! }
! 
\ No newline at end of file
--- 1,46 ----
! /*----------------------------------------------------------------------------
!  *  Set_VB.c -- V-Blank割り込みルーチンの登録
!  *  Copyright(c) 1994 SEGA
!  *  Written by K.M on 1994-05-16 Ver.0.90
!  *  Updated by K.M on 1994-10-04 Ver.1.02
!  *----------------------------------------------------------------------------
!  */
! 
! #include <sega_xpt.h>
! #include <sega_int.h>
! #include <sega_per.h>
! 
! extern	void  UsrVblankStart(void);
! extern	void  UsrVblankEnd(void);
! 
! extern	Uint32	PadWorkArea[7];
! 
! volatile Sint32	perFlag;
! 
! void   CheckVblankEnd(void);
! 
! void SetVblank(void)
! {
! 	/* V_Blank Out 割り込みを待つ */
! 	
! 	INT_ChgMsk(INT_MSK_NULL,INT_MSK_VBLK_IN | INT_MSK_VBLK_OUT);
! 	INT_SetScuFunc(INT_SCU_VBLK_OUT,CheckVblankEnd);
! 	INT_ChgMsk(INT_MSK_VBLK_OUT,INT_MSK_NULL);
! 
! 	perFlag = 1;
! 	while(perFlag);
!     
! 	PER_Init(PER_KD_PERTIM,2,PER_ID_DGT,PER_SIZE_DGT,PadWorkArea,0);
! 
! 	/* V-Blank割り込みルーチンの登録 */
! 	INT_ChgMsk(INT_MSK_NULL,INT_MSK_VBLK_IN | INT_MSK_VBLK_OUT);
! 	INT_SetScuFunc(INT_SCU_VBLK_IN,UsrVblankStart);
! 	INT_SetScuFunc(INT_SCU_VBLK_OUT,UsrVblankEnd);
! 	INT_ChgMsk(INT_MSK_VBLK_IN | INT_MSK_VBLK_OUT,INT_MSK_NULL);
! }
! 
! 
! void   CheckVblankEnd(void)
! {
! 	perFlag = 0;
! }
diff -crB --binary sbl6/segasmp/v_blank/v_blank.c sbl6_patch/segasmp/v_blank/v_blank.c
*** sbl6/segasmp/v_blank/v_blank.c	1996-02-08 05:34:02.000000000 -0500
--- sbl6_patch/segasmp/v_blank/v_blank.c	2022-02-07 14:26:52.000000000 -0500
***************
*** 19,31 ****
  volatile trigger_t	PadData1E = 0x0000;
  volatile trigger_t	PadData2  = 0x0000;
  volatile trigger_t	PadData2E = 0x0000;
! SysPort	*__port = NULL;
  
  void	UsrVblankIn( void ){
  	SCL_VblankStart();
  }
  
! void   UsrVblankOut( void ){
  	SCL_VblankEnd();
  	
  	if( __port != NULL ){
--- 19,60 ----
  volatile trigger_t	PadData1E = 0x0000;
  volatile trigger_t	PadData2  = 0x0000;
  volatile trigger_t	PadData2E = 0x0000;
! //SysPort	*__port = NULL;
! 
! Uint32	PadWorkArea[7];
! 
  
  void	UsrVblankIn( void ){
  	SCL_VblankStart();
  }
  
! void   UsrVblankStart(void)
! {
! 	/* グラフィックライブラリを使用する為には実行しなければならない */
! 	SCL_VblankStart();
! }
! 
! 
! void   UsrVblankEnd(void)
! {
! 	PerDgtInfo	*pad;
! 
! 	/* グラフィックライブラリを使用する為には実行しなければならない */
! 	SCL_VblankEnd();
! 
! 	/* パッドデータ取得 */
! 
! 	PER_GetPer((PerGetPer **)&pad);
! 	if( pad != NULL ){
! 		PadData1   = pad[0].data ^ 0xffff;
! 		PadData1E |= pad[0].push ^ 0xffff;
! 		PadData2   = pad[1].data ^ 0xffff;
! 		PadData2E |= pad[1].push ^ 0xffff;
! 	}
! 
! }
! 
! /*void   UsrVblankOut( void ){
  	SCL_VblankEnd();
  	
  	if( __port != NULL ){
***************
*** 55,59 ****
  			PadData2 = PadData2E = 0;
  		}
  	}
! }
! 
\ No newline at end of file
--- 84,88 ----
  			PadData2 = PadData2E = 0;
  		}
  	}
! }*/
! 
